<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SOLO LEVELING — JOGO DA DISCIPLINA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">

<!-- PWA Meta Tags -->
<meta name="application-name" content="Solo Leveling">
<meta name="apple-mobile-web-app-title" content="Solo Leveling">
<meta name="description" content="Jogo da Disciplina - Solo Leveling. Desenvolva hábitos e evolua como um Hunter!">
<meta name="theme-color" content="#001122">
<meta name="background-color" content="#000000">

<!-- PWA Display -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="msapplication-TileColor" content="#001122">
<meta name="msapplication-tap-highlight" content="no">

<!-- Prevent zoom and enable fullscreen -->
<meta name="format-detection" content="telephone=no">
<meta name="msapplication-config" content="browserconfig.xml">

<!-- Manifest -->
<link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlNvbG8gTGV2ZWxpbmcgLSBKb2dvIGRhIERpc2NpcGxpbmEiLAogICJzaG9ydF9uYW1lIjogIlNvbG8gTGV2ZWxpbmciLAogICJkZXNjcmlwdGlvbiI6ICJEZXNlbnZvbHZhIGjDoWJpdG9zIGUgZXZvbHVhIGNvbW8gdW0gSHVudGVyISIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAiZnVsbHNjcmVlbiIsCiAgIm9yaWVudGF0aW9uIjogImxhbmRzY2FwZSIsCiAgInRoZW1lX2NvbG9yIjogIiMwMDExMjIiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwMDAwMDAiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhNakFpSUdobGFXZG9kRDBpTVRJd0lqNEtJQ0E4WkdWbWN6NEtJQ0FnSUNBOGJHbHVaV0ZzUjNKaFpHbGxiblFnYVdROUluQnNZWGx2Y2lJK0NpQWdJQ0FnSUNBOGMzUnZjQ0J2Wm1aelpYUTlJakFsSWlCemRHOXdMV052Ykc5eVBTSWpNREF4TVRJeUlpOCtDaUFnSUNBZ0lDQThjM1J2Y0NCdlptWnpaWFE5SWpFd01DVWlJSE4wYjNBdFkyOXNiM0k5SWlNd01ERmhabVlpTHo0S0lDQWdJRHd2YkdsdVpXRnlSM0poWkdsbGJuUStDaUFnUEM5a1pXWnpQZ29nSUR4eVpXTjBJSGRwWkhSb1BTSXhNakFpSUdobGFXZG9kRDBpTVRJd0lpQm1hV3hzUFNKMWNtd29JbkJzWVhsdmNpSXBJaUF2UGdvOEwzTjJaejQ9IiwKICAgICAgInNpemVzIjogIjEyMHgxMjAiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXlOVFlpSUdobGFXZG9kRDBpTWpVMklqNEtJQ0E4WkdWbWN6NEtJQ0FnSUNBOGJHbHVaV0ZzUjNKaFpHbGxiblFnYVdROUluQnNZWGx2Y2lJK0NpQWdJQ0FnSUNBOGMzUnZjQ0J2Wm1aelpYUTlJakFsSWlCemRHOXdMV052Ykc5eVBTSWpNREF4TVRJeUlpOCtDaUFnSUNBZ0lDQThjM1J2Y0NCdlptWnpaWFE5SWpFd01DVWlJSE4wYjNBdFkyOXNiM0k5SWlNd01ERmhabVlpTHo0S0lDQWdJRHd2YkdsdVpXRnlSM0poWkdsbGJuUStDaUFnUEM5a1pXWnpQZ29nSUR4eVpXTjBJSGRwWkhSb1BTSXlOVFlpSUdobGFXZG9kRDBpTWpVMklpQm1hV3hzUFNKMWNtd29JbkJzWVhsdmNpSXBJaUF2UGdvOEwzTjJaejQ9IiwKICAgICAgInNpemVzIjogIjI1NngyNTYiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0sCiAgImNhdGVnb3JpZXMiOiBbImdhbWVzIiwgInByb2R1Y3Rpdml0eSJdLAogICJsYW5nIjogInB0LUJSIgp9">

<!-- Icons for different platforms -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIj4KICA8ZGVmcz4KICA8bGluZWFyR3JhZGllbnQgaWQ9InBsYXlvciI+CiAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjMDAxMTIyIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDFhZmYiLz4KICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgZmlsbD0idXJsKCNwbGF5b3IpIiAvPgo8L3N2Zz4=">
<link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIj4KICA8ZGVmcz4KICA8bGluZWFyR3JhZGllbnQgaWQ9InBsYXlvciI+CiAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjMDAxMTIyIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDFhZmYiLz4KICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgZmlsbD0idXJsKCNwbGF5b3IpIiAvPgo8L3N2Zz4=">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Orbitron', sans-serif;
}

/* PWA Fullscreen Support */
body {
  background: black;
  color: #00eaff;
  overflow: hidden;
  /* Support for PWA fullscreen */
  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  /* Prevent text selection and context menu */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
}

/* PWA Display Mode Detection */
@media (display-mode: fullscreen) {
  body {
    padding: 0;
  }
}

@media (display-mode: standalone) {
  body {
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }
}

/* iOS Safari specific */
@supports (-webkit-appearance: none) and (stroke-color: transparent) {
  body {
    padding-top: max(env(safe-area-inset-top), 20px);
  }
}

/* Scroll apenas dentro do menu futurista */
.futuristic-menu {
  max-height: 80vh;
  overflow-y: auto;
  padding-right: 10px;
}

/* Scrollbar customizada para o menu */
.futuristic-menu::-webkit-scrollbar {
  width: 8px;
}

.futuristic-menu::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
}

.futuristic-menu::-webkit-scrollbar-thumb {
  background: rgba(255, 0, 64, 0.6);
  border-radius: 4px;
}

.futuristic-menu::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 0, 64, 0.8);
}

/* Ajustes para modo mobile */
.mobile-mode .futuristic-menu {
  max-height: 75vh;
  padding-right: 5px;
}

.mobile-mode .futuristic-menu::-webkit-scrollbar {
  width: 6px;
}
/* INTRO */
#intro {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, #001b33 0%, #000 75%);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 10000;
}
.particles {
  position: absolute;
  inset: 0;
  background: radial-gradient(#00eaff 1px, transparent 1px);
  background-size: 60px 60px;
  animation: drift 20s linear infinite;
  opacity: 0.15;
}
@keyframes drift { to { background-position: 1000px 1000px; } }
.core {
  position: absolute;
  width: 320px;
  height: 320px;
  border-radius: 50%;
  border: 2px solid #00eaff;
  box-shadow: 0 0 40px #00eaff, 0 0 120px rgba(0,234,255,.6);
  animation: pulse 3s infinite;
}
@keyframes pulse { 50% { transform: scale(1.1); } }
.big-text { text-align: center; z-index: 5; }
.big-text h1 {
  font-size: clamp(42px,7vw,120px);
  text-shadow: 0 0 30px #00eaff,0 0 90px rgba(0,234,255,.8);
  animation: fadeScale 4s forwards;
  opacity: 0;
}
@keyframes fadeScale { from { opacity:0; transform:scale(1.3); } to { opacity:1; transform:scale(1); } }
.phrase { margin-top:20px; opacity:0; animation:fade 3s forwards; animation-delay:3s; }
@keyframes fade { to { opacity:1; } }

/* TELA DE PREPARAÇÃO FUTURISTA */
#preparation {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, #001122 0%, #000 100%);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9500;
  overflow: hidden;
}

.cyber-grid {
  position: absolute;
  inset: 0;
  background-image: 
    linear-gradient(rgba(0, 234, 255, 0.1) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0, 234, 255, 0.1) 1px, transparent 1px);
  background-size: 50px 50px;
  animation: grid-move 20s linear infinite;
}

@keyframes grid-move {
  0% { transform: translate(0, 0); }
  100% { transform: translate(50px, 50px); }
}

.holographic-particles {
  position: absolute;
  inset: 0;
}

.holographic-particles::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(2px 2px at 20px 30px, #00eaff, transparent),
              radial-gradient(2px 2px at 40px 70px, rgba(0, 234, 255, 0.8), transparent),
              radial-gradient(1px 1px at 90px 40px, #00eaff, transparent),
              radial-gradient(1px 1px at 130px 80px, rgba(0, 234, 255, 0.6), transparent);
  background-repeat: repeat;
  background-size: 200px 100px;
  animation: holographic-drift 15s linear infinite;
  opacity: 0.7;
}

@keyframes holographic-drift {
  0% { transform: translateY(0); }
  100% { transform: translateY(-100px); }
}

.neural-network {
  position: absolute;
  inset: 0;
  opacity: 0.3;
}

.neural-network::after {
  content: '';
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(45deg, transparent 40%, rgba(0, 234, 255, 0.2) 50%, transparent 60%),
    linear-gradient(-45deg, transparent 40%, rgba(0, 234, 255, 0.1) 50%, transparent 60%);
  background-size: 100px 100px;
  animation: neural-pulse 8s ease-in-out infinite;
}

@keyframes neural-pulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.8; }
}

.preparation-content {
  position: relative;
  z-index: 10;
  text-align: center;
}

.cyber-frame {
  position: relative;
  background: rgba(0, 20, 40, 0.9);
  border: 2px solid #00eaff;
  border-radius: 15px;
  padding: 40px;
  box-shadow: 
    0 0 50px rgba(0, 234, 255, 0.5),
    inset 0 0 30px rgba(0, 234, 255, 0.1);
  backdrop-filter: blur(10px);
  max-width: 600px;
  animation: frame-appear 2s ease-out;
}

@keyframes frame-appear {
  0% {
    opacity: 0;
    transform: scale(0.8) rotateX(20deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotateX(0deg);
  }
}

.frame-corners {
  position: absolute;
  inset: -2px;
  border: 2px solid transparent;
  border-radius: 15px;
}

.frame-corners::before,
.frame-corners::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border: 2px solid #00eaff;
}

.frame-corners::before {
  top: -2px;
  left: -2px;
  border-right: none;
  border-bottom: none;
  animation: corner-glow 3s infinite;
}

.frame-corners::after {
  bottom: -2px;
  right: -2px;
  border-left: none;
  border-top: none;
  animation: corner-glow 3s infinite 1.5s;
}

@keyframes corner-glow {
  0%, 100% { box-shadow: 0 0 5px #00eaff; }
  50% { box-shadow: 0 0 20px #00eaff, 0 0 30px #00eaff; }
}

.warning-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  margin-bottom: 30px;
  animation: warning-pulse 2s infinite;
}

@keyframes warning-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.warning-icon {
  font-size: 24px;
  filter: hue-rotate(180deg);
}

.system-text {
  color: #00eaff;
  font-size: 14px;
  letter-spacing: 3px;
  font-weight: bold;
}

.main-question {
  margin-bottom: 30px;
}

.question-line {
  color: #00eaff;
  font-size: 28px;
  font-weight: 900;
  letter-spacing: 2px;
  margin-bottom: 8px;
  text-shadow: 0 0 20px #00eaff;
  animation: text-appear 0.8s ease-out forwards;
  opacity: 0;
}

.question-line:nth-child(1) { animation-delay: 0.5s; }
.question-line:nth-child(2) { animation-delay: 0.8s; }
.question-line:nth-child(3) { animation-delay: 1.1s; }
.question-line:nth-child(4) { animation-delay: 1.4s; }
.question-line:nth-child(5) { animation-delay: 1.7s; }

.question-line.highlight {
  color: #ffaa00;
  text-shadow: 0 0 25px #ffaa00;
}

.question-line.danger {
  color: #ff4444;
  text-shadow: 0 0 30px #ff4444;
  font-size: 32px;
}

@keyframes text-appear {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.9);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.preparation-warning {
  color: rgba(0, 234, 255, 0.8);
  font-size: 14px;
  line-height: 1.6;
  margin-bottom: 40px;
  animation: warning-fade-in 1s ease-out 2.5s forwards;
  opacity: 0;
}

.preparation-warning p {
  margin-bottom: 8px;
}

@keyframes warning-fade-in {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}

.cyber-button {
  position: relative;
  background: transparent;
  border: 2px solid #00eaff;
  color: #00eaff;
  padding: 20px 40px;
  font-size: 18px;
  font-weight: bold;
  letter-spacing: 3px;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s ease;
  overflow: hidden;
  animation: button-appear 1s ease-out 3.5s forwards;
  opacity: 0;
  transform: translateY(20px);
}

@keyframes button-appear {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

.cyber-button:hover {
  color: #000;
  background: #00eaff;
  box-shadow: 0 0 40px #00eaff;
  transform: translateY(-3px);
}

.cyber-button:hover .button-glow {
  opacity: 1;
}

.button-text {
  position: relative;
  z-index: 2;
}

.button-glow {
  position: absolute;
  inset: 0;
  background: linear-gradient(45deg, transparent, rgba(0, 234, 255, 0.3), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
  animation: button-scan 2s linear infinite;
}

@keyframes button-scan {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}
/* TRANSIÇÃO MUNDO INVERTIDO */
#transition {
  position: fixed; inset:0;
  background: #000;
  opacity:0;
  pointer-events:none;
  z-index:9000;
  transition:.8s;
}
#transition.active { opacity:1; }

/* ANIMAÇÃO MUNDO INVERTIDO STRANGER THINGS */
.upside-down-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, #1a0000 0%, #000 100%);
  overflow: hidden;
}

.red-constellation {
  position: absolute;
  inset: 0;
  opacity: 0.8;
}

.constellation-node {
  position: absolute;
  width: 4px;
  height: 4px;
  background: #ff0040;
  border-radius: 50%;
  box-shadow: 0 0 10px #ff0040, 0 0 20px #ff0040, 0 0 30px #ff0040;
  animation: pulse-red 2s infinite alternate;
}

.constellation-line {
  position: absolute;
  height: 2px;
  background: linear-gradient(90deg, transparent, #ff0040, transparent);
  transform-origin: left center;
  opacity: 0;
  animation: line-connect 3s infinite;
  box-shadow: 0 0 5px #ff0040;
}

@keyframes pulse-red {
  0% { opacity: 0.6; transform: scale(1); }
  100% { opacity: 1; transform: scale(1.3); }
}

@keyframes line-connect {
  0% { opacity: 0; width: 0; }
  50% { opacity: 0.8; }
  100% { opacity: 0.3; width: 100%; }
}

.red-particles {
  position: absolute;
  inset: 0;
  background: radial-gradient(#ff0040 1px, transparent 1px);
  background-size: 80px 80px;
  animation: drift-red 25s linear infinite;
  opacity: 0.1;
}

@keyframes drift-red { 
  to { background-position: 800px 800px; } 
}

/* MENUS FUTURISTAS VERMELHOS */
.futuristic-menu {
  position: relative;
  background: rgba(10, 0, 0, 0.9);
  border: 2px solid #ff0040;
  box-shadow: 0 0 50px rgba(255, 0, 64, 0.3), inset 0 0 30px rgba(255, 0, 64, 0.1);
  backdrop-filter: blur(10px);
  padding: 30px;
  border-radius: 10px;
  max-width: 800px;
  margin: 0 auto;
  z-index: 100;
}

.futuristic-menu h2 {
  color: #ff0040;
  text-align: center;
  font-size: 28px;
  margin-bottom: 30px;
  text-shadow: 0 0 20px #ff0040;
  letter-spacing: 3px;
}

.habit-form {
  display: grid;
  gap: 20px;
}

.habit-input-group {
  display: grid;
  grid-template-columns: 1fr 120px 80px;
  gap: 15px;
  align-items: center;
  padding: 15px;
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
  background: rgba(255, 0, 64, 0.05);
}

.habit-input {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #ff0040;
  color: #ff0040;
  padding: 10px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
}

.habit-input:focus {
  outline: none;
  box-shadow: 0 0 15px rgba(255, 0, 64, 0.5);
}

.habit-type-select {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #ff0040;
  color: #ff0040;
  padding: 10px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
}

.xp-input {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #ff0040;
  color: #ff0040;
  padding: 10px;
  border-radius: 5px;
  text-align: center;
  font-family: 'Orbitron', sans-serif;
  width: 70px;
}

.futuristic-btn {
  background: transparent;
  border: 2px solid #ff0040;
  color: #ff0040;
  padding: 15px 30px;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  letter-spacing: 2px;
  transition: all 0.3s;
  margin: 10px;
}

.futuristic-btn:hover {
  background: #ff0040;
  color: #000;
  box-shadow: 0 0 30px #ff0040;
  transform: translateY(-2px);
}

.progress-habit {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
  background: rgba(255, 0, 64, 0.05);
  margin-bottom: 15px;
}

.habit-info {
  flex: 1;
}

.habit-name {
  color: #ff0040;
  font-weight: bold;
  font-size: 16px;
}

.habit-details {
  color: rgba(255, 0, 64, 0.7);
  font-size: 12px;
  margin-top: 5px;
}

.habit-actions {
  display: flex;
  gap: 10px;
}

.btn-complete {
  background: transparent;
  border: 1px solid #00ff00;
  color: #00ff00;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s;
}

.btn-complete:hover {
  background: #00ff00;
  color: #000;
}

.btn-procrastinate {
  background: transparent;
  border: 1px solid #ff4444;
  color: #ff4444;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s;
}

.btn-procrastinate:hover {
  background: #ff4444;
  color: #000;
}

.xp-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.stat-card {
  background: rgba(255, 0, 64, 0.1);
  border: 1px solid #ff0040;
  border-radius: 8px;
  padding: 20px;
  text-align: center;
}

.stat-value {
  font-size: 24px;
  color: #ff0040;
  font-weight: bold;
}

.stat-label {
  color: rgba(255, 0, 64, 0.7);
  font-size: 12px;
  margin-top: 5px;
}

.punishment-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.punishment-content {
  background: rgba(10, 0, 0, 0.95);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 30px;
  text-align: center;
  max-width: 400px;
}

.settings-grid {
  display: grid;
  gap: 20px;
}

.setting-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
  background: rgba(255, 0, 64, 0.05);
}

.setting-label {
  color: #ff0040;
  font-weight: bold;
}

.theme-light {
  background: #f0f0f0 !important;
  color: #333 !important;
}

.theme-light .futuristic-menu {
  background: rgba(240, 240, 240, 0.95) !important;
  border-color: #ff0040 !important;
  color: #333 !important;
}

.theme-light .habit-input,
.theme-light .habit-type-select,
.theme-light .xp-input {
  background: rgba(255, 255, 255, 0.9) !important;
  color: #333 !important;
}

/* SISTEMA DE SAVES */
.save-system-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.save-section {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid rgba(255, 0, 64, 0.3);
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s ease;
}

.save-section:hover {
  border-color: rgba(255, 0, 64, 0.6);
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
}

.danger-section {
  background: rgba(255, 68, 68, 0.1);
  border-color: rgba(255, 68, 68, 0.3);
}

.danger-section:hover {
  border-color: rgba(255, 68, 68, 0.6);
  box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
}

.save-section-title {
  color: #ff0040;
  font-size: 16px;
  margin-bottom: 15px;
  text-shadow: 0 0 10px #ff0040;
}

.danger-section .save-section-title {
  color: #ff4444;
  text-shadow: 0 0 10px #ff4444;
}

.save-description {
  color: rgba(255, 0, 64, 0.8);
  font-size: 12px;
  line-height: 1.4;
  margin-bottom: 20px;
}

.danger-section .save-description {
  color: rgba(255, 68, 68, 0.8);
}

.save-btn {
  width: 100%;
  padding: 12px;
  font-size: 12px;
  margin: 0;
}

.danger-btn {
  background: transparent;
  border: 2px solid #ff4444;
  color: #ff4444;
  padding: 12px;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  letter-spacing: 2px;
  transition: all 0.3s;
  width: 100%;
  font-size: 12px;
}

.danger-btn:hover {
  background: #ff4444;
  color: #000;
  box-shadow: 0 0 30px #ff4444;
  transform: translateY(-2px);
}

.save-info {
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 0, 64, 0.2);
  border-radius: 10px;
  padding: 20px;
}

.current-save-info h4 {
  color: #ff0040;
  text-align: center;
  margin-bottom: 20px;
  font-size: 16px;
  text-shadow: 0 0 10px #ff0040;
}

.save-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
}

.save-stat {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: rgba(255, 0, 64, 0.05);
  border: 1px solid rgba(255, 0, 64, 0.2);
  border-radius: 5px;
}

.save-stat .stat-label {
  color: rgba(255, 0, 64, 0.8);
  font-size: 12px;
}

.save-stat .stat-value {
  color: #ff0040;
  font-weight: bold;
  font-size: 14px;
}

.punishment-title {
  color: #ff0040;
  margin-bottom: 20px;
}

.punishment-text {
  color: #ff0040;
  margin-bottom: 20px;
}

.xp-history-item {
  padding: 10px;
  border: 1px solid rgba(255,0,64,0.3);
  margin-bottom: 10px;
  border-radius: 5px;
}

.xp-history-title {
  color: #ff0040;
  margin-bottom: 15px;
}

.back-to-menu-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  padding: 8px 15px;
  font-size: 12px;
}

/* ÁRVORE DE HABILIDADES SKYRIM STYLE */
.skill-tree-container {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  cursor: grab;
}

.skill-tree-container:active {
  cursor: grabbing;
}

.skill-tree-canvas {
  position: relative;
  width: 200%;
  height: 200%;
  transform-origin: center;
  transition: transform 0.3s ease;
}

.skill-constellation {
  position: absolute;
  min-width: 300px;
  min-height: 200px;
}

.constellation-title {
  position: absolute;
  top: -40px;
  left: 50%;
  transform: translateX(-50%);
  color: #ff0040;
  font-size: 18px;
  font-weight: bold;
  text-shadow: 0 0 10px #ff0040;
  letter-spacing: 2px;
}

.skill-node {
  position: absolute;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 3px solid #ff0040;
  background: radial-gradient(circle, rgba(255,0,64,0.3), rgba(0,0,0,0.8));
  box-shadow: 0 0 20px rgba(255,0,64,0.6);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  color: #ff0040;
}

.skill-node:hover {
  transform: scale(1.2);
  box-shadow: 0 0 30px rgba(255,0,64,0.8);
}

.skill-node.unlocked {
  background: radial-gradient(circle, rgba(255,0,64,0.8), rgba(255,0,64,0.3));
  border-color: #ff4080;
  box-shadow: 0 0 25px rgba(255,0,64,1);
}

.skill-node.available {
  border-color: #ffaa00;
  box-shadow: 0 0 20px rgba(255,170,0,0.6);
}

.skill-connection {
  position: absolute;
  height: 3px;
  background: linear-gradient(90deg, transparent, #ff0040, transparent);
  transform-origin: left center;
  opacity: 0.6;
  pointer-events: none;
}

.skill-connection.unlocked {
  background: linear-gradient(90deg, transparent, #ff4080, transparent);
  opacity: 1;
  box-shadow: 0 0 5px #ff0040;
}

.skill-label {
  position: absolute;
  top: -25px;
  left: 50%;
  transform: translateX(-50%);
  color: #ff0040;
  font-size: 10px;
  text-align: center;
  white-space: nowrap;
  text-shadow: 0 0 5px rgba(0,0,0,0.8);
  pointer-events: none;
}

.skill-xp-bar {
  position: absolute;
  bottom: -15px;
  left: 50%;
  transform: translateX(-50%);
  width: 50px;
  height: 4px;
  background: rgba(0,0,0,0.8);
  border: 1px solid #ff0040;
  border-radius: 2px;
  overflow: hidden;
}

.skill-xp-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff0040, #ff4080);
  width: 0%;
  transition: width 0.3s ease;
}

.skill-level {
  position: absolute;
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%);
  color: #ff0040;
  font-size: 8px;
  text-align: center;
}

/* MODAL DE DETALHES DA SKILL */
.skill-detail-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.skill-detail-content {
  background: rgba(10,0,0,0.95);
  border: 2px solid #ff0040;
  border-radius: 15px;
  padding: 30px;
  max-width: 500px;
  text-align: center;
  box-shadow: 0 0 50px rgba(255,0,64,0.5);
}

.skill-detail-title {
  color: #ff0040;
  font-size: 24px;
  margin-bottom: 20px;
  text-shadow: 0 0 15px #ff0040;
}

.skill-detail-description {
  color: rgba(255,0,64,0.8);
  margin-bottom: 20px;
  line-height: 1.5;
}

.skill-detail-stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 20px;
}

.skill-stat {
  background: rgba(255,0,64,0.1);
  padding: 10px;
  border-radius: 8px;
  border: 1px solid rgba(255,0,64,0.3);
}

.skill-controls {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin-top: 20px;
}

/* CONTROLES DA ÁRVORE */
.tree-controls {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.tree-control-btn {
  background: rgba(10,0,0,0.8);
  border: 1px solid #ff0040;
  color: #ff0040;
  padding: 8px 12px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s;
}

.tree-control-btn:hover {
  background: rgba(255,0,64,0.2);
  box-shadow: 0 0 10px rgba(255,0,64,0.5);
}

.constellation-editor {
  position: fixed;
  bottom: 20px;
  left: 20px;
  background: rgba(10,0,0,0.9);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 20px;
  max-width: 300px;
  display: none;
}

.constellation-editor h4 {
  color: #ff0040;
  margin-bottom: 15px;
  text-align: center;
}

/* AVATAR UPLOAD */
.avatar-container {
  position: relative;
  display: inline-block;
}

.avatar-upload-btn {
  position: absolute;
  bottom: 5px;
  right: 5px;
  width: 35px;
  height: 35px;
  border-radius: 50%;
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid #00eaff;
  color: #00eaff;
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
  box-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
}

.avatar-upload-btn:hover {
  background: #00eaff;
  color: #000;
  transform: scale(1.1);
  box-shadow: 0 0 20px rgba(0, 234, 255, 0.8);
}

/* CALENDÁRIO DE DISCIPLINA */
.calendar-panel {
  position: relative;
  background: rgba(10, 0, 0, 0.3);
  border: 2px solid #ff0040 !important;
}

.motivational-message {
  position: absolute;
  top: -15px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(45deg, #ff0040, #ff4080);
  color: #fff;
  padding: 8px 20px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  letter-spacing: 2px;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
  border: 2px solid #ff0040;
  box-shadow: 0 0 30px rgba(255, 0, 64, 0.6);
  z-index: 10;
  animation: glow-pulse 2s infinite alternate;
}

@keyframes glow-pulse {
  0% { box-shadow: 0 0 30px rgba(255, 0, 64, 0.6); }
  100% { box-shadow: 0 0 50px rgba(255, 0, 64, 1); }
}

.discipline-calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin: 25px 0 15px 0;
  padding: 10px;
}

.calendar-day {
  aspect-ratio: 1;
  border: 1px solid rgba(0, 234, 255, 0.4);
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  color: rgba(0, 234, 255, 0.8);
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  min-height: 30px;
  background: rgba(0, 0, 0, 0.4);
}

.calendar-day:hover {
  border-color: #00eaff;
  color: #00eaff;
  background: rgba(0, 234, 255, 0.1);
  transform: scale(1.05);
}

.calendar-day.completed {
  background: linear-gradient(135deg, rgba(0, 255, 0, 0.4), rgba(0, 200, 0, 0.6));
  border: 2px solid #00ff00;
  color: #00ff00;
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.7);
  font-weight: bold;
}

.calendar-day.today {
  border: 2px solid #00eaff;
  box-shadow: 0 0 25px rgba(0, 234, 255, 0.8);
  background: rgba(0, 234, 255, 0.2);
  animation: today-pulse 3s infinite;
}

@keyframes today-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.calendar-btn {
  width: 100%;
  margin-top: 15px;
  padding: 12px;
  font-size: 12px;
  background: linear-gradient(45deg, #ff0040, #ff4080);
  border: none;
  color: #fff;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  letter-spacing: 2px;
  transition: all 0.3s;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
}

.calendar-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 30px rgba(255, 0, 64, 0.8);
  background: linear-gradient(45deg, #ff4080, #ff0040);
}

/* TABELA DE PROGRESSO DE HÁBITOS */
.progress-chart-container {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 30px;
  text-align: center;
}

.progress-chart-container h3 {
  color: #ff0040;
  margin-bottom: 20px;
  font-size: 18px;
  text-shadow: 0 0 10px #ff0040;
}

#progressChart {
  background: rgba(0, 0, 0, 0.5);
  border-radius: 8px;
  max-width: 100%;
}

.habits-table-container {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 30px;
}

.habits-table-container h3 {
  color: #ff0040;
  margin-bottom: 20px;
  font-size: 18px;
  text-shadow: 0 0 10px #ff0040;
  text-align: center;
}

.habits-table-wrapper {
  overflow-x: auto;
  max-height: 400px;
  overflow-y: auto;
}

.habits-table-header {
  display: grid;
  grid-template-columns: 200px 1fr;
  gap: 10px;
  margin-bottom: 15px;
  padding: 10px;
  background: rgba(255, 0, 64, 0.2);
  border-radius: 8px;
  border: 1px solid #ff0040;
}

.habit-name-column {
  color: #ff0040;
  font-weight: bold;
  font-size: 14px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
}

.days-header {
  display: grid;
  grid-template-columns: repeat(31, 1fr);
  gap: 2px;
  text-align: center;
}

.day-header {
  color: #ff0040;
  font-size: 10px;
  font-weight: bold;
  padding: 5px 2px;
  border-radius: 3px;
  background: rgba(255, 0, 64, 0.1);
}

.day-header.today {
  background: rgba(0, 234, 255, 0.3);
  color: #00eaff;
  box-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
}

.habits-table-body {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.habit-row {
  display: grid;
  grid-template-columns: 200px 1fr;
  gap: 10px;
  padding: 10px;
  background: rgba(255, 0, 64, 0.05);
  border-radius: 8px;
  border: 1px solid rgba(255, 0, 64, 0.2);
  transition: all 0.3s ease;
}

.habit-row:hover {
  background: rgba(255, 0, 64, 0.1);
  border-color: rgba(255, 0, 64, 0.4);
}

.habit-info-container {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 5px;
}

.habit-name {
  color: #ff0040;
  font-weight: bold;
  font-size: 14px;
  text-align: center;
}

.habit-level {
  color: #00eaff;
  font-size: 12px;
  font-weight: bold;
  text-align: center;
  text-shadow: 0 0 5px #00eaff;
}

.habit-xp-bar {
  width: 100%;
  height: 8px;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid #ff0040;
  border-radius: 4px;
  overflow: hidden;
  margin: 2px 0;
}

.habit-xp-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff0040, #ff4080);
  transition: width 0.5s ease;
  border-radius: 3px;
}

.habit-xp-text {
  color: rgba(255, 0, 64, 0.8);
  font-size: 10px;
  text-align: center;
  font-weight: bold;
}

/* Modal de Level Up do Hábito */
.habit-levelup-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease;
}

.habit-levelup-content {
  background: rgba(10, 0, 0, 0.95);
  border: 2px solid #00eaff;
  border-radius: 15px;
  padding: 30px;
  text-align: center;
  max-width: 400px;
  box-shadow: 0 0 50px rgba(0, 234, 255, 0.5);
  animation: scaleIn 0.5s ease;
}

.habit-levelup-icon {
  font-size: 48px;
  margin-bottom: 15px;
  animation: pulse 1s infinite;
}

.habit-levelup-content h3 {
  color: #00eaff;
  font-size: 24px;
  margin-bottom: 15px;
  text-shadow: 0 0 15px #00eaff;
}

.habit-levelup-content p {
  color: #ff0040;
  font-size: 18px;
  margin-bottom: 15px;
  font-weight: bold;
}

.habit-levelup-level {
  color: #ffaa00;
  font-size: 32px;
  font-weight: 900;
  margin-bottom: 20px;
  text-shadow: 0 0 20px #ffaa00;
}

@keyframes scaleIn {
  0% { transform: scale(0.5); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

.habit-days {
  display: grid;
  grid-template-columns: repeat(31, 1fr);
  gap: 2px;
}

.habit-day {
  width: 20px;
  height: 20px;
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 3px;
  background: rgba(0, 0, 0, 0.3);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  position: relative;
}

.habit-day:hover {
  border-color: #ff0040;
  background: rgba(255, 0, 64, 0.2);
  transform: scale(1.1);
}

.habit-day.completed {
  background: linear-gradient(135deg, #00ff00, #00aa00);
  border-color: #00ff00;
  color: #fff;
  box-shadow: 0 0 10px rgba(0, 255, 0, 0.6);
}

.habit-day.completed::after {
  content: '✓';
  font-weight: bold;
  font-size: 12px;
}

.habit-day.today {
  border: 2px solid #00eaff;
  box-shadow: 0 0 15px rgba(0, 234, 255, 0.8);
  background: rgba(0, 234, 255, 0.2);
}

.habit-day.future {
  opacity: 0.3;
  cursor: not-allowed;
}

.habit-day.future:hover {
  transform: none;
  border-color: rgba(255, 0, 64, 0.3);
  background: rgba(0, 0, 0, 0.3);
}

/* Responsivo para mobile */
.mobile-mode .habits-table-header {
  grid-template-columns: 150px 1fr;
}

.mobile-mode .habit-row {
  grid-template-columns: 150px 1fr;
}

.mobile-mode .habit-info-container {
  gap: 3px;
}

.mobile-mode .habit-name {
  font-size: 12px;
}

.mobile-mode .habit-level {
  font-size: 10px;
}

.mobile-mode .habit-xp-bar {
  height: 6px;
}

.mobile-mode .habit-xp-text {
  font-size: 9px;
}

.mobile-mode .habit-name-column {
  font-size: 12px;
}

.mobile-mode .days-header {
  grid-template-columns: repeat(15, 1fr);
}

.mobile-mode .habit-days {
  grid-template-columns: repeat(15, 1fr);
}

.mobile-mode .habit-day {
  width: 18px;
  height: 18px;
}

.mobile-mode .progress-chart-container {
  padding: 15px;
}

.mobile-mode .habits-table-container {
  padding: 15px;
}

.mobile-mode #progressChart {
  max-width: 100%;
  height: auto;
}

.mobile-mode .habit-levelup-content {
  max-width: 90vw;
  padding: 20px;
}

.mobile-mode .habit-levelup-content h3 {
  font-size: 20px;
}

.mobile-mode .habit-levelup-level {
  font-size: 24px;
}

/* MODO FOCO */
.focus-container {
  display: grid;
  grid-template-columns: 1fr 350px;
  gap: 30px;
  height: 100%;
}

.focus-main {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.focus-sidebar {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.music-player {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
}

.music-player h4 {
  color: #ff0040;
  margin-bottom: 15px;
  text-shadow: 0 0 10px #ff0040;
}

.focus-audio-player {
  width: 100%;
  margin-bottom: 15px;
}

.music-controls {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-top: 15px;
}

.music-btn {
  background: transparent;
  border: 1px solid #ff0040;
  color: #ff0040;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 12px;
}

.music-btn:hover {
  background: #ff0040;
  color: #000;
}

.habit-check-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.habit-check-item {
  background: rgba(255, 0, 64, 0.1);
  border: 1px solid #ff0040;
  border-radius: 8px;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.habit-check-info {
  flex: 1;
}

.habit-check-name {
  color: #ff0040;
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 5px;
}

.habit-check-type {
  color: rgba(255, 0, 64, 0.7);
  font-size: 12px;
}

.habit-check-actions {
  display: flex;
  gap: 10px;
}

.btn-done {
  background: transparent;
  border: 1px solid #00ff00;
  color: #00ff00;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 12px;
}

.btn-done:hover {
  background: #00ff00;
  color: #000;
}

.btn-not-done {
  background: transparent;
  border: 1px solid #ff4444;
  color: #ff4444;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 12px;
}

.btn-not-done:hover {
  background: #ff4444;
  color: #000;
}

.focus-stats {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid #ff0040;
  border-radius: 10px;
  padding: 20px;
}

.focus-stats h4 {
  color: #ff0040;
  margin-bottom: 15px;
  text-shadow: 0 0 10px #ff0040;
}

.stats-chart {
  width: 100%;
  height: 150px;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 8px;
  margin-top: 15px;
  position: relative;
  overflow: hidden;
}

.chart-bar {
  position: absolute;
  bottom: 0;
  width: 30px;
  border-radius: 4px 4px 0 0;
  transition: height 0.3s ease;
}

.chart-bar.success {
  background: linear-gradient(to top, #00ff00, #00aa00);
}

.chart-bar.failure {
  background: linear-gradient(to top, #ff4444, #aa0000);
}

.focus-stats-summary {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
  font-size: 12px;
}

.focus-completed-text {
  color: #00ff00;
}

.focus-procrastinated-text {
  color: #ff4444;
}

.focus-empty-state {
  text-align: center;
  color: #ff0040;
  padding: 40px;
  font-size: 18px;
}

/* MODAL DE MOTIVAÇÃO */
.motivation-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.motivation-content {
  background: rgba(10, 0, 0, 0.95);
  border: 2px solid #ff0040;
  border-radius: 15px;
  padding: 40px;
  max-width: 500px;
  text-align: center;
  box-shadow: 0 0 50px rgba(255, 0, 64, 0.5);
}

.motivation-title {
  color: #ff0040;
  font-size: 24px;
  margin-bottom: 20px;
  text-shadow: 0 0 15px #ff0040;
}

.motivation-text {
  color: rgba(255, 0, 64, 0.8);
  margin-bottom: 30px;
  line-height: 1.6;
  font-size: 16px;
}

.motivation-btn {
  background: linear-gradient(45deg, #ff0040, #ff4080);
  border: none;
  color: #fff;
  padding: 15px 30px;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  letter-spacing: 2px;
  transition: all 0.3s;
  font-size: 14px;
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
}

.motivation-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 25px rgba(255, 0, 64, 0.8);
  background: linear-gradient(45deg, #ff4080, #ff0040);
}
/* MENU HUD */
#menu {
  position: fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
}
.hud {
  width:1100px;
  height:600px;
  border:2px solid rgba(0,234,255,.6);
  box-shadow:0 0 80px rgba(0,234,255,.4);
  display:grid;
  grid-template-columns:300px 1fr 300px;
  padding:20px;
  gap:20px;
}
.panel {
  border:1px solid rgba(0,234,255,.4);
  padding:20px;
  background: rgba(0,0,0,.6);
  box-shadow:0 0 25px rgba(0,234,255,.2);
}
.panel h3 { margin-bottom:15px; font-size:16px; letter-spacing:2px; }
.menu-btn {
  margin-top:15px;
  padding:14px;
  border:1px solid #00eaff;
  background:transparent;
  color:#00eaff;
  cursor:pointer;
  transition:.3s;
  text-align:center;
}
.menu-btn:hover { background:#00eaff; color:#000; box-shadow:0 0 30px #00eaff; }
.character { display:flex; align-items:center; justify-content:center; font-size:18px; opacity:.7; }
/* TELAS */
.screen {
  position: fixed;
  inset:0;
  display:none;
  padding:40px;
  background:linear-gradient(135deg,#000814,#001d3d);
}
.screen h2 { text-align:center; margin-bottom:20px; }
/* AVATAR */
#avatarImg {
  width:160px;
  height:160px;
  object-fit:cover;
  border-radius:50%;
  border:3px solid #00eaff;
  box-shadow:0 0 30px #00eaff;
}
/* LEVEL */
.player-level { margin-top:15px; font-size:16px; }
/* XP BAR */
.xp-bar {
  width:100%;
  height:14px;
  border:1px solid #00eaff;
  margin-top:8px;
  overflow:hidden;
}
#xpFill {
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#00eaff,#00ffaa);
  box-shadow:0 0 20px #00eaff;
  transition:.4s;
}
/* FUNDO ESPACIAL */
.space-bg {
  position:absolute; inset:0; overflow:hidden; z-index:0;
  background:radial-gradient(circle at bottom,#020824,#000);
}
.stars { position:absolute; inset:-200%; background-repeat:repeat; animation:starMove linear infinite; }
.stars.small { background-image: radial-gradient(1px 1px at 20px 30px,#fff,transparent), radial-gradient(1px 1px at 80px 120px,#fff,transparent), radial-gradient(1px 1px at 200px 150px,#fff,transparent); background-size:200px 200px; animation-duration:120s; opacity:.6; }
.stars.medium { background-image: radial-gradient(2px 2px at 50px 60px,#9fdfff,transparent), radial-gradient(2px 2px at 140px 180px,#ccefff,transparent); background-size:300px 300px; animation-duration:180s; opacity:.7; }
.stars.big { background-image: radial-gradient(3px 3px at 100px 100px,#fff,transparent); background-size:400px 400px; animation-duration:240s; opacity:.8; }
@keyframes starMove { from { transform:translate(0,0); } to { transform:translate(50%,50%); } }
.hud { position:relative; z-index:2; }
.nebula { position:absolute; inset:-30%; filter:blur(120px); opacity:.35; animation:nebulaMove linear infinite; }
.nebula-1 { background: radial-gradient(circle at 30% 40%, rgba(120,160,255,.6), transparent 60%), radial-gradient(circle at 70% 60%, rgba(180,120,255,.5), transparent 65%); animation-duration:260s; }
.nebula-2 { background: radial-gradient(circle at 50% 30%, rgba(255,120,200,.4), transparent 60%), radial-gradient(circle at 20% 70%, rgba(120,200,255,.4), transparent 65%); animation-duration:320s; animation-direction:reverse; }
@keyframes nebulaMove { from { transform:translate(0,0) scale(1); } to { transform:translate(20%,15%) scale(1.1); } }
.player-panel { margin-top:20px; padding:20px; border:2px solid #00eaff; box-shadow:0 0 40px #00eaff; text-align:center; }
.player-header { display:flex; justify-content:center; align-items:center; gap:10px; font-size:18px; margin-bottom:15px; }
.player-header button { background:transparent; border:1px solid #00eaff; color:#00eaff; cursor:pointer; padding:4px 8px; }

/* SISTEMA DE CLASSES NO PAINEL */
.player-class-section {
  margin-top: 20px;
  padding: 15px;
  border: 2px solid #ff0040;
  border-radius: 10px;
  background: rgba(255, 0, 64, 0.1);
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
  cursor: pointer;
  transition: all 0.3s ease;
}

.player-class-section:hover {
  border-color: rgba(255, 0, 64, 0.8);
  box-shadow: 0 0 30px rgba(255, 0, 64, 0.5);
  transform: translateY(-2px);
}

.class-click-hint {
  color: rgba(255, 0, 64, 0.6);
  font-size: 9px;
  text-align: center;
  margin-top: 8px;
  animation: hint-pulse 2s infinite;
}

@keyframes hint-pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.class-title {
  color: #ff0040;
  font-size: 12px;
  font-weight: bold;
  letter-spacing: 2px;
  margin-bottom: 8px;
  text-shadow: 0 0 10px #ff0040;
}

.class-name {
  color: #ff0040;
  font-size: 20px;
  font-weight: 900;
  margin-bottom: 10px;
  text-shadow: 0 0 15px #ff0040;
  animation: class-glow 3s infinite alternate;
}

@keyframes class-glow {
  0% { text-shadow: 0 0 15px #ff0040; }
  100% { text-shadow: 0 0 25px #ff0040, 0 0 35px #ff0040; }
}

.class-description {
  color: rgba(255, 0, 64, 0.8);
  font-size: 10px;
  line-height: 1.3;
  margin-bottom: 12px;
  text-align: center;
}

.class-progress {
  border-top: 1px solid rgba(255, 0, 64, 0.3);
  padding-top: 10px;
}

.next-class-info {
  color: rgba(255, 0, 64, 0.7);
  font-size: 10px;
}

#nextClassNameDisplay {
  color: #ffaa00;
  font-weight: bold;
}

#nextClassLevel {
  color: rgba(255, 170, 0, 0.8);
}

/* POPUP DE TUTORIAL FUTURISTA */
.tutorial-popup {
  position: absolute;
  background: rgba(0, 20, 40, 0.95);
  border: 2px solid #00eaff;
  border-radius: 15px;
  padding: 20px;
  max-width: 300px;
  box-shadow: 
    0 0 30px rgba(0, 234, 255, 0.6),
    inset 0 0 20px rgba(0, 234, 255, 0.1);
  backdrop-filter: blur(10px);
  z-index: 1000;
  animation: popup-appear 0.8s ease-out;
  opacity: 0;
  transform: translateY(20px) scale(0.9);
}

.tutorial-popup.show {
  opacity: 1;
  transform: translateY(0) scale(1);
}

@keyframes popup-appear {
  0% {
    opacity: 0;
    transform: translateY(20px) scale(0.9);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.tutorial-popup::before {
  content: '';
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 10px solid #00eaff;
}

.tutorial-popup-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
}

.tutorial-icon {
  font-size: 20px;
  animation: tutorial-pulse 2s infinite;
}

@keyframes tutorial-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.2); }
}

.tutorial-title {
  color: #00eaff;
  font-size: 14px;
  font-weight: bold;
  letter-spacing: 1px;
  text-shadow: 0 0 10px #00eaff;
}

.tutorial-message {
  color: rgba(0, 234, 255, 0.9);
  font-size: 12px;
  line-height: 1.4;
  margin-bottom: 15px;
}

.tutorial-close {
  position: absolute;
  top: 8px;
  right: 10px;
  background: none;
  border: none;
  color: rgba(0, 234, 255, 0.7);
  cursor: pointer;
  font-size: 16px;
  transition: color 0.3s;
}

.tutorial-close:hover {
  color: #00eaff;
}

.tutorial-action {
  text-align: center;
}

.tutorial-btn {
  background: transparent;
  border: 1px solid #00eaff;
  color: #00eaff;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 11px;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
}

.tutorial-btn:hover {
  background: #00eaff;
  color: #000;
  box-shadow: 0 0 15px #00eaff;
}

/* ANIMAÇÃO DO BOTÃO DESTACADO */
.menu-btn.highlighted {
  animation: button-highlight 2s infinite;
  border-color: #00eaff !important;
  color: #00eaff !important;
  box-shadow: 0 0 20px rgba(0, 234, 255, 0.6);
}

@keyframes button-highlight {
  0%, 100% {
    box-shadow: 0 0 20px rgba(0, 234, 255, 0.6);
    border-color: #00eaff;
  }
  50% {
    box-shadow: 0 0 40px rgba(0, 234, 255, 1);
    border-color: #00ffff;
  }
}

/* POSICIONAMENTO DO POPUP */
.tutorial-popup.habits-tutorial {
  top: 50%;
  left: calc(100% + 20px);
  transform: translateY(-50%);
}

.tutorial-popup.habits-tutorial::before {
  top: 50%;
  left: -10px;
  transform: translateY(-50%) rotate(90deg);
}

/* TUTORIAL DA ÁRVORE DE HABILIDADES */
.skill-tree-tutorial-popup {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 20, 40, 0.95);
  border: 2px solid #00eaff;
  border-radius: 15px;
  padding: 25px;
  max-width: 450px;
  box-shadow: 
    0 0 40px rgba(0, 234, 255, 0.8),
    inset 0 0 30px rgba(0, 234, 255, 0.1);
  backdrop-filter: blur(15px);
  z-index: 1000;
  animation: skill-tutorial-appear 1s ease-out;
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.8);
}

.skill-tree-tutorial-popup.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

@keyframes skill-tutorial-appear {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

.tutorial-steps {
  margin: 15px 0;
}

.tutorial-step {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 12px;
  padding: 8px;
  background: rgba(0, 234, 255, 0.05);
  border-radius: 8px;
  border-left: 3px solid #00eaff;
}

.step-number {
  background: #00eaff;
  color: #000;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: bold;
  flex-shrink: 0;
}

.step-text {
  color: rgba(0, 234, 255, 0.9);
  font-size: 12px;
  line-height: 1.4;
}

.step-text strong {
  color: #00eaff;
  text-shadow: 0 0 5px #00eaff;
}

/* DESTACAR BOTÃO EDITAR */
.tree-control-btn.highlighted {
  animation: edit-button-highlight 2s infinite;
  border-color: #00eaff !important;
  color: #00eaff !important;
  box-shadow: 0 0 20px rgba(0, 234, 255, 0.8);
}

@keyframes edit-button-highlight {
  0%, 100% {
    box-shadow: 0 0 20px rgba(0, 234, 255, 0.8);
    border-color: #00eaff;
  }
  50% {
    box-shadow: 0 0 40px rgba(0, 234, 255, 1);
    border-color: #00ffff;
    transform: scale(1.05);
  }
}

/* DIÁRIO + GRÁFICO */
.diary-entries-list {
  margin-bottom: 20px;
  max-height: 150px;
  overflow-y: auto;
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 10px;
  padding: 12px;
  background: rgba(0, 0, 0, 0.3);
}

/* SEÇÃO DE FOTOS DO DIÁRIO */
.diary-photos-section {
  background: rgba(255, 0, 64, 0.05);
  border: 2px solid rgba(255, 0, 64, 0.3);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.diary-photos-section h3 {
  color: #ff0040;
  text-align: center;
  margin-bottom: 20px;
  font-size: 18px;
  text-shadow: 0 0 10px #ff0040;
}

.photo-upload-area {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-bottom: 20px;
}

.photo-upload-input {
  display: none;
}

.photo-upload-btn {
  background: linear-gradient(45deg, #ff0040, #ff4080);
  border: none;
  color: #fff;
  padding: 15px 30px;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  letter-spacing: 2px;
  transition: all 0.3s;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
  font-size: 14px;
}

.photo-upload-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 30px rgba(255, 0, 64, 0.8);
  background: linear-gradient(45deg, #ff4080, #ff0040);
}

.photo-preview {
  max-width: 200px;
  max-height: 200px;
  border-radius: 10px;
  border: 2px solid #ff0040;
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
  margin: 10px auto;
  display: block;
}

.photos-gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.photo-entry {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  transition: all 0.3s ease;
}

.photo-entry:hover {
  border-color: rgba(255, 0, 64, 0.6);
  box-shadow: 0 0 15px rgba(255, 0, 64, 0.3);
  transform: translateY(-2px);
}

.photo-entry img {
  width: 100%;
  height: 120px;
  object-fit: cover;
  border-radius: 8px;
  border: 1px solid rgba(255, 0, 64, 0.3);
  margin-bottom: 8px;
}

.photo-entry-date {
  color: #ff0040;
  font-size: 12px;
  font-weight: bold;
  margin-bottom: 5px;
}

.photo-entry-note {
  color: rgba(255, 0, 64, 0.8);
  font-size: 10px;
  line-height: 1.3;
}

.photo-measurements-display {
  background: rgba(255, 0, 64, 0.1);
  border: 1px solid rgba(255, 0, 64, 0.2);
  border-radius: 5px;
  padding: 8px;
  margin: 5px 0;
  font-size: 10px;
}

.measurement-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 3px;
}

.measurement-item:last-child {
  margin-bottom: 0;
}

.measurement-label-display {
  color: rgba(255, 0, 64, 0.7);
  font-size: 9px;
}

.measurement-value-display {
  color: #ff0040;
  font-weight: bold;
  font-size: 10px;
}

.bmi-display {
  text-align: center;
  margin-top: 5px;
  padding-top: 5px;
  border-top: 1px solid rgba(255, 0, 64, 0.2);
  color: #ffaa00;
  font-weight: bold;
  font-size: 9px;
}

.evolution-summary {
  background: rgba(0, 234, 255, 0.05);
  border: 2px solid rgba(0, 234, 255, 0.3);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.evolution-summary h4 {
  color: #00eaff;
  text-align: center;
  margin-bottom: 15px;
  font-size: 16px;
  text-shadow: 0 0 10px #00eaff;
}

.evolution-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.evolution-stat {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(0, 234, 255, 0.3);
  border-radius: 10px;
  padding: 15px;
  text-align: center;
}

.evolution-stat-label {
  color: rgba(0, 234, 255, 0.8);
  font-size: 12px;
  margin-bottom: 8px;
}

.evolution-stat-value {
  color: #00eaff;
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 5px;
}

.evolution-stat-change {
  font-size: 11px;
  font-weight: bold;
}

.evolution-stat-change.positive {
  color: #00ff00;
}

.evolution-stat-change.negative {
  color: #ff4444;
}

.evolution-stat-change.neutral {
  color: rgba(255, 255, 255, 0.6);
}

.photo-note-input {
  width: 100%;
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 0, 64, 0.3);
  color: rgba(255, 0, 64, 0.9);
  padding: 8px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
  font-size: 12px;
  margin-top: 10px;
  resize: vertical;
  min-height: 60px;
}

.photo-note-input:focus {
  border-color: #ff0040;
  box-shadow: 0 0 10px rgba(255, 0, 64, 0.3);
  outline: none;
}

.photo-note-input::placeholder {
  color: rgba(255, 0, 64, 0.5);
  font-size: 11px;
}

.photo-measurements {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin: 15px 0;
  padding: 15px;
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
}

.measurement-group {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.measurement-label {
  color: #ff0040;
  font-size: 12px;
  font-weight: bold;
  text-shadow: 0 0 5px #ff0040;
}

.measurement-input {
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 0, 64, 0.3);
  color: rgba(255, 0, 64, 0.9);
  padding: 8px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
  font-size: 12px;
  text-align: center;
}

.measurement-input:focus {
  border-color: #ff0040;
  box-shadow: 0 0 10px rgba(255, 0, 64, 0.3);
  outline: none;
}

.measurement-input::placeholder {
  color: rgba(255, 0, 64, 0.5);
  font-size: 11px;
}

.save-photo-btn {
  background: transparent;
  border: 1px solid #00ff00;
  color: #00ff00;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 11px;
  margin-top: 8px;
  transition: all 0.3s;
}

.save-photo-btn:hover {
  background: #00ff00;
  color: #000;
}

.delete-photo-btn {
  background: transparent;
  border: 1px solid #ff4444;
  color: #ff4444;
  padding: 4px 8px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 10px;
  margin-left: 5px;
  transition: all 0.3s;
}

.delete-photo-btn:hover {
  background: #ff4444;
  color: #000;
}

.diary-entry-button {
  display: block;
  width: 100%;
  background: rgba(255, 0, 64, 0.1);
  border: 1px solid rgba(255, 0, 64, 0.3);
  color: #ff0040;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  text-align: left;
}

.diary-entry-button:hover {
  background: rgba(255, 0, 64, 0.2);
  border-color: rgba(255, 0, 64, 0.6);
  box-shadow: 0 0 15px rgba(255, 0, 64, 0.3);
}

.diary-entry-date {
  font-weight: bold;
  font-size: 14px;
}

.diary-entry-preview {
  font-size: 11px;
  color: rgba(255, 0, 64, 0.7);
  margin-top: 5px;
}

.diary-entry-wellbeing {
  float: right;
  background: rgba(255, 0, 64, 0.2);
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: bold;
}

.diary-editor {
  background: rgba(255, 0, 64, 0.05);
  border: 2px solid rgba(255, 0, 64, 0.3);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
}

.diary-editor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(255, 0, 64, 0.3);
}

.diary-editor-header h3 {
  color: #ff0040;
  margin: 0;
  font-size: 18px;
  text-shadow: 0 0 10px #ff0040;
}

.diary-editor-content {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 20px;
}

.diary-left-panel {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 0, 64, 0.2);
  border-radius: 10px;
  padding: 15px;
}

.diary-right-panel {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 0, 64, 0.2);
  border-radius: 10px;
  padding: 15px;
}

.wellbeing-slider-container h4,
.diary-text-container h4 {
  color: #ff0040;
  margin-bottom: 15px;
  font-size: 16px;
  text-shadow: 0 0 10px #ff0040;
}

.wellbeing-display {
  text-align: center;
  margin-bottom: 20px;
}

.wellbeing-display span {
  font-size: 28px;
  font-weight: bold;
  color: #ff0040;
  text-shadow: 0 0 15px #ff0040;
}

.wellbeing-slider {
  width: 100%;
  height: 8px;
  border-radius: 5px;
  background: rgba(255, 0, 64, 0.2);
  outline: none;
  margin-bottom: 15px;
  -webkit-appearance: none;
}

.wellbeing-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #ff0040;
  cursor: pointer;
  box-shadow: 0 0 10px #ff0040;
}

.wellbeing-slider::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #ff0040;
  cursor: pointer;
  border: none;
  box-shadow: 0 0 10px #ff0040;
}

.slider-labels {
  display: flex;
  justify-content: space-between;
  font-size: 10px;
  color: rgba(255, 0, 64, 0.7);
}

.diary-textarea {
  width: 100%;
  height: 140px;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
  padding: 10px;
  color: rgba(255, 0, 64, 0.9);
  font-family: 'Orbitron', sans-serif;
  font-size: 10px;
  line-height: 1.3;
  resize: vertical;
  outline: none;
}

.diary-textarea:focus {
  border-color: #ff0040;
  box-shadow: 0 0 15px rgba(255, 0, 64, 0.3);
}

.diary-textarea::placeholder {
  color: rgba(255, 0, 64, 0.5);
  font-size: 11px;
}

.evolution-chart-container {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(255, 0, 64, 0.3);
  border-radius: 15px;
  padding: 18px;
}

.evolution-chart-container h3 {
  color: #ff0040;
  text-align: center;
  margin-bottom: 15px;
  font-size: 18px;
  text-shadow: 0 0 15px #ff0040;
}

.chart-container {
  background: rgba(0, 0, 0, 0.6);
  border-radius: 10px;
  padding: 12px;
  margin-bottom: 15px;
  text-align: center;
  overflow-x: auto;
}

.chart-container canvas {
  max-width: 100%;
  height: auto;
}

.chart-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.chart-stat {
  background: rgba(255, 0, 64, 0.1);
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 8px;
  padding: 12px;
  text-align: center;
}

.chart-stat .stat-label {
  color: rgba(255, 0, 64, 0.8);
  font-size: 11px;
  display: block;
  margin-bottom: 5px;
}

.chart-stat .stat-value {
  color: #ff0040;
  font-size: 16px;
  font-weight: bold;
  text-shadow: 0 0 10px #ff0040;
}

/* SISTEMA DE ATRIBUTOS */
.available-points-container {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid rgba(255, 0, 64, 0.4);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 30px;
  text-align: center;
}

.points-display {
  margin-bottom: 10px;
}

.points-label {
  color: rgba(255, 0, 64, 0.8);
  font-size: 14px;
  margin-right: 10px;
}

.points-value {
  color: #ff0040;
  font-size: 28px;
  font-weight: bold;
  text-shadow: 0 0 15px #ff0040;
  animation: points-glow 2s infinite alternate;
}

@keyframes points-glow {
  0% { text-shadow: 0 0 15px #ff0040; }
  100% { text-shadow: 0 0 25px #ff0040, 0 0 35px #ff0040; }
}

.points-info {
  color: rgba(255, 0, 64, 0.7);
  font-size: 12px;
}

.attributes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.attribute-card {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(255, 0, 64, 0.3);
  border-radius: 15px;
  padding: 20px;
  text-align: center;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.attribute-card:hover {
  border-color: rgba(255, 0, 64, 0.6);
  box-shadow: 0 0 25px rgba(255, 0, 64, 0.3);
  transform: translateY(-2px);
}

.attribute-icon {
  font-size: 48px;
  margin-bottom: 10px;
  filter: drop-shadow(0 0 10px rgba(255, 0, 64, 0.5));
}

.attribute-name {
  color: #ff0040;
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 8px;
  text-shadow: 0 0 10px #ff0040;
  letter-spacing: 1px;
}

.attribute-level {
  color: rgba(255, 0, 64, 0.8);
  font-size: 12px;
  margin-bottom: 15px;
}

.attribute-xp-bar {
  width: 100%;
  height: 8px;
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 0, 64, 0.4);
  border-radius: 4px;
  margin-bottom: 15px;
  overflow: hidden;
}

.attribute-xp-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff0040, #ff4080);
  width: 0%;
  transition: width 0.5s ease;
  box-shadow: 0 0 10px #ff0040;
}

.attribute-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
}

.attribute-btn {
  background: transparent;
  border: 2px solid #ff0040;
  color: #ff0040;
  width: 35px;
  height: 35px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 18px;
  font-weight: bold;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.attribute-btn:hover {
  background: #ff0040;
  color: #000;
  box-shadow: 0 0 15px #ff0040;
  transform: scale(1.1);
}

.attribute-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none;
}

.attribute-btn:disabled:hover {
  background: transparent;
  color: #ff0040;
  box-shadow: none;
}

.pending-points {
  color: #ffaa00;
  font-size: 18px;
  font-weight: bold;
  min-width: 30px;
  text-shadow: 0 0 10px #ffaa00;
}

.confirm-attributes {
  text-align: center;
}

.confirm-btn {
  padding: 15px 40px;
  font-size: 16px;
  background: linear-gradient(45deg, #ff0040, #ff4080);
  border: none;
  color: #fff;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
}

.confirm-btn:hover {
  background: linear-gradient(45deg, #ff4080, #ff0040);
  box-shadow: 0 0 30px rgba(255, 0, 64, 0.8);
}

/* ANIMAÇÃO DE LEVEL UP DE ATRIBUTO */
.attribute-levelup-animation {
  animation: attribute-levelup 1.5s ease-out;
}

@keyframes attribute-levelup {
  0% {
    transform: scale(1);
    box-shadow: 0 0 25px rgba(255, 0, 64, 0.3);
  }
  50% {
    transform: scale(1.05);
    box-shadow: 0 0 50px rgba(255, 0, 64, 0.8);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 25px rgba(255, 0, 64, 0.3);
  }
}

/* PARTÍCULAS DE XP */
.xp-particle {
  position: absolute;
  width: 6px;
  height: 6px;
  background: #ff0040;
  border-radius: 50%;
  box-shadow: 0 0 10px #ff0040;
  pointer-events: none;
  animation: xp-float 2s ease-out forwards;
}

@keyframes xp-float {
  0% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateY(-100px) scale(0.3);
  }
}

/* MODO CELULAR - LAYOUT REDUZIDO E CENTRALIZADO */
.mobile-layout {
  width: 100vw;
  height: 100vh;
  overflow: auto;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Modo celular desligado - comportamento normal */
body:not(.mobile-layout) {
  zoom: 1;
}

/* Modo celular ligado - reduzir e centralizar */
.mobile-layout body {
  margin: 0;
  padding: 0;
  zoom: 1;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* HUD principal - TAMANHO MÉDIO como na segunda imagem */
.mobile-layout .hud,
.mobile-layout .goggins-hud {
  width: 700px;  /* Tamanho médio - legível */
  height: 450px; /* Altura maior para não cortar nada */
  margin: 0 auto;
  position: relative;
  display: grid;
  grid-template-columns: 180px 1fr 180px; /* Painéis laterais proporcionais */
  gap: 12px; /* Gap adequado */
  padding: 12px; /* Padding adequado */
  box-sizing: border-box;
  /* Centralizar na tela sem escala excessiva */
  transform: scale(0.8); /* Escala um pouco menor para caber melhor */
  transform-origin: center center;
}

/* Painéis laterais - tamanho médio e legível */
.mobile-layout .panel,
.mobile-layout .goggins-panel {
  padding: 10px;
  font-size: 10px;
  min-width: 0;
  overflow-y: auto;
  height: 100%; /* Garantir altura total */
  display: flex;
  flex-direction: column;
}

.mobile-layout .panel h3,
.mobile-layout .goggins-panel h3 {
  font-size: 12px;
  margin-bottom: 8px;
}

.mobile-layout .menu-btn,
.mobile-layout .goggins-menu-btn {
  padding: 8px;
  font-size: 9px;
  margin-top: 6px;
  width: 100%;
  box-sizing: border-box;
}

/* Seção de classe - garantir que não corte */
.mobile-layout .player-class-section,
.mobile-layout .goggins-class-section {
  margin-top: 10px;
  padding: 8px;
  border: 2px solid #ff0040;
  border-radius: 8px;
  background: rgba(255, 0, 64, 0.1);
  cursor: pointer;
  transition: all 0.3s ease;
  min-height: auto;
  overflow: visible;
}

.mobile-layout .class-name {
  font-size: 14px;
  margin-bottom: 6px;
}

.mobile-layout .class-description {
  font-size: 8px;
  line-height: 1.2;
  margin-bottom: 8px;
}

.mobile-layout .class-progress {
  padding-top: 6px;
}

.mobile-layout .next-class-info {
  font-size: 8px;
}

/* Avatar tamanho médio */
.mobile-layout #avatarImg,
.mobile-layout .goggins-avatar-container img {
  width: 100px;
  height: 100px;
}

/* Player level e XP bar tamanho médio */
.mobile-layout .player-level {
  font-size: 12px;
}

.mobile-layout .xp-bar {
  height: 10px;
}

/* Menus futuristas - tamanho médio e legível */
.mobile-layout .futuristic-menu {
  max-width: 600px; /* Tamanho médio */
  max-height: 75vh;
  overflow-y: auto;
  margin: 20px auto;
  padding: 16px;
  box-sizing: border-box;
  transform: scale(0.85); /* Escala suave */
  transform-origin: center center;
}

.mobile-layout .futuristic-menu h2 {
  font-size: 18px;
  margin-bottom: 16px;
}

.mobile-layout .futuristic-menu h3 {
  font-size: 14px;
  margin-bottom: 12px;
}

/* Formulários de hábitos - tamanho adequado */
.mobile-layout .habit-input-group {
  grid-template-columns: 1fr 80px 50px;
  gap: 8px;
  padding: 8px;
}

.mobile-layout .habit-input,
.mobile-layout .habit-type-select,
.mobile-layout .xp-input {
  padding: 6px;
  font-size: 9px;
  min-height: 28px;
}

/* Stats cards - tamanho adequado */
.mobile-layout .xp-stats {
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 10px;
}

.mobile-layout .stat-card {
  padding: 10px;
}

.mobile-layout .stat-value {
  font-size: 16px;
}

/* Árvore de habilidades - reduzida */
.mobile-layout .skill-tree-container {
  width: 100vw;
  height: 100vh;
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  transform: scale(0.8); /* Menor */
  transform-origin: center center;
}

/* Controles da árvore - menores */
.mobile-layout .tree-controls {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1000;
}

.mobile-layout .tree-control-btn {
  padding: 6px 10px;
  font-size: 10px;
  margin-bottom: 4px;
}

/* Diário e gráficos - mais compacto */
.mobile-layout .diary-editor-content {
  grid-template-columns: 180px 1fr;
  gap: 12px;
}

.mobile-layout .diary-textarea {
  height: 100px;
  font-size: 11px;
}

/* Fotos de progresso - menores */
.mobile-layout .photos-gallery {
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 10px;
}

.mobile-layout .photo-entry img {
  height: 80px;
}

/* Tabela de hábitos - mais compacta */
.mobile-layout .habits-table-header,
.mobile-layout .habit-row {
  grid-template-columns: 140px 1fr;
}

.mobile-layout .habit-day {
  width: 16px;
  height: 16px;
  font-size: 8px;
}

/* Atributos - menores */
.mobile-layout .attributes-grid {
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 12px;
}

.mobile-layout .attribute-card {
  padding: 12px;
}

.mobile-layout .attribute-icon {
  font-size: 32px;
}

/* Modais - tamanho médio e legível */
.mobile-layout .class-modal-content,
.mobile-layout .skill-detail-content,
.mobile-layout .punishment-content,
.mobile-layout .motivation-content,
.mobile-layout .habit-levelup-content {
  max-width: 550px;
  max-height: 75vh;
  overflow-y: auto;
  margin: 0 auto;
  transform: scale(0.85);
  transform-origin: center center;
}

/* Modo Goggins - Modais tamanho médio */
.mobile-layout .goggins-confirmation-content,
.mobile-layout .goggins-brutal-content,
.mobile-layout .goggins-welcome-content {
  max-width: 550px;
  max-height: 75vh;
  overflow-y: auto;
  margin: 0 auto;
  transform: scale(0.85);
  transform-origin: center center;
}

/* Preparação - tamanho médio */
.mobile-layout .cyber-frame {
  max-width: 550px;
  max-height: 75vh;
  overflow-y: auto;
  margin: 0 auto;
  transform: scale(0.85);
  transform-origin: center center;
}

/* Intro e preparação - centralizadas e menores */
.mobile-layout #intro,
.mobile-layout #preparation {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: auto;
  transform: scale(0.9);
  transform-origin: center center;
}

.mobile-layout #intro .core {
  width: 250px;
  height: 250px;
}

.mobile-layout #intro .big-text h1 {
  font-size: clamp(28px, 5vw, 60px);
}

.mobile-layout #intro .phrase {
  font-size: clamp(11px, 2vw, 14px);
}

/* Permitir tutoriais no modo mobile, mas posicionados adequadamente */
.mobile-layout .tutorial-popup {
  display: block !important;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 280px;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
  background: rgba(0, 20, 40, 0.98);
  border: 2px solid #00eaff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 0 30px rgba(0, 234, 255, 0.8);
  backdrop-filter: blur(10px);
}

.mobile-layout .tutorial-popup::before {
  display: none; /* Remove a seta */
}

.mobile-layout .tutorial-popup .tutorial-popup-header {
  margin-bottom: 10px;
}

.mobile-layout .tutorial-popup .tutorial-icon {
  font-size: 16px;
}

.mobile-layout .tutorial-popup .tutorial-title {
  font-size: 11px;
  margin-bottom: 8px;
  color: #00eaff;
  text-shadow: 0 0 10px #00eaff;
}

.mobile-layout .tutorial-popup .tutorial-message {
  font-size: 9px;
  line-height: 1.3;
  margin-bottom: 10px;
  color: rgba(0, 234, 255, 0.9);
}

.mobile-layout .tutorial-popup .tutorial-btn {
  padding: 6px 12px;
  font-size: 9px;
  background: transparent;
  border: 1px solid #00eaff;
  color: #00eaff;
  border-radius: 5px;
  cursor: pointer;
}

.mobile-layout .tutorial-popup .tutorial-btn:hover {
  background: #00eaff;
  color: #000;
}

.mobile-layout .tutorial-close {
  position: absolute;
  top: 5px;
  right: 8px;
  font-size: 14px;
  background: none;
  border: none;
  color: rgba(0, 234, 255, 0.7);
  cursor: pointer;
}

.mobile-layout .tutorial-close:hover {
  color: #00eaff;
}

.mobile-layout .skill-tree-tutorial-popup {
  display: none !important; /* Manter este oculto pois é muito grande */
}

/* Ocultar outros elementos que podem atrapalhar */
.mobile-layout .constellation-editor {
  display: none !important;
}

/* Se precisar mostrar tutoriais, posicionar no centro */
.mobile-layout .tutorial-popup.force-show {
  display: block !important;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 80vw;
  max-height: 70vh;
  overflow-y: auto;
  z-index: 10000;
}

/* Garantir que o HUD não seja sobreposto por nada */
.mobile-layout .hud,
.mobile-layout .goggins-hud {
  z-index: 100;
  position: relative;
}

/* Scrollbars menores */
.mobile-layout ::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.mobile-layout ::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 3px;
}

.mobile-layout ::-webkit-scrollbar-thumb {
  background: rgba(255, 0, 64, 0.6);
  border-radius: 3px;
}

.mobile-layout ::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 3px;
}

.mobile-layout ::-webkit-scrollbar-thumb {
  background: rgba(255, 0, 64, 0.6);
  border-radius: 3px;
}

/* Botão voltar - menor */
.mobile-layout .back-to-menu-btn {
  position: fixed;
  top: 15px;
  right: 15px;
  z-index: 1000;
  padding: 6px 12px;
  font-size: 10px;
}

/* Touch-friendly mas menor */
.mobile-layout button,
.mobile-layout .menu-btn,
.mobile-layout .futuristic-btn,
.mobile-layout .goggins-menu-btn {
  min-height: 36px;
  touch-action: manipulation;
}

.mobile-layout input,
.mobile-layout select,
.mobile-layout textarea {
  min-height: 32px;
  touch-action: manipulation;
}

/* Para telas muito pequenas - tamanho adequado */
@media screen and (max-width: 768px) {
  .mobile-layout .hud,
  .mobile-layout .goggins-hud {
    width: 650px;
    height: 420px;
    transform: scale(0.75);
  }
  
  .mobile-layout .futuristic-menu {
    max-width: 550px;
    transform: scale(0.8);
  }
}

@media screen and (max-width: 600px) {
  .mobile-layout .hud,
  .mobile-layout .goggins-hud {
    width: 600px;
    height: 390px;
    transform: scale(0.7);
  }
  
  .mobile-layout .futuristic-menu {
    max-width: 500px;
    transform: scale(0.75);
  }
}
.goggins-btn {
  background: linear-gradient(45deg, #8B0000, #FF0000) !important;
  border: 2px solid #FF0000 !important;
  color: #FFF !important;
  text-shadow: 0 0 10px #FF0000 !important;
  box-shadow: 0 0 20px rgba(255, 0, 0, 0.5) !important;
  animation: goggins-pulse 2s infinite !important;
}

.goggins-btn:hover {
  background: linear-gradient(45deg, #FF0000, #FF4444) !important;
  box-shadow: 0 0 40px rgba(255, 0, 0, 0.8) !important;
  transform: translateY(-3px) !important;
}

.mobile-layout .goggins-btn {
  padding: 8px 15px !important;
  font-size: 10px !important;
}

/* PWA e Tela Cheia - Melhorias */
@media (display-mode: standalone) {
  /* Quando instalado como PWA */
  body {
    background: radial-gradient(circle at center, #001b33 0%, #000 75%);
  }
  
  /* Ocultar elementos desnecessários */
  .install-prompt {
    display: none !important;
  }
}

/* Fullscreen API support */
:fullscreen {
  background: radial-gradient(circle at center, #001b33 0%, #000 75%);
}

:-webkit-full-screen {
  background: radial-gradient(circle at center, #001b33 0%, #000 75%);
}

:-moz-full-screen {
  background: radial-gradient(circle at center, #001b33 0%, #000 75%);
}

/* Prevent scrolling and bouncing on iOS */
html, body {
  position: fixed;
  width: 100%;
  height: 100%;
  overflow: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Safe area for notched devices */
.mobile-layout {
  padding-top: max(env(safe-area-inset-top), 0px);
  padding-bottom: max(env(safe-area-inset-bottom), 0px);
  padding-left: max(env(safe-area-inset-left), 0px);
  padding-right: max(env(safe-area-inset-right), 0px);
}

/* Landscape orientation optimization */
@media screen and (orientation: landscape) {
  .mobile-layout .hud,
  .mobile-layout .goggins-hud {
    margin-top: 10px;
    margin-bottom: 10px;
  }
}

/* Portrait orientation - force landscape hint */
@media screen and (orientation: portrait) and (max-width: 768px) {
  .mobile-layout::before {
    content: "🔄 Gire o dispositivo para melhor experiência";
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    color: #00eaff;
    padding: 20px;
    border-radius: 10px;
    border: 2px solid #00eaff;
    z-index: 10000;
    font-size: 14px;
    text-align: center;
    animation: rotate-hint 2s infinite;
  }
}

@keyframes rotate-hint {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}

@keyframes goggins-pulse {
  0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.5); }
  50% { box-shadow: 0 0 40px rgba(255, 0, 0, 1); }
}

/* MODO GOGGINS - MODAIS DE CONFIRMAÇÃO */
.goggins-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  overflow: hidden;
}

.goggins-horror-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, #330000 0%, #000 100%);
}

.goggins-horror-bg.intense {
  background: radial-gradient(circle at center, #660000 0%, #220000 100%);
}

.blood-drips {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, transparent 0%, #8B0000 2%, transparent 4%);
  background-size: 20px 100px;
  animation: blood-fall 3s linear infinite;
  opacity: 0.7;
}

.blood-drips.fast {
  animation-duration: 1.5s;
  opacity: 0.9;
}

@keyframes blood-fall {
  0% { background-position: 0 -100px; }
  100% { background-position: 0 100vh; }
}

.horror-static {
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(1px 1px at 20px 30px, #FF0000, transparent),
    radial-gradient(1px 1px at 40px 70px, rgba(255, 0, 0, 0.8), transparent),
    radial-gradient(1px 1px at 90px 40px, #FF0000, transparent);
  background-repeat: repeat;
  background-size: 100px 100px;
  animation: static-flicker 0.1s linear infinite;
  opacity: 0.3;
}

.horror-static.intense {
  animation-duration: 0.05s;
  opacity: 0.6;
}

@keyframes static-flicker {
  0% { opacity: 0.3; transform: translate(0, 0); }
  25% { opacity: 0.6; transform: translate(-1px, 1px); }
  50% { opacity: 0.4; transform: translate(1px, -1px); }
  75% { opacity: 0.7; transform: translate(-1px, -1px); }
  100% { opacity: 0.3; transform: translate(1px, 1px); }
}

.pulsing-veins {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(45deg, transparent 40%, rgba(139, 0, 0, 0.4) 50%, transparent 60%),
    linear-gradient(-45deg, transparent 40%, rgba(139, 0, 0, 0.3) 50%, transparent 60%);
  background-size: 200px 200px;
  animation: veins-pulse 4s ease-in-out infinite;
}

.pulsing-veins.fast {
  animation-duration: 2s;
}

@keyframes veins-pulse {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.8; }
}

.horror-glitch {
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, #FF0000, transparent);
  animation: glitch-sweep 0.3s linear infinite;
  opacity: 0;
}

@keyframes glitch-sweep {
  0% { opacity: 0; transform: translateX(-100%); }
  50% { opacity: 0.8; }
  100% { opacity: 0; transform: translateX(100%); }
}

.goggins-confirmation-content {
  position: relative;
  z-index: 10;
  text-align: center;
  background: rgba(0, 0, 0, 0.9);
  border: 3px solid #FF0000;
  border-radius: 20px;
  padding: 40px;
  box-shadow: 
    0 0 50px rgba(255, 0, 0, 0.8),
    inset 0 0 30px rgba(255, 0, 0, 0.2);
  backdrop-filter: blur(10px);
}

.goggins-skull {
  font-size: 80px;
  margin-bottom: 30px;
  animation: skull-throb 2s infinite;
  filter: drop-shadow(0 0 20px #FF0000);
}

.goggins-skull.pulsing {
  animation: skull-intense 1s infinite;
}

@keyframes skull-throb {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

@keyframes skull-intense {
  0%, 100% { transform: scale(1) rotate(0deg); }
  25% { transform: scale(1.2) rotate(-2deg); }
  75% { transform: scale(1.2) rotate(2deg); }
}

.goggins-question {
  margin-bottom: 40px;
}

.question-text {
  color: #FF0000;
  font-size: 24px;
  font-weight: 900;
  margin-bottom: 10px;
  text-shadow: 0 0 20px #FF0000;
  animation: text-flicker 3s infinite;
}

.question-text.highlight-red {
  color: #FF4444;
  font-size: 28px;
  text-shadow: 0 0 30px #FF4444;
}

.question-text.shaking {
  animation: text-shake 0.5s infinite;
}

@keyframes text-flicker {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

@keyframes text-shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
}

.goggins-buttons {
  display: flex;
  gap: 30px;
  justify-content: center;
}

.goggins-btn-yes,
.goggins-btn-no {
  background: transparent;
  border: 3px solid #FF0000;
  color: #FF0000;
  padding: 15px 30px;
  font-size: 18px;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  text-shadow: 0 0 10px #FF0000;
}

.goggins-btn-yes:hover,
.goggins-btn-no:hover {
  background: #FF0000;
  color: #000;
  box-shadow: 0 0 30px #FF0000;
  transform: scale(1.1);
}

/* MODO GOGGINS - MENU PRINCIPAL */
.goggins-main-menu {
  position: fixed;
  inset: 0;
  display: none;
  overflow: hidden;
}

.goggins-nightmare-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, #4D0000 0%, #1A0000 50%, #000 100%);
}

.red-lightning {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(45deg, transparent 48%, #FF0000 49%, #FF0000 51%, transparent 52%),
    linear-gradient(-45deg, transparent 48%, #FF0000 49%, #FF0000 51%, transparent 52%);
  background-size: 300px 300px;
  animation: lightning-flash 5s linear infinite;
  opacity: 0.1;
}

@keyframes lightning-flash {
  0%, 90%, 100% { opacity: 0.1; }
  95% { opacity: 0.8; }
}

.horror-particles {
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(2px 2px at 30px 50px, #FF0000, transparent),
    radial-gradient(1px 1px at 80px 120px, rgba(255, 0, 0, 0.8), transparent),
    radial-gradient(1px 1px at 150px 80px, #FF0000, transparent);
  background-repeat: repeat;
  background-size: 200px 200px;
  animation: horror-drift 20s linear infinite;
  opacity: 0.4;
}

@keyframes horror-drift {
  0% { transform: translate(0, 0); }
  100% { transform: translate(-200px, -200px); }
}

.blood-rain {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, transparent 0%, #8B0000 1%, transparent 2%);
  background-size: 15px 200px;
  animation: rain-fall 2s linear infinite;
  opacity: 0.3;
}

@keyframes rain-fall {
  0% { background-position: 0 -200px; }
  100% { background-position: 0 100vh; }
}

.nightmare-static {
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(1px 1px at 25px 35px, #FF0000, transparent),
    radial-gradient(1px 1px at 75px 85px, rgba(255, 0, 0, 0.6), transparent);
  background-repeat: repeat;
  background-size: 150px 150px;
  animation: nightmare-flicker 0.2s linear infinite;
  opacity: 0.2;
}

@keyframes nightmare-flicker {
  0% { opacity: 0.2; }
  50% { opacity: 0.4; }
  100% { opacity: 0.2; }
}

.pulsing-red-veins {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(30deg, transparent 45%, rgba(139, 0, 0, 0.3) 50%, transparent 55%),
    linear-gradient(150deg, transparent 45%, rgba(139, 0, 0, 0.2) 50%, transparent 55%);
  background-size: 400px 400px;
  animation: red-veins-pulse 6s ease-in-out infinite;
}

@keyframes red-veins-pulse {
  0%, 100% { opacity: 0.3; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.05); }
}

/* GOGGINS HUD */
.goggins-hud {
  position: relative;
  z-index: 2;
  width: 1100px;
  height: 600px;
  margin: 50px auto;
  border: 3px solid rgba(255, 0, 0, 0.8);
  box-shadow: 0 0 80px rgba(255, 0, 0, 0.6);
  display: grid;
  grid-template-columns: 300px 1fr 300px;
  padding: 20px;
  gap: 20px;
  background: rgba(0, 0, 0, 0.3);
}

.goggins-player-panel {
  border: 2px solid #FF0000;
  padding: 20px;
  background: rgba(139, 0, 0, 0.2);
  box-shadow: 0 0 25px rgba(255, 0, 0, 0.4);
  text-align: center;
}

.goggins-player-header {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  font-size: 18px;
  margin-bottom: 15px;
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.goggins-avatar-container {
  position: relative;
  display: inline-block;
  margin-bottom: 15px;
}

.goggins-avatar-container img {
  width: 160px;
  height: 160px;
  object-fit: cover;
  border-radius: 50%;
  border: 3px solid #FF0000;
  box-shadow: 0 0 30px #FF0000;
}

.red-glow-effect {
  position: absolute;
  inset: -5px;
  border-radius: 50%;
  background: radial-gradient(circle, transparent 60%, rgba(255, 0, 0, 0.3) 100%);
  animation: red-glow-pulse 3s infinite;
}

@keyframes red-glow-pulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

.goggins-player-level {
  margin-top: 15px;
  font-size: 16px;
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.goggins-xp-bar {
  width: 100%;
  height: 14px;
  border: 2px solid #FF0000;
  margin-top: 8px;
  overflow: hidden;
  background: rgba(0, 0, 0, 0.8);
}

.goggins-xp-bar div {
  height: 100%;
  background: linear-gradient(90deg, #FF0000, #FF4444);
  box-shadow: 0 0 20px #FF0000;
  transition: 0.4s;
}

.goggins-class-section {
  margin-top: 20px;
  padding: 15px;
  border: 2px solid #FF0000;
  border-radius: 10px;
  background: rgba(255, 0, 0, 0.1);
  cursor: pointer;
  transition: all 0.3s ease;
}

.goggins-class-section:hover {
  border-color: rgba(255, 0, 0, 0.8);
  box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
  transform: translateY(-2px);
}

.goggins-class-title {
  color: #FF0000;
  font-size: 12px;
  font-weight: bold;
  letter-spacing: 2px;
  margin-bottom: 8px;
  text-shadow: 0 0 10px #FF0000;
}

.goggins-class-name {
  color: #FF0000;
  font-size: 20px;
  font-weight: 900;
  margin-bottom: 10px;
  text-shadow: 0 0 15px #FF0000;
  animation: goggins-class-glow 3s infinite alternate;
}

@keyframes goggins-class-glow {
  0% { text-shadow: 0 0 15px #FF0000; }
  100% { text-shadow: 0 0 25px #FF0000, 0 0 35px #FF0000; }
}

/* ANIMAÇÕES UNIVERSAIS PARA MODAIS */
.modal-fade-in {
  animation: modalFadeIn 0.4s ease-out forwards;
}

.modal-fade-out {
  animation: modalFadeOut 0.3s ease-in forwards;
}

@keyframes modalFadeIn {
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes modalFadeOut {
  0% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
  100% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
}

/* MODAL DE CLASSES DETALHADO */
.class-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  overflow-y: auto;
  padding: 20px;
}

.class-modal-content {
  background: rgba(10, 0, 0, 0.95);
  border: 3px solid #ff0040;
  border-radius: 20px;
  padding: 30px;
  max-width: 800px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 0 60px rgba(255, 0, 64, 0.8);
}

@keyframes class-modal-appear {
  0% {
    opacity: 0;
    transform: scale(0.8) translateY(50px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.class-modal-header {
  text-align: center;
  margin-bottom: 30px;
  border-bottom: 2px solid rgba(255, 0, 64, 0.3);
  padding-bottom: 20px;
}

.class-modal-title {
  color: #ff0040;
  font-size: 28px;
  font-weight: 900;
  margin-bottom: 10px;
  text-shadow: 0 0 20px #ff0040;
  animation: class-glow 3s infinite alternate;
}

.class-modal-subtitle {
  color: rgba(255, 0, 64, 0.8);
  font-size: 14px;
  letter-spacing: 2px;
}

.current-class-section {
  background: rgba(255, 0, 64, 0.1);
  border: 2px solid rgba(255, 0, 64, 0.4);
  border-radius: 15px;
  padding: 25px;
  margin-bottom: 30px;
  text-align: center;
}

.current-class-name {
  color: #ff0040;
  font-size: 32px;
  font-weight: 900;
  margin-bottom: 15px;
  text-shadow: 0 0 25px #ff0040;
}

.current-class-level {
  color: rgba(255, 0, 64, 0.8);
  font-size: 16px;
  margin-bottom: 20px;
  letter-spacing: 1px;
}

.current-class-description {
  color: rgba(255, 0, 64, 0.9);
  font-size: 14px;
  line-height: 1.6;
  margin-bottom: 20px;
}

.class-progress-section {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 0, 64, 0.3);
  border-radius: 10px;
  padding: 15px;
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.progress-text {
  color: rgba(255, 0, 64, 0.8);
  font-size: 12px;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 0, 64, 0.4);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 10px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff0040, #ff4080);
  transition: width 0.5s ease;
  box-shadow: 0 0 10px #ff0040;
}

.next-class-preview {
  color: rgba(255, 170, 0, 0.9);
  font-size: 12px;
  text-align: center;
}

.all-classes-section {
  margin-top: 30px;
}

.all-classes-title {
  color: #ff0040;
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 20px;
  text-align: center;
  text-shadow: 0 0 15px #ff0040;
}

.classes-grid {
  display: grid;
  gap: 15px;
  max-height: 400px;
  overflow-y: auto;
  padding-right: 10px;
}

.class-item {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(255, 0, 64, 0.2);
  border-radius: 12px;
  padding: 20px;
  transition: all 0.3s ease;
  position: relative;
}

.class-item.current {
  border-color: rgba(0, 255, 0, 0.6);
  background: rgba(0, 255, 0, 0.1);
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
}

.class-item.unlocked {
  border-color: rgba(0, 255, 0, 0.4);
  background: rgba(0, 255, 0, 0.05);
}

.class-item.locked {
  opacity: 0.6;
  border-color: rgba(255, 0, 64, 0.2);
}

.class-item:hover:not(.locked) {
  border-color: rgba(255, 0, 64, 0.6);
  box-shadow: 0 0 25px rgba(255, 0, 64, 0.4);
  transform: translateY(-2px);
}

.class-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.class-item-name {
  font-size: 18px;
  font-weight: bold;
  text-shadow: 0 0 10px;
}

.class-item.current .class-item-name {
  color: #00ff00;
  text-shadow: 0 0 15px #00ff00;
}

.class-item.unlocked .class-item-name {
  color: #00aa00;
  text-shadow: 0 0 10px #00aa00;
}

.class-item.locked .class-item-name {
  color: rgba(255, 0, 64, 0.6);
}

.class-item-level {
  color: rgba(255, 0, 64, 0.8);
  font-size: 14px;
  font-weight: bold;
}

.class-item.current .class-item-level {
  color: rgba(0, 255, 0, 0.8);
}

.class-item.unlocked .class-item-level {
  color: rgba(0, 170, 0, 0.8);
}

.class-item-status {
  position: absolute;
  top: 10px;
  right: 15px;
  font-size: 20px;
}

.class-item-description {
  color: rgba(255, 0, 64, 0.8);
  font-size: 13px;
  line-height: 1.5;
}

.class-item.current .class-item-description {
  color: rgba(0, 255, 0, 0.8);
}

.class-item.unlocked .class-item-description {
  color: rgba(0, 170, 0, 0.8);
}

.class-modal-close {
  background: linear-gradient(45deg, #ff0040, #ff4080);
  border: none;
  color: #fff;
  padding: 15px 30px;
  font-size: 16px;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  display: block;
  margin: 30px auto 0;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
  box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
}

.class-modal-close:hover {
  background: linear-gradient(45deg, #ff4080, #ff0040);
  box-shadow: 0 0 40px rgba(255, 0, 64, 0.8);
  transform: translateY(-2px);
}

.goggins-class-description {
  color: rgba(255, 0, 0, 0.8);
  font-size: 10px;
  line-height: 1.3;
  text-align: center;
}

.goggins-panel {
  border: 2px solid rgba(255, 0, 0, 0.6);
  padding: 20px;
  background: rgba(139, 0, 0, 0.1);
  box-shadow: 0 0 25px rgba(255, 0, 0, 0.3);
}

.goggins-panel h3 {
  margin-bottom: 15px;
  font-size: 16px;
  letter-spacing: 2px;
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.goggins-menu-btn {
  margin-top: 15px;
  padding: 14px;
  border: 2px solid #FF0000;
  background: transparent;
  color: #FF0000;
  cursor: pointer;
  transition: 0.3s;
  text-align: center;
  font-family: 'Orbitron', sans-serif;
  text-shadow: 0 0 5px #FF0000;
}

.goggins-menu-btn:hover {
  background: #FF0000;
  color: #000;
  box-shadow: 0 0 30px #FF0000;
  transform: translateY(-2px);
}

.exit-goggins {
  background: rgba(139, 0, 0, 0.3) !important;
  border-color: #8B0000 !important;
  color: #FF4444 !important;
}

.exit-goggins:hover {
  background: #8B0000 !important;
  color: #FFF !important;
}

/* MODAL DE MENSAGENS BRUTAIS */
.goggins-brutal-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 15000;
  overflow: hidden;
}

.goggins-brutal-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, #660000 0%, #000 100%);
}

.brutal-static {
  position: absolute;
  inset: 0;
  background: 
    radial-gradient(1px 1px at 15px 25px, #FF0000, transparent),
    radial-gradient(1px 1px at 35px 65px, rgba(255, 0, 0, 0.9), transparent),
    radial-gradient(1px 1px at 85px 35px, #FF0000, transparent);
  background-repeat: repeat;
  background-size: 80px 80px;
  animation: brutal-static-flicker 0.08s linear infinite;
  opacity: 0.4;
}

@keyframes brutal-static-flicker {
  0% { opacity: 0.4; transform: translate(0, 0); }
  25% { opacity: 0.8; transform: translate(-2px, 2px); }
  50% { opacity: 0.5; transform: translate(2px, -2px); }
  75% { opacity: 0.9; transform: translate(-2px, -2px); }
  100% { opacity: 0.4; transform: translate(2px, 2px); }
}

.brutal-lightning {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(45deg, transparent 48%, #FF0000 49%, #FF0000 51%, transparent 52%),
    linear-gradient(-45deg, transparent 48%, #FF0000 49%, #FF0000 51%, transparent 52%);
  background-size: 150px 150px;
  animation: brutal-lightning-flash 2s linear infinite;
  opacity: 0.2;
}

@keyframes brutal-lightning-flash {
  0%, 85%, 100% { opacity: 0.2; }
  90% { opacity: 1; }
}

.brutal-veins {
  position: absolute;
  inset: 0;
  background: 
    linear-gradient(30deg, transparent 40%, rgba(139, 0, 0, 0.6) 50%, transparent 60%),
    linear-gradient(150deg, transparent 40%, rgba(139, 0, 0, 0.4) 50%, transparent 60%);
  background-size: 300px 300px;
  animation: brutal-veins-pulse 3s ease-in-out infinite;
}

@keyframes brutal-veins-pulse {
  0%, 100% { opacity: 0.4; transform: scale(1); }
  50% { opacity: 0.9; transform: scale(1.1); }
}

.goggins-brutal-content {
  position: relative;
  z-index: 10;
  text-align: center;
  background: rgba(0, 0, 0, 0.95);
  border: 4px solid #FF0000;
  border-radius: 20px;
  padding: 40px;
  max-width: 600px;
  box-shadow: 
    0 0 60px rgba(255, 0, 0, 1),
    inset 0 0 40px rgba(255, 0, 0, 0.3);
  backdrop-filter: blur(15px);
  animation: brutal-content-shake 0.5s infinite;
}

@keyframes brutal-content-shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-1px); }
  75% { transform: translateX(1px); }
}

.brutal-message {
  color: #FF0000;
  font-size: 20px;
  font-weight: 900;
  margin-bottom: 30px;
  text-shadow: 0 0 20px #FF0000;
  line-height: 1.4;
  animation: brutal-text-pulse 2s infinite;
  letter-spacing: 1px;
}

@keyframes brutal-text-pulse {
  0%, 100% { 
    text-shadow: 0 0 20px #FF0000;
    transform: scale(1);
  }
  50% { 
    text-shadow: 0 0 40px #FF0000, 0 0 60px #FF0000;
    transform: scale(1.05);
  }
}

.brutal-dismiss-btn {
  background: linear-gradient(45deg, #8B0000, #FF0000);
  border: 3px solid #FF0000;
  color: #FFF;
  padding: 15px 30px;
  font-size: 16px;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  text-shadow: 0 0 10px rgba(0,0,0,0.8);
  box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
  animation: brutal-btn-glow 2s infinite;
}

@keyframes brutal-btn-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.5); }
  50% { box-shadow: 0 0 40px rgba(255, 0, 0, 1); }
}

.brutal-dismiss-btn:hover {
  background: linear-gradient(45deg, #FF0000, #FF4444);
  box-shadow: 0 0 50px rgba(255, 0, 0, 1);
  transform: scale(1.1);
}

/* GOGGINS - MODAL DE BOAS-VINDAS */
.goggins-welcome-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 12000;
  overflow: hidden;
}

.goggins-welcome-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, #4D0000 0%, #000 100%);
}

.welcome-static,
.welcome-lightning,
.welcome-veins {
  position: absolute;
  inset: 0;
  opacity: 0.3;
  animation: welcome-effects 3s ease-in-out infinite;
}

@keyframes welcome-effects {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

.goggins-welcome-content {
  position: relative;
  z-index: 10;
  text-align: center;
  background: rgba(0, 0, 0, 0.95);
  border: 4px solid #FF0000;
  border-radius: 20px;
  padding: 50px;
  max-width: 700px;
  box-shadow: 0 0 80px rgba(255, 0, 0, 1);
}

.goggins-avatar {
  font-size: 120px;
  margin-bottom: 20px;
  animation: avatar-pulse 2s infinite;
}

@keyframes avatar-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.goggins-name {
  color: #FF0000;
  font-size: 32px;
  font-weight: 900;
  margin-bottom: 30px;
  text-shadow: 0 0 20px #FF0000;
  letter-spacing: 3px;
}

.goggins-welcome-message {
  margin-bottom: 40px;
}

.message-line {
  color: #FF0000;
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 8px;
  text-shadow: 0 0 10px #FF0000;
  animation: message-appear 0.8s ease-out forwards;
  opacity: 0;
}

.message-line:nth-child(1) { animation-delay: 0.5s; }
.message-line:nth-child(2) { animation-delay: 0.8s; }
.message-line:nth-child(3) { animation-delay: 1.1s; }
.message-line:nth-child(4) { animation-delay: 1.4s; }
.message-line:nth-child(5) { animation-delay: 1.7s; }
.message-line:nth-child(6) { animation-delay: 2.0s; }
.message-line:nth-child(7) { animation-delay: 2.3s; }

.message-line.highlight {
  color: #FF4444;
  font-size: 20px;
  text-shadow: 0 0 15px #FF4444;
}

.message-line.final {
  color: #FF6666;
  font-size: 22px;
  text-shadow: 0 0 20px #FF6666;
}

@keyframes message-appear {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

.goggins-continue-btn {
  background: linear-gradient(45deg, #8B0000, #FF0000);
  border: 3px solid #FF0000;
  color: #FFF;
  padding: 20px 40px;
  font-size: 18px;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  animation: continue-btn-appear 1s ease-out 3s forwards;
  opacity: 0;
}

@keyframes continue-btn-appear {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

.goggins-continue-btn:hover {
  background: linear-gradient(45deg, #FF0000, #FF4444);
  box-shadow: 0 0 40px rgba(255, 0, 0, 1);
  transform: scale(1.05);
}

/* GOGGINS - TELAS */
.goggins-screen {
  position: fixed;
  inset: 0;
  display: none;
  padding: 40px;
  overflow-y: auto;
}

.daily-challenges-container,
.goals-container,
.unstoppable-container {
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid #FF0000;
  border-radius: 15px;
  padding: 30px;
  margin-bottom: 20px;
}

.challenge-header,
.goals-header,
.unstoppable-header {
  text-align: center;
  margin-bottom: 30px;
}

.challenge-header h3,
.goals-header h3,
.unstoppable-header h3 {
  color: #FF0000;
  font-size: 24px;
  margin-bottom: 10px;
  text-shadow: 0 0 15px #FF0000;
}

.challenge-date {
  color: rgba(255, 0, 0, 0.8);
  font-size: 14px;
}

.challenges-list,
.goals-list {
  display: grid;
  gap: 15px;
  margin-bottom: 30px;
}

.challenge-item,
.goal-item {
  background: rgba(255, 0, 0, 0.1);
  border: 2px solid rgba(255, 0, 0, 0.3);
  border-radius: 10px;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.challenge-text,
.goal-text {
  color: #FF0000;
  font-weight: bold;
  flex: 1;
}

.challenge-check,
.goal-check {
  background: transparent;
  border: 2px solid #FF0000;
  color: #FF0000;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.3s;
}

.challenge-check:hover,
.goal-check:hover {
  background: #FF0000;
  color: #000;
}

.challenge-check.completed,
.goal-check.completed {
  background: #00FF00;
  border-color: #00FF00;
  color: #000;
}

.goggins-complete-btn,
.goggins-add-btn,
.goggins-generate-btn {
  background: linear-gradient(45deg, #8B0000, #FF0000);
  border: 3px solid #FF0000;
  color: #FFF;
  padding: 15px 30px;
  font-size: 16px;
  font-weight: bold;
  border-radius: 10px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  width: 100%;
}

.goggins-complete-btn:hover,
.goggins-add-btn:hover,
.goggins-generate-btn:hover {
  background: linear-gradient(45deg, #FF0000, #FF4444);
  box-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
}

.goal-input {
  width: 100%;
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid #FF0000;
  color: #FF0000;
  padding: 15px;
  border-radius: 8px;
  font-family: 'Orbitron', sans-serif;
  margin-bottom: 15px;
}

.goal-input:focus {
  outline: none;
  box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
}

.hourly-schedule {
  display: grid;
  gap: 10px;
  margin-bottom: 30px;
}

.hour-slot {
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 8px;
  padding: 15px;
  display: grid;
  grid-template-columns: 80px 1fr 100px;
  align-items: center;
  gap: 15px;
}

.hour-time {
  color: #FF0000;
  font-weight: bold;
  font-size: 14px;
}

.hour-task {
  color: rgba(255, 0, 0, 0.9);
  font-size: 13px;
}

.hour-check {
  background: transparent;
  border: 1px solid #FF0000;
  color: #FF0000;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.3s;
}

.hour-check:hover {
  background: #FF0000;
  color: #000;
}

.hour-check.completed {
  background: #00FF00;
  border-color: #00FF00;
  color: #000;
}

.sleep-info {
  color: rgba(255, 0, 0, 0.7);
  font-size: 14px;
  font-style: italic;
}

/* GOGGINS - TELA DE DESCONFORTO */
.discomfort-container {
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid #FF0000;
  border-radius: 15px;
  padding: 30px;
  margin: 20px;
  position: relative;
  z-index: 2;
}

.discomfort-header {
  text-align: center;
  margin-bottom: 30px;
  border-bottom: 2px solid rgba(255, 0, 0, 0.3);
  padding-bottom: 20px;
}

.discomfort-header h2 {
  color: #FF0000;
  font-size: 32px;
  font-weight: 900;
  margin-bottom: 10px;
  text-shadow: 0 0 20px #FF0000;
  animation: goggins-class-glow 3s infinite alternate;
}

.discomfort-subtitle {
  color: rgba(255, 0, 0, 0.8);
  font-size: 16px;
  letter-spacing: 2px;
}

.discomfort-main-content {
  display: grid;
  grid-template-columns: 400px 1fr;
  gap: 30px;
  height: 70vh;
}

/* INSTRUTOR GOGGINS */
.goggins-instructor {
  background: rgba(139, 0, 0, 0.2);
  border: 2px solid rgba(255, 0, 0, 0.4);
  border-radius: 15px;
  padding: 25px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.instructor-header {
  display: flex;
  align-items: center;
  gap: 15px;
  border-bottom: 1px solid rgba(255, 0, 0, 0.3);
  padding-bottom: 15px;
}

.instructor-avatar {
  font-size: 48px;
  animation: avatar-pulse 2s infinite;
}

.instructor-info h3 {
  color: #FF0000;
  font-size: 18px;
  font-weight: bold;
  text-shadow: 0 0 10px #FF0000;
  margin-bottom: 5px;
}

.instructor-subtitle {
  color: rgba(255, 0, 0, 0.7);
  font-size: 12px;
  letter-spacing: 1px;
}

.instructor-message {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(255, 0, 0, 0.3);
  border-radius: 10px;
  padding: 20px;
  border-left: 4px solid #FF0000;
}

.instructor-message p {
  color: rgba(255, 0, 0, 0.9);
  font-size: 13px;
  line-height: 1.5;
  margin-bottom: 10px;
  font-weight: bold;
}

.instructor-message p:last-child {
  margin-bottom: 0;
}

.instructor-suggestions {
  flex: 1;
}

.instructor-suggestions h4 {
  color: #FF0000;
  font-size: 14px;
  margin-bottom: 15px;
  text-shadow: 0 0 10px #FF0000;
}

.suggestions-list {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 0, 0, 0.2);
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  max-height: 200px;
  overflow-y: auto;
}

.suggestion-item {
  color: rgba(255, 0, 0, 0.8);
  font-size: 12px;
  line-height: 1.4;
  margin-bottom: 12px;
  padding: 8px;
  background: rgba(255, 0, 0, 0.05);
  border-radius: 5px;
  border-left: 3px solid #FF0000;
}

.suggestion-item:last-child {
  margin-bottom: 0;
}

.instructor-btn {
  background: linear-gradient(45deg, #8B0000, #FF0000);
  border: 2px solid #FF0000;
  color: #FFF;
  padding: 10px 20px;
  font-size: 12px;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
  width: 100%;
}

.instructor-btn:hover {
  background: linear-gradient(45deg, #FF0000, #FF4444);
  box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
}

/* ÁRVORE DE DESCONFORTO */
.discomfort-tree-section {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(255, 0, 0, 0.3);
  border-radius: 15px;
  padding: 20px;
  display: flex;
  flex-direction: column;
}

.tree-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  border-bottom: 1px solid rgba(255, 0, 0, 0.3);
  padding-bottom: 15px;
}

.tree-header h3 {
  color: #FF0000;
  font-size: 18px;
  text-shadow: 0 0 10px #FF0000;
}

.tree-controls {
  display: flex;
  gap: 10px;
}

.discomfort-tree-container {
  flex: 1;
  position: relative;
  overflow: hidden;
  cursor: grab;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 10px;
  min-height: 400px;
}

.discomfort-tree-container:active {
  cursor: grabbing;
}

.discomfort-tree-canvas {
  position: relative;
  width: 200%;
  height: 200%;
  transform-origin: center;
  transition: transform 0.3s ease;
}

/* NÓS DE DESCONFORTO */
.discomfort-category {
  position: absolute;
  min-width: 250px;
  min-height: 150px;
}

.category-title {
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  color: #FF0000;
  font-size: 16px;
  font-weight: bold;
  text-shadow: 0 0 10px #FF0000;
  letter-spacing: 2px;
}

.discomfort-node {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 3px solid #FF0000;
  background: radial-gradient(circle, rgba(255,0,0,0.3), rgba(0,0,0,0.8));
  box-shadow: 0 0 20px rgba(255,0,0,0.6);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
}

.discomfort-node:hover {
  transform: scale(1.2);
  box-shadow: 0 0 30px rgba(255,0,0,0.8);
}

.discomfort-node.locked {
  background: radial-gradient(circle, rgba(100,0,0,0.3), rgba(0,0,0,0.8));
  border-color: #660000;
  box-shadow: 0 0 10px rgba(100,0,0,0.4);
  opacity: 0.6;
}

.discomfort-node.unlocked {
  background: radial-gradient(circle, rgba(255,0,0,0.8), rgba(255,0,0,0.3));
  border-color: #FF4080;
  box-shadow: 0 0 25px rgba(255,0,0,1);
  animation: unlocked-glow 2s infinite alternate;
}

@keyframes unlocked-glow {
  0% { box-shadow: 0 0 25px rgba(255,0,0,1); }
  100% { box-shadow: 0 0 40px rgba(255,0,0,1), 0 0 60px rgba(255,0,0,0.8); }
}

.discomfort-node-label {
  position: absolute;
  top: -35px;
  left: 50%;
  transform: translateX(-50%);
  color: #FF0000;
  font-size: 10px;
  text-align: center;
  white-space: nowrap;
  text-shadow: 0 0 5px rgba(0,0,0,0.8);
  pointer-events: none;
  max-width: 80px;
  overflow: hidden;
  text-overflow: ellipsis;
}

.difficulty-indicator {
  position: absolute;
  bottom: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 8px;
  padding: 2px 6px;
  border-radius: 10px;
  font-weight: bold;
}

.difficulty-easy {
  background: rgba(0, 255, 0, 0.2);
  color: #00FF00;
  border: 1px solid #00FF00;
}

.difficulty-medium {
  background: rgba(255, 255, 0, 0.2);
  color: #FFFF00;
  border: 1px solid #FFFF00;
}

.difficulty-hard {
  background: rgba(255, 165, 0, 0.2);
  color: #FFA500;
  border: 1px solid #FFA500;
}

.difficulty-extreme {
  background: rgba(255, 0, 0, 0.2);
  color: #FF0000;
  border: 1px solid #FF0000;
}

/* CONEXÕES DA ÁRVORE */
.discomfort-connection {
  position: absolute;
  height: 3px;
  background: linear-gradient(90deg, transparent, #FF0000, transparent);
  transform-origin: left center;
  opacity: 0.6;
  pointer-events: none;
}

.discomfort-connection.unlocked {
  background: linear-gradient(90deg, transparent, #FF4080, transparent);
  opacity: 1;
  box-shadow: 0 0 5px #FF0000;
}

/* EDITOR DE DESCONFORTO */
.discomfort-editor {
  position: absolute;
  bottom: 20px;
  left: 20px;
  background: rgba(139, 0, 0, 0.9);
  border: 2px solid #FF0000;
  border-radius: 10px;
  padding: 20px;
  max-width: 350px;
  display: none;
}

.discomfort-editor h4 {
  color: #FF0000;
  margin-bottom: 15px;
  text-align: center;
  text-shadow: 0 0 10px #FF0000;
}

.editor-form {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.editor-input-group {
  display: flex;
  gap: 10px;
  align-items: center;
}

.discomfort-input {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #FF0000;
  color: #FF0000;
  padding: 8px 12px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
  font-size: 12px;
  flex: 1;
}

.discomfort-input:focus {
  outline: none;
  box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
}

.discomfort-select {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid #FF0000;
  color: #FF0000;
  padding: 8px 12px;
  border-radius: 5px;
  font-family: 'Orbitron', sans-serif;
  font-size: 12px;
}

.discomfort-btn {
  background: transparent;
  border: 2px solid #FF0000;
  color: #FF0000;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  font-size: 11px;
  font-weight: bold;
  transition: all 0.3s;
  white-space: nowrap;
}

.discomfort-btn:hover {
  background: #FF0000;
  color: #000;
  box-shadow: 0 0 15px #FF0000;
}

/* O ARQUITETO - TELAS */
.architect-container,
.goggins-architect-container {
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid #00eaff;
  border-radius: 15px;
  padding: 30px;
  margin: 20px;
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 20px auto;
  max-height: 90vh;
  overflow-y: auto;
}

.goggins-architect-container {
  border-color: #FF0000;
}

.architect-header,
.goggins-architect-header {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 30px;
  border-bottom: 2px solid rgba(0, 234, 255, 0.3);
  padding-bottom: 20px;
}

.goggins-architect-header {
  border-bottom-color: rgba(255, 0, 0, 0.3);
}

.architect-avatar,
.goggins-architect-avatar {
  font-size: 64px;
  animation: avatar-pulse 2s infinite;
}

.architect-info h2,
.goggins-architect-info h2 {
  color: #00eaff;
  font-size: 32px;
  font-weight: 900;
  margin-bottom: 8px;
  text-shadow: 0 0 20px #00eaff;
}

.goggins-architect-info h2 {
  color: #FF0000;
  text-shadow: 0 0 20px #FF0000;
}

.architect-subtitle,
.goggins-architect-subtitle {
  color: rgba(0, 234, 255, 0.8);
  font-size: 14px;
  letter-spacing: 2px;
}

.goggins-architect-subtitle {
  color: rgba(255, 0, 0, 0.8);
}

.architect-main,
.goggins-architect-main {
  display: grid;
  grid-template-columns: 1fr 400px;
  gap: 30px;
  height: 65vh;
  max-height: 600px;
}

/* SEÇÃO DE CHAT */
.architect-chat-section,
.goggins-chat-section {
  background: rgba(0, 234, 255, 0.05);
  border: 2px solid rgba(0, 234, 255, 0.3);
  border-radius: 15px;
  padding: 20px;
  display: flex;
  flex-direction: column;
}

.goggins-chat-section {
  background: rgba(255, 0, 0, 0.05);
  border-color: rgba(255, 0, 0, 0.3);
}

.chat-header,
.goggins-chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  border-bottom: 1px solid rgba(0, 234, 255, 0.3);
  padding-bottom: 15px;
}

.goggins-chat-header {
  border-bottom-color: rgba(255, 0, 0, 0.3);
}

.chat-header h3,
.goggins-chat-header h3 {
  color: #00eaff;
  font-size: 16px;
  text-shadow: 0 0 10px #00eaff;
}

.goggins-chat-header h3 {
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.architect-status,
.goggins-architect-status {
  background: rgba(0, 255, 0, 0.2);
  color: #00FF00;
  padding: 4px 12px;
  border-radius: 15px;
  font-size: 12px;
  border: 1px solid #00FF00;
}

.goggins-architect-status {
  background: rgba(255, 0, 0, 0.2);
  color: #FF0000;
  border-color: #FF0000;
}

.chat-messages,
.goggins-chat-messages {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 20px;
  padding-right: 10px;
  max-height: 400px;
  min-height: 300px;
  border: 1px solid rgba(0, 234, 255, 0.2);
  border-radius: 10px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.2);
}

.goggins-chat-messages {
  border-color: rgba(255, 0, 0, 0.2);
}

/* Customizar scrollbar */
.chat-messages::-webkit-scrollbar,
.goggins-chat-messages::-webkit-scrollbar {
  width: 8px;
}

.chat-messages::-webkit-scrollbar-track,
.goggins-chat-messages::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
}

.chat-messages::-webkit-scrollbar-thumb,
.goggins-chat-messages::-webkit-scrollbar-thumb {
  background: rgba(0, 234, 255, 0.5);
  border-radius: 4px;
}

.goggins-chat-messages::-webkit-scrollbar-thumb {
  background: rgba(255, 0, 0, 0.5);
}

.chat-messages::-webkit-scrollbar-thumb:hover,
.goggins-chat-messages::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 234, 255, 0.8);
}

.goggins-chat-messages::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 0, 0, 0.8);
}

.architect-message,
.goggins-architect-message {
  display: flex;
  gap: 15px;
  margin-bottom: 15px;
  animation: message-appear 0.5s ease-out;
  align-items: flex-start;
}

.message-avatar,
.goggins-message-avatar {
  font-size: 24px;
  flex-shrink: 0;
  margin-top: 5px;
}

.message-content,
.goggins-message-content {
  background: rgba(0, 0, 0, 0.4);
  border: 1px solid rgba(0, 234, 255, 0.3);
  border-radius: 15px;
  padding: 12px 15px;
  border-left: 4px solid #00eaff;
  flex: 1;
  word-wrap: break-word;
  max-width: calc(100% - 50px);
}

.goggins-message-content {
  border-color: rgba(255, 0, 0, 0.3);
  border-left-color: #FF0000;
}

.message-content p,
.goggins-message-content p {
  color: rgba(0, 234, 255, 0.9);
  font-size: 13px;
  line-height: 1.4;
  margin-bottom: 8px;
}

.goggins-message-content p {
  color: rgba(255, 0, 0, 0.9);
}

.message-content p:last-child,
.goggins-message-content p:last-child {
  margin-bottom: 0;
}

.message-content ul,
.goggins-message-content ul {
  margin: 8px 0;
  padding-left: 18px;
}

.message-content li,
.goggins-message-content li {
  color: rgba(0, 234, 255, 0.8);
  margin-bottom: 4px;
  font-size: 12px;
}

.goggins-message-content li {
  color: rgba(255, 0, 0, 0.8);
}

/* Mensagens do usuário */
.user-message {
  display: flex;
  gap: 15px;
  margin-bottom: 15px;
  animation: message-appear 0.5s ease-out;
  align-items: flex-start;
  flex-direction: row-reverse;
}

.user-message .message-content,
.user-message .goggins-message-content {
  background: rgba(0, 234, 255, 0.1);
  border-left: 4px solid #00eaff;
  border-color: rgba(0, 234, 255, 0.4);
}

.user-message .goggins-message-content {
  background: rgba(255, 0, 0, 0.1);
  border-left-color: #FF0000;
  border-color: rgba(255, 0, 0, 0.4);
}

.user-message .message-content p,
.user-message .goggins-message-content p {
  color: rgba(0, 234, 255, 1);
  font-weight: 500;
}

.user-message .goggins-message-content p {
  color: rgba(255, 0, 0, 1);
}

.chat-input-section,
.goggins-chat-input-section {
  display: flex;
  gap: 10px;
}

.chat-input,
.goggins-chat-input {
  flex: 1;
  background: rgba(0, 0, 0, 0.6);
  border: 2px solid rgba(0, 234, 255, 0.4);
  color: #00eaff;
  padding: 12px 15px;
  border-radius: 25px;
  font-family: 'Orbitron', sans-serif;
  font-size: 14px;
  outline: none;
}

.goggins-chat-input {
  border-color: rgba(255, 0, 0, 0.4);
  color: #FF0000;
}

.chat-input:focus,
.goggins-chat-input:focus {
  border-color: #00eaff;
  box-shadow: 0 0 15px rgba(0, 234, 255, 0.3);
}

.goggins-chat-input:focus {
  border-color: #FF0000;
  box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
}

.chat-send-btn,
.goggins-chat-send-btn {
  background: linear-gradient(45deg, #00eaff, #00aaff);
  border: none;
  color: #000;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 18px;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.goggins-chat-send-btn {
  background: linear-gradient(45deg, #FF0000, #FF4444);
  color: #FFF;
}

.chat-send-btn:hover,
.goggins-chat-send-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 0 20px rgba(0, 234, 255, 0.6);
}

.goggins-chat-send-btn:hover {
  box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
}

/* SEÇÃO DE FERRAMENTAS */
.architect-tools-section,
.goggins-architect-tools-section {
  background: rgba(0, 0, 0, 0.4);
  border: 2px solid rgba(0, 234, 255, 0.3);
  border-radius: 15px;
  padding: 20px;
}

.goggins-architect-tools-section {
  border-color: rgba(255, 0, 0, 0.3);
}

.architect-tools-section h3,
.goggins-architect-tools-section h3 {
  color: #00eaff;
  font-size: 16px;
  margin-bottom: 20px;
  text-shadow: 0 0 10px #00eaff;
}

.goggins-architect-tools-section h3 {
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.architect-tools,
.goggins-architect-tools {
  display: grid;
  gap: 15px;
}

.tool-card,
.goggins-tool-card {
  background: rgba(0, 234, 255, 0.05);
  border: 2px solid rgba(0, 234, 255, 0.2);
  border-radius: 12px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.goggins-tool-card {
  background: rgba(255, 0, 0, 0.05);
  border-color: rgba(255, 0, 0, 0.2);
}

.tool-card:hover,
.goggins-tool-card:hover {
  border-color: rgba(0, 234, 255, 0.6);
  box-shadow: 0 0 25px rgba(0, 234, 255, 0.3);
  transform: translateY(-3px);
}

.goggins-tool-card:hover {
  border-color: rgba(255, 0, 0, 0.6);
  box-shadow: 0 0 25px rgba(255, 0, 0, 0.3);
}

.tool-icon,
.goggins-tool-icon {
  font-size: 32px;
  margin-bottom: 10px;
}

.tool-title,
.goggins-tool-title {
  color: #00eaff;
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 8px;
  text-shadow: 0 0 10px #00eaff;
}

.goggins-tool-title {
  color: #FF0000;
  text-shadow: 0 0 10px #FF0000;
}

.tool-description,
.goggins-tool-description {
  color: rgba(0, 234, 255, 0.8);
  font-size: 12px;
  line-height: 1.4;
}

.goggins-tool-description {
  color: rgba(255, 0, 0, 0.8);
}

@keyframes message-appear {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}
@keyframes levelUpExplosion {
  0% { 
    transform: scale(1); 
    box-shadow: 0 0 40px #00eaff; 
  }
  50% { 
    transform: scale(1.2); 
    box-shadow: 0 0 100px #00eaff, 0 0 200px rgba(0, 234, 255, 0.8); 
  }
  100% { 
    transform: scale(1); 
    box-shadow: 0 0 40px #00eaff; 
  }
}

@keyframes classUpExplosion {
  0% { 
    transform: scale(1); 
    box-shadow: 0 0 20px rgba(255, 0, 64, 0.3); 
  }
  25% { 
    transform: scale(1.3); 
    box-shadow: 0 0 80px #ff0040, 0 0 160px rgba(255, 0, 64, 0.8); 
  }
  50% { 
    transform: scale(1.1); 
    box-shadow: 0 0 120px #ff0040, 0 0 240px rgba(255, 0, 64, 0.9); 
  }
  75% { 
    transform: scale(1.2); 
    box-shadow: 0 0 100px #ff0040, 0 0 200px rgba(255, 0, 64, 0.8); 
  }
  100% { 
    transform: scale(1); 
    box-shadow: 0 0 20px rgba(255, 0, 64, 0.3); 
  }
}

.level-up-animation {
  animation: levelUpExplosion 1.5s ease-in-out;
}

.class-up-animation {
  animation: classUpExplosion 2s ease-in-out;
}

/* PARTÍCULAS DE LEVEL UP */
.level-up-particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9999;
}

.particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: #00eaff;
  border-radius: 50%;
  box-shadow: 0 0 10px #00eaff;
  animation: particleFloat 2s ease-out forwards;
}

.particle.class-particle {
  background: #ff0040;
  box-shadow: 0 0 10px #ff0040;
}

@keyframes particleFloat {
  0% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translateY(-200px) scale(0);
  }
}
</style>
</head>
<body>
<!-- INTRO -->
<div id="intro">
  <div class="particles"></div>
  <div class="core"></div>
  <div class="big-text">
    <h1>O JOGO DA DISCIPLINA</h1>
    <div class="phrase">Somente a disciplina decide quem você se torna.</div>
  </div>
</div>

<!-- TELA DE PREPARAÇÃO -->
<div id="preparation">
  <div class="cyber-grid"></div>
  <div class="holographic-particles"></div>
  <div class="neural-network"></div>
  
  <div class="preparation-content">
    <div class="cyber-frame">
      <div class="frame-corners"></div>
      <div class="preparation-text">
        <div class="warning-header">
          <div class="warning-icon">⚠️</div>
          <div class="system-text">SISTEMA INICIANDO...</div>
        </div>
        
        <div class="main-question">
          <div class="question-line">VOCÊ ESTÁ PREPARADO</div>
          <div class="question-line">PARA COMEÇAR UMA</div>
          <div class="question-line highlight">LONGA JORNADA</div>
          <div class="question-line">DE DISCIPLINA</div>
          <div class="question-line danger">ÁRDUA?</div>
        </div>
        
        <div class="preparation-warning">
          <p>Esta jornada irá testar seus limites mentais.</p>
          <p>Você enfrentará seus demônios internos.</p>
          <p>Apenas os mais determinados sobrevivem.</p>
        </div>
        
        <button id="startJourneyBtn" class="cyber-button">
          <span class="button-text">INICIAR JORNADA</span>
          <div class="button-glow"></div>
        </button>
      </div>
    </div>
  </div>
</div>

<div id="transition"></div>

<div id="menu">
  <div class="space-bg">
    <div class="nebula nebula-1"></div>
    <div class="nebula nebula-2"></div>
    <div class="stars small"></div>
    <div class="stars medium"></div>
    <div class="stars big"></div>
  </div>

  <div class="hud">
    <div class="player-panel">
      <div class="player-header">
        <span id="playerName">Player</span>
        <button type="button" onclick="editName()">✏️</button>
      </div>
      <div class="avatar-container">
        <img id="avatarImg" src="https://via.placeholder.com/160" alt="Avatar do Player">
        <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
        <button type="button" class="avatar-upload-btn" onclick="document.getElementById('avatarUpload').click()">📷</button>
      </div>
      <div class="player-level">
        NÍVEL <span id="playerLevel">1</span>
      </div>
      <div class="xp-bar">
        <div id="xpFill"></div>
      </div>
      
      <!-- Sistema de Classes -->
      <div class="player-class-section" onclick="showClassModal()">
        <div class="class-title">CLASSE</div>
        <div class="class-name" id="playerClassName">BETA</div>
        <div class="class-description" id="playerClassDescription">Você está apenas começando sua jornada...</div>
        <div class="class-progress">
          <div class="next-class-info">
            <span>Próxima: </span>
            <span id="nextClassNameDisplay">INICIANTE</span>
            <span id="nextClassLevel">(Nv. 3)</span>
          </div>
        </div>
        <div class="class-click-hint">🔍 Clique para ver detalhes</div>
      </div>
    </div>

    <div class="panel">
      <h3>PROFILE</h3>
      <div class="menu-btn" data-go="habits" id="habitsBtn">CRIAR HÁBITOS</div>
      <div class="menu-btn" data-go="focus">MODO FOCO</div>
      <div class="menu-btn" data-go="skilltree">ÁRVORE DE HÁBITOS</div>
      <div class="menu-btn" data-go="xp">SISTEMA DE XP</div>
      <div class="menu-btn" data-go="diary">DIÁRIO + GRÁFICO</div>
      
      <!-- Popup Tutorial -->
      <div id="habitsTutorial" class="tutorial-popup habits-tutorial">
        <button class="tutorial-close" onclick="closeTutorialPopup()">&times;</button>
        <div class="tutorial-popup-header">
          <div class="tutorial-icon">🎯</div>
          <div class="tutorial-title">PRIMEIRA MISSÃO</div>
        </div>
        <div class="tutorial-message">
          Guerreiro! Você precisa criar seus hábitos para começar sua jornada de disciplina. 
          <br><br>
          Clique em "CRIAR HÁBITOS" para definir suas metas diárias!
        </div>
        <div class="tutorial-action">
          <button class="tutorial-btn" onclick="goToHabitsFromTutorial()">CRIAR AGORA</button>
        </div>
      </div>
    </div>

    <div class="panel">
      <h3>SISTEMA</h3>
      <div class="menu-btn" data-go="attributes">DISTRIBUIÇÃO DE PONTOS</div>
      <div class="menu-btn" data-go="progress">PROGRESSO</div>
      <div class="menu-btn" data-go="settings">CONFIGURAÇÕES</div>
      <div class="menu-btn" onclick="openArchitect()">🤖 O ARQUITETO</div>
      <div class="menu-btn goggins-btn" onclick="startGogginsMode()">MODO TURBO</div>
    </div>
  </div>
</div>

<div id="skilltree" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>

  <div class="tree-controls">
    <button type="button" class="tree-control-btn" onclick="goToMenu()">← MENU</button>
    <button type="button" class="tree-control-btn" onclick="resetTreeView()">🎯 CENTRALIZAR</button>
    <button type="button" class="tree-control-btn" onclick="toggleEditor()" id="editBtn">✏️ EDITAR</button>
  </div>

  <div class="skill-tree-container" id="skillTreeContainer">
    <div class="skill-tree-canvas" id="skillTreeCanvas">
      <!-- Constelações serão geradas dinamicamente -->
    </div>
    
    <!-- Tutorial da Árvore de Habilidades -->
    <div id="skillTreeTutorial" class="skill-tree-tutorial-popup">
      <button class="tutorial-close" onclick="closeSkillTreeTutorial()">&times;</button>
      <div class="tutorial-popup-header">
        <div class="tutorial-icon">🌟</div>
        <div class="tutorial-title">ÁRVORE DE HABILIDADES</div>
      </div>
      <div class="tutorial-message">
        <p><strong>Como criar suas constelações de habilidades:</strong></p>
        <div class="tutorial-steps">
          <div class="tutorial-step">
            <span class="step-number">1</span>
            <span class="step-text">Clique em <strong>"✏️ EDITAR"</strong> para abrir o editor</span>
          </div>
          <div class="tutorial-step">
            <span class="step-number">2</span>
            <span class="step-text">Digite o nome da <strong>Constelação</strong> (ex: "Fitness", "Estudos")</span>
          </div>
          <div class="tutorial-step">
            <span class="step-number">3</span>
            <span class="step-text">Clique em <strong>"CRIAR"</strong> para criar a constelação</span>
          </div>
          <div class="tutorial-step">
            <span class="step-number">4</span>
            <span class="step-text">Digite o nome da <strong>Habilidade</strong> e defina o XP</span>
          </div>
          <div class="tutorial-step">
            <span class="step-number">5</span>
            <span class="step-text">Clique em <strong>"ADICIONAR"</strong> para criar a habilidade</span>
          </div>
        </div>
      </div>
      <div class="tutorial-action">
        <button class="tutorial-btn" onclick="startSkillTreeTutorial()">COMEÇAR AGORA</button>
      </div>
    </div>
  </div>

  <div class="constellation-editor" id="constellationEditor">
    <h4>EDITOR DE CONSTELAÇÃO</h4>
    <div class="habit-input-group">
      <input type="text" class="habit-input" id="newConstellationName" placeholder="Nome da Constelação">
      <button type="button" class="futuristic-btn" onclick="addConstellation()">CRIAR</button>
    </div>
    <div class="habit-input-group">
      <input type="text" class="habit-input" id="newSkillName" placeholder="Nome da Habilidade">
      <input type="number" class="xp-input" id="newSkillXP" placeholder="XP" min="1" max="100" value="20">
      <button type="button" class="futuristic-btn" onclick="addSkillToConstellation()">ADICIONAR</button>
    </div>
  </div>
</div>

<div id="focus" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1200px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>MODO FOCO</h2>
    
    <div class="focus-container">
      <div class="focus-main">
        <div class="habit-check-container" id="focusHabits">
          <!-- Hábitos serão gerados dinamicamente -->
        </div>
      </div>
      
      <div class="focus-sidebar">
        <div class="music-player">
          <h4>🎵 MÚSICA DE FOCO</h4>
          <input type="file" id="musicUpload" accept="audio/*" style="display: none;">
          <audio id="focusAudio" controls class="focus-audio-player">
            <source src="" type="audio/mpeg">
            Seu navegador não suporta áudio.
          </audio>
          <div class="music-controls">
            <button type="button" class="music-btn" onclick="document.getElementById('musicUpload').click()">📁 IMPORTAR</button>
            <button type="button" class="music-btn" onclick="toggleMusic()">⏯️ PLAY/PAUSE</button>
          </div>
        </div>
        
        <div class="focus-stats">
          <h4>📊 ESTATÍSTICAS</h4>
          <div class="stats-chart" id="focusChart">
            <!-- Gráfico será gerado dinamicamente -->
          </div>
          <div class="focus-stats-summary">
            <span class="focus-completed-text">✓ Concluídos: <span id="completedCount">0</span></span>
            <span class="focus-procrastinated-text">✗ Procrastinados: <span id="procrastinatedCount">0</span></span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="habits" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>CRIAR HÁBITOS</h2>
    <div class="habit-form" id="habitForm">
      <!-- Hábitos serão gerados dinamicamente -->
    </div>
    <button type="button" class="futuristic-btn" onclick="saveHabits()">SALVAR HÁBITOS</button>
    <button type="button" class="futuristic-btn" onclick="goToProgress()">IR PARA PROGRESSO</button>
  </div>
</div>

<div id="xp" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>SISTEMA DE XP &amp; LEVEL</h2>
    <div class="xp-stats">
      <div class="stat-card">
        <div class="stat-value" id="currentLevel">1</div>
        <div class="stat-label">NÍVEL ATUAL</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="currentXP">0</div>
        <div class="stat-label">XP ATUAL</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalXPGained">0</div>
        <div class="stat-label">XP TOTAL GANHO</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalXPLost">0</div>
        <div class="stat-label">XP PERDIDO</div>
      </div>
    </div>
    
    <div id="xpHistory"></div>
  </div>
</div>

<div id="progress" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1200px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>PROGRESSO DOS HÁBITOS</h2>
    
    <!-- Gráfico de Progresso -->
    <div class="progress-chart-container">
      <h3>GRÁFICO DE PROGRESSO DIÁRIO</h3>
      <canvas id="progressChart" width="800" height="200"></canvas>
    </div>
    
    <!-- Tabela de Hábitos -->
    <div class="habits-table-container">
      <h3>GRADE DE HÁBITOS</h3>
      <div class="habits-table-wrapper">
        <div class="habits-table-header">
          <div class="habit-name-column">HÁBITO</div>
          <div class="days-header" id="daysHeader"></div>
        </div>
        <div class="habits-table-body" id="habitsTableBody">
          <!-- Hábitos serão inseridos aqui dinamicamente -->
        </div>
      </div>
    </div>
    
    <!-- Calendário de Disciplina -->
    <div class="panel calendar-panel" style="margin-top: 30px; max-width: 400px; margin-left: auto; margin-right: auto;">
      <h3 style="font-size: 14px;">CALENDÁRIO DE DISCIPLINA</h3>
      <div id="disciplineCalendar" class="discipline-calendar" style="gap: 2px; margin: 15px 0 10px 0;"></div>
      <button type="button" class="calendar-btn" style="padding: 8px; font-size: 10px;" onclick="markDayComplete()">DIA CONCLUÍDO</button>
    </div>
  </div>
</div>

<div id="settings" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>CONFIGURAÇÕES</h2>
    <div class="settings-grid">
      <div class="setting-item">
        <span class="setting-label">IDIOMA</span>
        <select id="languageSelect" class="habit-type-select">
          <option value="pt">Português</option>
          <option value="en">English</option>
          <option value="es">Español</option>
        </select>
      </div>
      <div class="setting-item">
        <span class="setting-label">TEMA</span>
        <select id="themeSelect" class="habit-type-select">
          <option value="dark">Escuro</option>
          <option value="light">Claro</option>
        </select>
      </div>
      <div class="setting-item">
        <span class="setting-label">MODO CELULAR</span>
        <select id="mobileSelect" class="habit-type-select">
          <option value="off">Desligado</option>
          <option value="on">Ligado (20:9 Landscape)</option>
        </select>
      </div>
      <div style="background: rgba(0, 234, 255, 0.1); border: 1px solid rgba(0, 234, 255, 0.3); border-radius: 8px; padding: 15px; margin-top: 15px;">
        <div style="color: #00eaff; font-size: 12px; font-weight: bold; margin-bottom: 8px;">📱 MODO CELULAR</div>
        <div style="color: rgba(0, 234, 255, 0.8); font-size: 11px; line-height: 1.4;">
          Adapta a interface para dispositivos móveis com tamanho médio (700x400px) e escala 0.85x.
          Mantém tudo legível e bem organizado, centralizado na tela.
          Funciona em ambos os modos (Normal e Turbo).
        </div>
      </div>
    </div>
    
    <!-- Sistema de Save/Load -->
    <div class="futuristic-menu" style="margin-top: 30px; padding: 25px;">
      <h3 style="color: #ff0040; text-align: center; margin-bottom: 25px; font-size: 20px;">💾 SISTEMA DE SAVES</h3>
      
      <div class="save-system-grid">
        <div class="save-section">
          <h4 class="save-section-title">EXPORTAR PROGRESSO</h4>
          <p class="save-description">Salve todo seu progresso em um arquivo para backup ou transferência.</p>
          <button type="button" class="futuristic-btn save-btn" onclick="exportSave()">
            📤 EXPORTAR SAVE
          </button>
        </div>
        
        <div class="save-section">
          <h4 class="save-section-title">IMPORTAR PROGRESSO</h4>
          <p class="save-description">Carregue um arquivo de save para restaurar seu progresso.</p>
          <input type="file" id="saveFileInput" accept=".json" style="display: none;">
          <button type="button" class="futuristic-btn save-btn" onclick="document.getElementById('saveFileInput').click()">
            📥 IMPORTAR SAVE
          </button>
        </div>
        
        <div class="save-section danger-section">
          <h4 class="save-section-title">RESETAR PROGRESSO</h4>
          <p class="save-description">⚠️ CUIDADO: Esta ação apagará TODOS os seus dados permanentemente!</p>
          <button type="button" class="futuristic-btn danger-btn" onclick="confirmReset()">
            🗑️ RESETAR TUDO
          </button>
        </div>
      </div>
      
      <div class="save-info">
        <div class="current-save-info">
          <h4>📊 INFORMAÇÕES DO SAVE ATUAL</h4>
          <div class="save-stats">
            <div class="save-stat">
              <span class="stat-label">Nível:</span>
              <span class="stat-value" id="saveLevel">1</span>
            </div>
            <div class="save-stat">
              <span class="stat-label">XP Total:</span>
              <span class="stat-value" id="saveTotalXP">0</span>
            </div>
            <div class="save-stat">
              <span class="stat-label">Hábitos:</span>
              <span class="stat-value" id="saveHabitsCount">0</span>
            </div>
            <div class="save-stat">
              <span class="stat-label">Classe:</span>
              <span class="stat-value" id="saveClass">BETA</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="diary" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1400px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>📖 DIÁRIO + GRÁFICO</h2>
    
    <!-- Lista de Entradas do Diário -->
    <div class="diary-entries-list" id="diaryEntriesList">
      <!-- Entradas serão geradas dinamicamente -->
    </div>
    
    <!-- Editor de Entrada do Diário -->
    <div class="diary-editor">
      <div class="diary-editor-header">
        <h3 id="diaryEditorTitle">📝 NOVA ENTRADA - <span id="currentDate"></span></h3>
        <button type="button" class="futuristic-btn" onclick="saveDiaryEntry()">💾 SALVAR ENTRADA</button>
      </div>
      
      <div class="diary-editor-content">
        <div class="diary-left-panel">
          <div class="wellbeing-slider-container">
            <h4>🎯 COMO FOI SEU DIA?</h4>
            <div class="wellbeing-display">
              <span id="wellbeingValue">50</span>%
            </div>
            <input type="range" id="wellbeingSlider" min="0" max="100" value="50" class="wellbeing-slider">
            <div class="slider-labels">
              <span>😞 Péssimo</span>
              <span>😐 Médio</span>
              <span>😊 Excelente</span>
            </div>
          </div>
        </div>
        
        <div class="diary-right-panel">
          <div class="diary-text-container">
            <h4>📝 SUAS ANOTAÇÕES</h4>
            <textarea id="diaryText" class="diary-textarea" placeholder="Como foi seu dia? O que você aprendeu? Quais foram seus desafios e conquistas?

Dicas do que escrever:
• Hábitos que conseguiu manter
• Dificuldades enfrentadas
• Momentos de orgulho
• Planos para amanhã
• Reflexões sobre seu crescimento"></textarea>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Gráfico de Evolução -->
    <div class="evolution-chart-container">
      <h3>📈 EVOLUÇÃO DO BEM-ESTAR</h3>
      <div class="chart-container">
        <canvas id="evolutionChart" width="600" height="180"></canvas>
      </div>
      <div class="chart-stats">
        <div class="chart-stat">
          <span class="stat-label">Média Geral:</span>
          <span class="stat-value" id="averageWellbeing">--</span>%
        </div>
        <div class="chart-stat">
          <span class="stat-label">Melhor Dia:</span>
          <span class="stat-value" id="bestDay">--</span>%
        </div>
        <div class="chart-stat">
          <span class="stat-label">Tendência:</span>
          <span class="stat-value" id="trend">--</span>
        </div>
        <div class="chart-stat">
          <span class="stat-label">Total de Dias:</span>
          <span class="stat-value" id="totalDays">0</span>
        </div>
      </div>
    </div>

    <!-- Seção de Fotos de Progresso -->
    <div class="diary-photos-section">
      <h3>📸 FOTOS DE PROGRESSO FÍSICO</h3>
      
      <!-- Resumo de Evolução -->
      <div id="evolutionSummary" class="evolution-summary" style="display: none;">
        <h4>📈 EVOLUÇÃO DAS MEDIDAS</h4>
        <div class="evolution-stats" id="evolutionStats">
          <!-- Stats serão inseridas aqui -->
        </div>
      </div>
      <div class="photo-upload-area">
        <input type="file" id="photoUpload" class="photo-upload-input" accept="image/*" onchange="handlePhotoUpload(event)">
        <button type="button" class="photo-upload-btn" onclick="document.getElementById('photoUpload').click()">
          📷 ADICIONAR FOTO DO DIA (+10 XP)
        </button>
        <div id="photoPreview" style="display: none;">
          <img id="previewImage" class="photo-preview" alt="Preview">
          
          <!-- Campos de Altura e Peso -->
          <div class="photo-measurements">
            <div class="measurement-group">
              <label for="photoHeight" class="measurement-label">📏 Altura (cm):</label>
              <input type="number" id="photoHeight" class="measurement-input" placeholder="175" min="100" max="250" step="0.1">
            </div>
            <div class="measurement-group">
              <label for="photoWeight" class="measurement-label">⚖️ Peso (kg):</label>
              <input type="number" id="photoWeight" class="measurement-input" placeholder="70.5" min="30" max="300" step="0.1">
            </div>
          </div>
          
          <textarea id="photoNote" class="photo-note-input" placeholder="Adicione uma nota sobre seu progresso físico, como se sente, o que mudou..."></textarea>
          <button type="button" class="save-photo-btn" onclick="savePhotoEntry()">💾 SALVAR FOTO</button>
        </div>
      </div>
      
      <!-- Galeria de Fotos -->
      <div class="photos-gallery" id="photosGallery">
        <!-- Fotos serão inseridas aqui dinamicamente -->
      </div>
    </div>
  </div>
</div>

<div id="attributes" class="screen">
  <div class="upside-down-bg">
    <div class="red-constellation"></div>
    <div class="red-particles"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1200px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="goToMenu()">← MENU</button>
    <h2>⚡ DISTRIBUIÇÃO DE PONTOS</h2>
    
    <!-- Pontos Disponíveis -->
    <div class="available-points-container">
      <div class="points-display">
        <span class="points-label">PONTOS DISPONÍVEIS:</span>
        <span class="points-value" id="availablePoints">0</span>
      </div>
      <div class="points-info">
        Ganhe pontos completando hábitos e atividades! Cada ação te dá +2 pontos para distribuir.
      </div>
    </div>
    
    <!-- Grid de Atributos -->
    <div class="attributes-grid">
      <div class="attribute-card" data-attribute="strength">
        <div class="attribute-icon">💪</div>
        <div class="attribute-name">FORÇA</div>
        <div class="attribute-level">Nível <span id="strengthLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="strengthXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('strength')">-</button>
          <span class="pending-points" id="strengthPending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('strength')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="agility">
        <div class="attribute-icon">🏃</div>
        <div class="attribute-name">AGILIDADE</div>
        <div class="attribute-level">Nível <span id="agilityLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="agilityXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('agility')">-</button>
          <span class="pending-points" id="agilityPending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('agility')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="intelligence">
        <div class="attribute-icon">🧠</div>
        <div class="attribute-name">INTELIGÊNCIA</div>
        <div class="attribute-level">Nível <span id="intelligenceLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="intelligenceXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('intelligence')">-</button>
          <span class="pending-points" id="intelligencePending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('intelligence')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="discipline">
        <div class="attribute-icon">🎯</div>
        <div class="attribute-name">DISCIPLINA</div>
        <div class="attribute-level">Nível <span id="disciplineLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="disciplineXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('discipline')">-</button>
          <span class="pending-points" id="disciplinePending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('discipline')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="stamina">
        <div class="attribute-icon">❤️</div>
        <div class="attribute-name">ESTAMINA</div>
        <div class="attribute-level">Nível <span id="staminaLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="staminaXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('stamina')">-</button>
          <span class="pending-points" id="staminaPending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('stamina')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="wealth">
        <div class="attribute-icon">💰</div>
        <div class="attribute-name">CONDIÇÕES FINANCEIRAS</div>
        <div class="attribute-level">Nível <span id="wealthLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="wealthXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('wealth')">-</button>
          <span class="pending-points" id="wealthPending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('wealth')">+</button>
        </div>
      </div>
      
      <div class="attribute-card" data-attribute="speed">
        <div class="attribute-icon">⚡</div>
        <div class="attribute-name">VELOCIDADE DE MOVIMENTO</div>
        <div class="attribute-level">Nível <span id="speedLevel">1</span></div>
        <div class="attribute-xp-bar">
          <div class="attribute-xp-fill" id="speedXP"></div>
        </div>
        <div class="attribute-controls">
          <button class="attribute-btn minus" onclick="removeAttributePoint('speed')">-</button>
          <span class="pending-points" id="speedPending">0</span>
          <button class="attribute-btn plus" onclick="addAttributePoint('speed')">+</button>
        </div>
      </div>
    </div>
    
    <!-- Botão de Confirmar -->
    <div class="confirm-attributes">
      <button type="button" class="futuristic-btn confirm-btn" onclick="confirmAttributeDistribution()">
        ✅ CONFIRMAR DISTRIBUIÇÃO
      </button>
    </div>
  </div>
</div>

<!-- Modal de Detalhes da Skill -->
<div id="skillDetailModal" class="skill-detail-modal">
  <div class="skill-detail-content">
    <h3 class="skill-detail-title" id="skillDetailTitle">Nome da Habilidade</h3>
    <p class="skill-detail-description" id="skillDetailDescription">Descrição da habilidade</p>
    <div class="skill-detail-stats">
      <div class="skill-stat">
        <div>NÍVEL</div>
        <div id="skillDetailLevel">1</div>
      </div>
      <div class="skill-stat">
        <div>XP</div>
        <div id="skillDetailXP">0/100</div>
      </div>
    </div>
    <div class="skill-controls">
      <button type="button" class="futuristic-btn" onclick="practiceSkill()">PRATICAR (+XP)</button>
      <button type="button" class="futuristic-btn" onclick="editSkill()">EDITAR</button>
      <button type="button" class="futuristic-btn" onclick="closeSkillDetail()">FECHAR</button>
    </div>
  </div>
</div>

<!-- Modal de Punição -->
<div id="punishmentModal" class="punishment-modal">
  <div class="punishment-content">
    <h3 class="punishment-title">PROCRASTINOU?</h3>
    <p class="punishment-text" id="punishmentText">Faça 20 flexões para anular a perda de XP!</p>
    <button type="button" class="futuristic-btn" onclick="acceptPunishment()">ACEITAR PUNIÇÃO</button>
    <button type="button" class="futuristic-btn" onclick="losePenaltyXP()">PERDER XP</button>
  </div>
</div>

<script>
// Verificar se já foi selecionado anteriormente
function checkDeviceSelection() {
  const savedMobileMode = localStorage.getItem('mobileMode');
  const deviceSelectionMade = localStorage.getItem('deviceSelectionMade');
  
  if (deviceSelectionMade === 'true' && savedMobileMode !== null) {
    // Já foi selecionado antes, aplicar modo e mostrar intro
    isMobileMode = savedMobileMode === 'true';
    applyMobileMode();
    
    const deviceSelection = document.getElementById('deviceSelection');
    const intro = document.getElementById("intro");
    
    deviceSelection.style.display = 'none';
    intro.style.display = 'flex';
    intro.style.opacity = '1';
    
    // Iniciar sequência automática da intro
    startAutoIntroSequence();
  }
  // Se não foi selecionado antes, a tela de seleção permanece visível
}

// Função para controlar a sequência automática da intro
function startAutoIntroSequence() {
  const intro = document.getElementById("intro");
  const preparation = document.getElementById("preparation");
  
  // Após 6 segundos, fade out da intro
  setTimeout(() => {
    intro.style.transition = 'opacity 1s ease-out';
    intro.style.opacity = '0';
    
    // Após 1 segundo de fade out, mostrar preparação
    setTimeout(() => {
      intro.style.display = 'none';
      preparation.style.display = 'flex';
      preparation.style.opacity = '0';
      
      setTimeout(() => {
        preparation.style.transition = 'opacity 1.5s ease-in';
        preparation.style.opacity = '1';
      }, 100);
    }, 1000);
  }, 6000);
}

const intro = document.getElementById("intro");
const preparation = document.getElementById("preparation");
const menu = document.getElementById("menu");
const transition = document.getElementById("transition");
const screens = document.querySelectorAll(".screen");

/* SEQUÊNCIA DE INTRO E PREPARAÇÃO */
setTimeout(function(){
  intro.style.opacity = 0;
}, 6000);

setTimeout(function(){
  intro.style.display = "none";
  preparation.style.display = "flex";
}, 7000);

// Event listener para o botão de iniciar jornada
document.addEventListener("DOMContentLoaded", function(){
  // Aplicar configurações salvas
  applyTheme();
  applyMobileMode();
  
  // PWA Installation
  let deferredPrompt;
  
  window.addEventListener('beforeinstallprompt', (e) => {
    // Prevent the mini-infobar from appearing on mobile
    e.preventDefault();
    // Stash the event so it can be triggered later
    deferredPrompt = e;
    
    // Show install button if not already installed
    if (!window.matchMedia('(display-mode: standalone)').matches) {
      showInstallPrompt();
    }
  });
  
  // Check if app is already installed
  window.addEventListener('appinstalled', () => {
    console.log('PWA foi instalado com sucesso!');
    hideInstallPrompt();
  });
  
  // Service Worker Registration
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('data:text/javascript;base64,Ly8gU2VydmljZSBXb3JrZXIgZm9yIFBXQQpjb25zdCBDQUNIRV9OQU1FID0gJ3NvbG8tbGV2ZWxpbmctdjEnOwpjb25zdCB1cmxzVG9DYWNoZSA9IFsKICAnLi8nCl07CgpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2luc3RhbGwnLCBldmVudCA9PiB7CiAgZXZlbnQud2FpdFVudGlsKAogICAgY2FjaGVzLm9wZW4oQ0FDSEVfTkFNRSkKICAgICAgLnRoZW4oY2FjaGUgPT4gY2FjaGUuYWRkQWxsKHVybHNUb0NhY2hlKSkKICApOwp9KTsKCnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignZmV0Y2gnLCBldmVudCA9PiB7CiAgZXZlbnQucmVzcG9uZFdpdGgoCiAgICBjYWNoZXMubWF0Y2goZXZlbnQucmVxdWVzdCkKICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZSkgewogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmV0Y2goZXZlbnQucmVxdWVzdCk7CiAgICAgIH0pCiAgKTsKfSk7')
      .then(() => console.log('Service Worker registrado com sucesso!'))
      .catch(err => console.log('Erro ao registrar Service Worker:', err));
  }
  
  const startBtn = document.getElementById("startJourneyBtn");
  if(startBtn) {
    startBtn.addEventListener("click", function(){
      startMainGame();
    });
  }
});

function startMainGame(){
  // Fade out da tela de preparação
  preparation.style.transition = "opacity 1.5s ease-out";
  preparation.style.opacity = "0";
  
  setTimeout(function(){
    preparation.style.display = "none";
    menu.style.display = "flex";
    menu.style.opacity = "0";
    
    // Fade in suave do menu principal
    setTimeout(function(){
      menu.style.transition = "opacity 2s ease-in";
      menu.style.opacity = "1";
      
      // Iniciar timer para mostrar tutorial se necessário
      setTimeout(checkForTutorial, 3000);
    }, 100);
  }, 1500);
}

// SISTEMA DE TUTORIAL
let tutorialTimer = null;
let tutorialShown = false;

function checkForTutorial() {
  // Verificar se o jogador tem hábitos criados
  if (gameHabits.length === 0 && !tutorialShown) {
    showHabitsTutorial();
  }
}

function showHabitsTutorial() {
  const popup = document.getElementById('habitsTutorial');
  const habitsBtn = document.getElementById('habitsBtn');
  
  if (popup && habitsBtn) {
    // Mostrar popup
    popup.classList.add('show');
    
    // Destacar botão
    habitsBtn.classList.add('highlighted');
    
    tutorialShown = true;
    
    // Auto-fechar após 15 segundos se não interagir
    tutorialTimer = setTimeout(() => {
      closeTutorialPopup();
    }, 15000);
  }
}

function closeTutorialPopup() {
  const popup = document.getElementById('habitsTutorial');
  const habitsBtn = document.getElementById('habitsBtn');
  
  if (popup) {
    popup.classList.remove('show');
  }
  
  if (habitsBtn) {
    habitsBtn.classList.remove('highlighted');
  }
  
  if (tutorialTimer) {
    clearTimeout(tutorialTimer);
    tutorialTimer = null;
  }
}

function goToHabitsFromTutorial() {
  closeTutorialPopup();
  
  // Pequeno delay para a animação do popup fechar
  setTimeout(() => {
    // Simular clique no botão de hábitos
    const habitsBtn = document.getElementById('habitsBtn');
    if (habitsBtn) {
      habitsBtn.click();
    }
  }, 300);
}

// Resetar tutorial quando voltar ao menu
function goToMenu(){
  const currentScreen = document.querySelector('.screen[style*="block"]');
  const fromGoggins = currentScreen && currentScreen.classList.contains('from-goggins');
  
  if (fromGoggins) {
    // Voltar para o modo Goggins
    currentScreen.classList.remove('from-goggins');
    
    transition.classList.add("active");
    setTimeout(function(){
      screens.forEach(function(s){s.style.display="none";});
      
      const gogginsMenu = document.getElementById('gogginsMenu');
      gogginsMenu.style.display = 'block';
      gogginsMenu.style.opacity = '0';
      
      setTimeout(() => {
        gogginsMenu.style.transition = 'opacity 1s ease-in';
        gogginsMenu.style.opacity = '1';
      }, 100);
      
      // Atualizar dados do jogador
      updateGogginsPlayerData();
    }, 400);
    setTimeout(function(){transition.classList.remove("active");}, 900);
  } else {
    // Voltar para o menu normal
    transition.classList.add("active");
    setTimeout(function(){
      screens.forEach(function(s){s.style.display="none";});
      menu.style.display="flex";
      
      // Resetar estado do tutorial
      tutorialShown = false;
      closeTutorialPopup();
      
      // Verificar novamente se precisa mostrar tutorial
      setTimeout(checkForTutorial, 2000);
    },400);
    setTimeout(function(){transition.classList.remove("active");},900);
  }
}

/* MENU BUTTONS */
document.addEventListener("DOMContentLoaded", function(){
  const menuBtns = document.querySelectorAll(".menu-btn");
  menuBtns.forEach(function(btn){
    btn.addEventListener("click", function(){
      const target = this.getAttribute("data-go");
      if(target) {
        if(target === 'habits') {
          createRedConstellation();
          initializeHabitForm();
        } else if(target === 'skilltree') {
          createRedConstellation();
          skillTreeTutorialShown = false;
          closeSkillTreeTutorial();
          initializeSkillTree();
        } else if(target === 'xp') {
          createRedConstellation();
          updateXPStats();
        } else if(target === 'progress') {
          createRedConstellation();
          updateProgressDisplay();
        } else if(target === 'settings') {
          createRedConstellation();
          initializeSettings();
        } else if(target === 'focus') {
          createRedConstellation();
          initializeFocusMode();
        } else if(target === 'diary') {
          createRedConstellation();
          initializeDiary();
        } else if(target === 'attributes') {
          createRedConstellation();
          initializeAttributes();
        }
        goTo(target);
      }
    });
  });
  
  // Inicializar configurações
  applyTheme();
  
  // Carregar dados salvos
  gameHabits = JSON.parse(localStorage.getItem("gameHabits")) || [];
  skillConstellations = JSON.parse(localStorage.getItem("skillConstellations")) || [];
});

/* TRANSIÇÃO */
function goTo(id){
  transition.classList.add("active");
  setTimeout(function(){
    menu.style.display="none";
    screens.forEach(function(s){s.style.display="none";});
    document.getElementById(id).style.display="block";
  },400);
  setTimeout(function(){transition.classList.remove("active");},900);
}

function goToMenu(){
  transition.classList.add("active");
  setTimeout(function(){
    screens.forEach(function(s){s.style.display="none";});
    menu.style.display="flex";
    
    // Resetar estado do tutorial
    tutorialShown = false;
    closeTutorialPopup();
    
    // Verificar novamente se precisa mostrar tutorial
    setTimeout(checkForTutorial, 2000);
  },400);
  setTimeout(function(){transition.classList.remove("active");},900);
}

/* AVATAR */
const avatarImg=document.getElementById("avatarImg");
const savedAvatar=localStorage.getItem("playerAvatar");
avatarImg.src=savedAvatar || "https://via.placeholder.com/160";

// Upload de avatar
document.addEventListener("DOMContentLoaded", function(){
  const avatarUpload = document.getElementById("avatarUpload");
  if(avatarUpload) {
    avatarUpload.addEventListener("change", function(e){
      const file = e.target.files[0];
      if(file && file.type.startsWith('image/')){
        const reader = new FileReader();
        reader.onload = function(e){
          const imageData = e.target.result;
          avatarImg.src = imageData;
          localStorage.setItem("playerAvatar", imageData);
        };
        reader.readAsDataURL(file);
      }
    });
  }
});

/* PLAYER DATA */
const nameLabel=document.getElementById("playerName");
const levelLabel=document.getElementById("playerLevel");
const xpBar=document.getElementById("xpFill");

let playerName=localStorage.getItem("playerName") || "Player";
let playerLevel=parseInt(localStorage.getItem("playerLevel"))||1;
let playerXP=parseInt(localStorage.getItem("playerXP"))||0;
let totalXPGained=parseInt(localStorage.getItem("totalXPGained"))||0;
let totalXPLost=parseInt(localStorage.getItem("totalXPLost"))||0;
let gameHabits=JSON.parse(localStorage.getItem("gameHabits"))||[];
let skillConstellations=JSON.parse(localStorage.getItem("skillConstellations"))||[];
let xpHistory=JSON.parse(localStorage.getItem("xpHistory"))||[];
let currentLanguage=localStorage.getItem("language")||"pt";
let currentTheme=localStorage.getItem("theme")||"dark";
let mobileMode=localStorage.getItem("mobileMode")||"off";
let selectedConstellation = null;
let currentSkillDetail = null;
let treeScale = 1;
let treeX = 0;
let treeY = 0;
let isDragging = false;
let dragStart = {x: 0, y: 0};

// SISTEMA DE DIÁRIO
let diaryEntries = JSON.parse(localStorage.getItem("diaryEntries")) || [];
let currentEditingEntry = null;

// SISTEMA DE FOTOS DE PROGRESSO
let progressPhotos = JSON.parse(localStorage.getItem("progressPhotos")) || [];
let currentPhotoData = null;

// SISTEMA DE PROGRESSO DE HÁBITOS
let habitProgress = JSON.parse(localStorage.getItem("habitProgress")) || {};
let habitCompletionToday = JSON.parse(localStorage.getItem("habitCompletionToday")) || {};
let habitXP = JSON.parse(localStorage.getItem("habitXP")) || {};
let habitLevels = JSON.parse(localStorage.getItem("habitLevels")) || {};
let currentPunishmentHabit = null;

// SISTEMA DE ATRIBUTOS
let availableAttributePoints = parseInt(localStorage.getItem("availableAttributePoints")) || 0;
let attributes = JSON.parse(localStorage.getItem("attributes")) || {
  strength: { level: 1, xp: 0, maxXP: 2 },
  agility: { level: 1, xp: 0, maxXP: 2 },
  intelligence: { level: 1, xp: 0, maxXP: 2 },
  discipline: { level: 1, xp: 0, maxXP: 2 },
  stamina: { level: 1, xp: 0, maxXP: 2 },
  wealth: { level: 1, xp: 0, maxXP: 2 },
  speed: { level: 1, xp: 0, maxXP: 2 }
};
let pendingAttributePoints = {
  strength: 0,
  agility: 0,
  intelligence: 0,
  discipline: 0,
  stamina: 0,
  wealth: 0,
  speed: 0
};

// SISTEMA DE CLASSES POR NÍVEL
const levelClasses = {
  1: {
    name: "BETA",
    description: "Você está apenas começando sua jornada. Todo grande guerreiro já foi um iniciante. O importante é dar o primeiro passo."
  },
  3: {
    name: "INICIANTE", 
    description: "Você superou os primeiros obstáculos e mostrou que tem potencial. Continue assim, a disciplina está começando a se formar."
  },
  5: {
    name: "APRENDIZ",
    description: "Agora você entende o básico da disciplina. Seus hábitos estão se solidificando e você vê os primeiros resultados reais."
  },
  10: {
    name: "EMPOLGADO",
    description: "A motivação está alta! Você descobriu o poder da consistência e está viciado em crescimento pessoal."
  },
  20: {
    name: "INTERMEDIÁRIO",
    description: "Você não é mais um novato. Tem experiência suficiente para saber que disciplina é um estilo de vida, não apenas motivação."
  },
  30: {
    name: "CONSISTENTE",
    description: "Sua disciplina é inabalável. Você faz o que precisa ser feito, independente de como se sente. Poucos chegam até aqui."
  },
  40: {
    name: "ACIMA DA MÉDIA",
    description: "Você está entre os melhores. Sua dedicação e consistência te colocaram em um patamar que a maioria só sonha em alcançar."
  },
  60: {
    name: "APRENDIZ DE CHAD",
    description: "Você transcendeu a mediocridade. Sua mentalidade é de elite e você inspira outros com sua disciplina férrea."
  },
  70: {
    name: "CHAD",
    description: "Você é a personificação da disciplina. Outros te veem como exemplo e você sabe que não há limites para quem nunca desiste."
  },
  80: {
    name: "ALPHA",
    description: "Você dominou a arte da autodisciplina. Sua força mental é lendária e você lidera pelo exemplo em tudo que faz."
  },
  100: {
    name: "TURBO",
    description: "Você alcançou o nível máximo de disciplina mental. Como Turbo, você abraça o sofrimento e transforma dor em poder. Você é imparável."
  }
};

function getPlayerClass(level) {
  // Encontrar a classe apropriada baseada no nível
  let currentClass = levelClasses[1]; // Padrão: BETA
  
  for (let classLevel in levelClasses) {
    if (level >= parseInt(classLevel)) {
      currentClass = levelClasses[classLevel];
    }
  }
  
  return currentClass;
}

function updatePlayerClassDisplay() {
  const playerClass = getPlayerClass(playerLevel);
  const nextClass = getNextClass(playerLevel);
  
  // Atualizar elementos do painel esquerdo
  const classNameElement = document.getElementById('playerClassName');
  const classDescElement = document.getElementById('playerClassDescription');
  const nextClassNameElement = document.getElementById('nextClassNameDisplay');
  const nextClassLevelElement = document.getElementById('nextClassLevel');
  
  if (classNameElement) {
    classNameElement.textContent = playerClass.name;
  }
  
  if (classDescElement) {
    // Truncar descrição para caber no painel
    const shortDesc = playerClass.description.length > 80 
      ? playerClass.description.substring(0, 80) + '...' 
      : playerClass.description;
    classDescElement.textContent = shortDesc;
  }
  
  if (nextClass) {
    if (nextClassNameElement) {
      nextClassNameElement.textContent = nextClass.class.name;
    }
    if (nextClassLevelElement) {
      nextClassLevelElement.textContent = `(Nv. ${nextClass.level})`;
    }
  } else {
    if (nextClassNameElement) {
      nextClassNameElement.textContent = "MÁXIMO";
    }
    if (nextClassLevelElement) {
      nextClassLevelElement.textContent = "(LENDA!)";
    }
  }
}

nameLabel.innerText=playerName;
levelLabel.innerText=playerLevel;
xpBar.style.width=playerXP+"%";

// Atualizar display da classe do jogador
updatePlayerClassDisplay();

function editName(){
  const newName=prompt("Digite seu nome:");
  if(!newName)return;
  playerName=newName;
  localStorage.setItem("playerName",playerName);
  nameLabel.innerText=playerName;
}

function gainXP(amount, source){
  amount = amount || 20;
  playerXP+=amount;
  totalXPGained+=amount;
  
  // Dar pontos de atributo (+2 por ação)
  availableAttributePoints += 2;
  saveAttributesData();
  
  xpHistory.unshift({
    type: 'gain',
    amount: amount,
    source: source || 'Hábito completado',
    date: new Date().toLocaleDateString()
  });
  
  if(playerXP >= 100){
    playerXP=0;
    playerLevel++;
    localStorage.setItem("playerLevel",playerLevel);
    levelLabel.innerText=playerLevel;
    levelUpEffect();
  }
  
  localStorage.setItem("playerXP",playerXP);
  localStorage.setItem("totalXPGained",totalXPGained);
  localStorage.setItem("xpHistory",JSON.stringify(xpHistory));
  xpBar.style.width=playerXP+"%";
  updateXPStats();
}

function loseXP(amount, source){
  amount = amount || 10;
  playerXP = Math.max(0, playerXP - amount);
  totalXPLost += amount;
  
  xpHistory.unshift({
    type: 'loss',
    amount: amount,
    source: source || 'Procrastinação',
    date: new Date().toLocaleDateString()
  });
  
  localStorage.setItem("playerXP",playerXP);
  localStorage.setItem("totalXPLost",totalXPLost);
  localStorage.setItem("xpHistory",JSON.stringify(xpHistory));
  xpBar.style.width=playerXP+"%";
  updateXPStats();
}

function levelUpEffect(){
  // Animação do painel do jogador
  const playerPanel = document.querySelector('.player-panel');
  if (playerPanel) {
    playerPanel.classList.add('level-up-animation');
    setTimeout(() => {
      playerPanel.classList.remove('level-up-animation');
    }, 1500);
  }
  
  // Efeito de tela
  document.body.style.boxShadow="inset 0 0 150px #00eaff";
  setTimeout(function(){document.body.style.boxShadow="";},1500);
  
  // Criar partículas de level up
  createLevelUpParticles();
  
  // Atualizar classe do jogador após level up
  updatePlayerClassDisplay();
  
  // Mostrar mensagem especial se mudou de classe
  const playerClass = getPlayerClass(playerLevel);
  const previousClass = getPlayerClass(playerLevel - 1);
  
  if (playerClass.name !== previousClass.name) {
    setTimeout(() => {
      classUpEffect(playerClass);
    }, 800);
  }
}

function classUpEffect(newClass) {
  // Animação épica da seção de classe
  const classSection = document.querySelector('.player-class-section');
  if (classSection) {
    classSection.classList.add('class-up-animation');
    setTimeout(() => {
      classSection.classList.remove('class-up-animation');
    }, 2000);
  }
  
  // Efeito de tela vermelha
  document.body.style.boxShadow="inset 0 0 200px #ff0040";
  setTimeout(function(){document.body.style.boxShadow="";},2000);
  
  // Criar partículas vermelhas de class up
  createClassUpParticles();
  
  // Mostrar modal após as animações
  setTimeout(() => {
    showClassUpModal(newClass);
  }, 1000);
}

function createLevelUpParticles() {
  const particleContainer = document.createElement('div');
  particleContainer.className = 'level-up-particles';
  document.body.appendChild(particleContainer);
  
  // Criar 30 partículas azuis
  for (let i = 0; i < 30; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.top = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 0.5 + 's';
    particle.style.animationDuration = (Math.random() * 1 + 1.5) + 's';
    particleContainer.appendChild(particle);
  }
  
  // Remover partículas após animação
  setTimeout(() => {
    document.body.removeChild(particleContainer);
  }, 3000);
}

function createClassUpParticles() {
  const particleContainer = document.createElement('div');
  particleContainer.className = 'level-up-particles';
  document.body.appendChild(particleContainer);
  
  // Criar 50 partículas vermelhas
  for (let i = 0; i < 50; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle class-particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.top = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 0.8 + 's';
    particle.style.animationDuration = (Math.random() * 1.5 + 2) + 's';
    particleContainer.appendChild(particle);
  }
  
  // Remover partículas após animação
  setTimeout(() => {
    document.body.removeChild(particleContainer);
  }, 4000);
}

function showClassUpModal(newClass) {
  // Criar modal de nova classe se não existir
  let modal = document.getElementById('classUpModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'classUpModal';
    modal.className = 'motivation-modal';
    modal.innerHTML = `
      <div class="motivation-content">
        <h3 class="motivation-title">🏆 NOVA CLASSE DESBLOQUEADA!</h3>
        <div id="newClassName" style="color: #ff0040; font-size: 32px; margin: 20px 0; text-shadow: 0 0 20px #ff0040;"></div>
        <p class="motivation-text" id="newClassDescription"></p>
        <button class="motivation-btn" onclick="closeClassUpModal()">CONTINUAR EVOLUINDO!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  document.getElementById('newClassName').textContent = newClass.name;
  document.getElementById('newClassDescription').textContent = newClass.description;
  
  showModalWithFade('classUpModal');
}

function closeClassUpModal(){
  hideModalWithFade('classUpModal');
}

function showAllClasses() {
  // Criar modal de todas as classes se não existir
  let modal = document.getElementById('allClassesModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'allClassesModal';
    modal.className = 'skill-detail-modal';
    modal.innerHTML = `
      <div class="skill-detail-content" style="max-width: 700px; max-height: 80vh; overflow-y: auto;">
        <h3 class="skill-detail-title">🏆 TODAS AS CLASSES</h3>
        <div id="allClassesList"></div>
        <button class="futuristic-btn" onclick="closeAllClassesModal()" style="margin-top: 20px;">FECHAR</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  // Preencher lista de classes
  const classList = document.getElementById('allClassesList');
  classList.innerHTML = '';
  
  const classLevels = Object.keys(levelClasses).map(level => parseInt(level)).sort((a, b) => a - b);
  
  classLevels.forEach(level => {
    const classInfo = levelClasses[level];
    const isUnlocked = playerLevel >= level;
    
    const classDiv = document.createElement('div');
    classDiv.style.cssText = `
      background: ${isUnlocked ? 'rgba(0,255,0,0.1)' : 'rgba(255,0,64,0.05)'};
      border: 1px solid ${isUnlocked ? 'rgba(0,255,0,0.3)' : 'rgba(255,0,64,0.2)'};
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      ${!isUnlocked ? 'opacity: 0.6;' : ''}
    `;
    
    classDiv.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <div style="color: ${isUnlocked ? '#00ff00' : '#ff0040'}; font-weight: bold; font-size: 18px;">
          ${isUnlocked ? '✓' : '🔒'} ${classInfo.name}
        </div>
        <div style="color: rgba(255,0,64,0.7); font-size: 14px;">
          Nível ${level}
        </div>
      </div>
      <div style="color: ${isUnlocked ? 'rgba(0,255,0,0.8)' : 'rgba(255,0,64,0.6)'}; line-height: 1.4;">
        ${classInfo.description}
      </div>
    `;
    
    classList.appendChild(classDiv);
  });
  
  showModalWithFade('allClassesModal');
}

function closeAllClassesModal(){
  hideModalWithFade('allClassesModal');
}

// SISTEMA UNIVERSAL DE ANIMAÇÕES PARA MODAIS
function showModalWithFade(modalId, callback = null) {
  const modal = document.getElementById(modalId);
  if (!modal) return;
  
  modal.style.display = 'flex';
  modal.style.opacity = '0';
  
  // Forçar reflow
  modal.offsetHeight;
  
  // Adicionar classe de fade in
  modal.classList.add('modal-fade-in');
  modal.classList.remove('modal-fade-out');
  
  // Executar callback se fornecido
  if (callback) {
    setTimeout(callback, 50);
  }
}

function hideModalWithFade(modalId, callback = null) {
  const modal = document.getElementById(modalId);
  if (!modal) return;
  
  // Adicionar classe de fade out
  modal.classList.add('modal-fade-out');
  modal.classList.remove('modal-fade-in');
  
  // Esconder após animação
  setTimeout(() => {
    modal.style.display = 'none';
    modal.classList.remove('modal-fade-out');
    
    // Executar callback se fornecido
    if (callback) {
      callback();
    }
  }, 300);
}

// MODAL DE CLASSES DETALHADO
function showClassModal() {
  const currentClass = getPlayerClass(playerLevel);
  const nextClass = getNextClass(playerLevel);
  
  // Atualizar informações da classe atual
  document.getElementById('currentClassModalName').textContent = currentClass.name;
  document.getElementById('currentClassModalLevel').textContent = `NÍVEL ${playerLevel}`;
  document.getElementById('currentClassModalDescription').textContent = currentClass.description;
  
  // Calcular progresso para próxima classe
  if (nextClass) {
    const currentLevelForClass = getCurrentClassLevel(playerLevel);
    const nextLevelForClass = nextClass.level;
    const levelsToNext = nextLevelForClass - playerLevel;
    const totalLevelsInRange = nextLevelForClass - currentLevelForClass;
    const progressInRange = totalLevelsInRange - levelsToNext;
    const progressPercentage = Math.round((progressInRange / totalLevelsInRange) * 100);
    
    document.getElementById('progressPercentage').textContent = `${progressPercentage}%`;
    document.getElementById('classProgressFill').style.width = `${progressPercentage}%`;
    document.getElementById('nextClassPreview').textContent = `Próxima: ${nextClass.class.name} (Nível ${nextClass.level})`;
  } else {
    document.getElementById('progressPercentage').textContent = '100%';
    document.getElementById('classProgressFill').style.width = '100%';
    document.getElementById('nextClassPreview').textContent = 'Você alcançou o nível máximo!';
  }
  
  // Gerar grid de todas as classes
  generateAllClassesGrid();
  
  // Mostrar modal com fade
  showModalWithFade('classModal');
  
  // Resetar timer de inatividade no modo Goggins
  if (isGogginsMode) {
    resetGogginsInactivityTimer();
  }
}

function closeClassModal() {
  hideModalWithFade('classModal');
}

function getCurrentClassLevel(level) {
  // Encontrar o nível da classe atual
  const classLevels = Object.keys(levelClasses).map(level => parseInt(level)).sort((a, b) => a - b);
  
  for (let i = classLevels.length - 1; i >= 0; i--) {
    if (level >= classLevels[i]) {
      return classLevels[i];
    }
  }
  
  return 1; // Padrão: BETA
}

function generateAllClassesGrid() {
  const grid = document.getElementById('allClassesGrid');
  grid.innerHTML = '';
  
  const classLevels = Object.keys(levelClasses).map(level => parseInt(level)).sort((a, b) => a - b);
  
  classLevels.forEach(level => {
    const classInfo = levelClasses[level];
    const isUnlocked = playerLevel >= level;
    const isCurrent = getCurrentClassLevel(playerLevel) === level;
    
    const classDiv = document.createElement('div');
    classDiv.className = 'class-item';
    
    if (isCurrent) {
      classDiv.classList.add('current');
    } else if (isUnlocked) {
      classDiv.classList.add('unlocked');
    } else {
      classDiv.classList.add('locked');
    }
    
    // Determinar ícone de status
    let statusIcon = '';
    if (isCurrent) {
      statusIcon = '👑'; // Coroa para classe atual
    } else if (isUnlocked) {
      statusIcon = '✅'; // Check para desbloqueada
    } else {
      statusIcon = '🔒'; // Cadeado para bloqueada
    }
    
    classDiv.innerHTML = `
      <div class="class-item-status">${statusIcon}</div>
      <div class="class-item-header">
        <div class="class-item-name">${classInfo.name}</div>
        <div class="class-item-level">Nv. ${level}</div>
      </div>
      <div class="class-item-description">${classInfo.description}</div>
    `;
    
    // Adicionar efeito especial para classe atual
    if (isCurrent) {
      classDiv.style.animation = 'class-glow 3s infinite alternate';
    }
    
    grid.appendChild(classDiv);
  });
}

// Fechar modal ao clicar fora dele
document.addEventListener('click', function(e) {
  const modals = ['classModal', 'skillDetailModal', 'motivationModal', 'classUpModal', 'allClassesModal'];
  
  modals.forEach(modalId => {
    const modal = document.getElementById(modalId);
    if (modal && e.target === modal) {
      hideModalWithFade(modalId);
    }
  });
});

// Fechar modal com tecla ESC
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    const modals = ['classModal', 'skillDetailModal', 'motivationModal', 'classUpModal', 'allClassesModal'];
    
    modals.forEach(modalId => {
      const modal = document.getElementById(modalId);
      if (modal && modal.style.display === 'flex') {
        hideModalWithFade(modalId);
      }
    });
  }
});

// ANIMAÇÃO CONSTELAÇÃO VERMELHA
function createRedConstellation(){
  const containers = document.querySelectorAll('.red-constellation');
  containers.forEach(container => {
    container.innerHTML = '';
    
    // Criar nós da constelação
    for(let i = 0; i < 20; i++){
      const node = document.createElement('div');
      node.className = 'constellation-node';
      node.style.left = Math.random() * 100 + '%';
      node.style.top = Math.random() * 100 + '%';
      node.style.animationDelay = Math.random() * 2 + 's';
      container.appendChild(node);
    }
    
    // Criar linhas conectoras
    setTimeout(() => {
      for(let i = 0; i < 15; i++){
        const line = document.createElement('div');
        line.className = 'constellation-line';
        line.style.left = Math.random() * 80 + '%';
        line.style.top = Math.random() * 80 + '%';
        line.style.width = Math.random() * 200 + 50 + 'px';
        line.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
        line.style.animationDelay = Math.random() * 3 + 's';
        container.appendChild(line);
      }
    }, 500);
  });
}

// SISTEMA DE HÁBITOS
function initializeHabitForm(){
  const form = document.getElementById('habitForm');
  form.innerHTML = '';
  
  for(let i = 0; i < 10; i++){
    const group = document.createElement('div');
    group.className = 'habit-input-group';
    
    const savedHabit = gameHabits[i] || {name: '', type: 'positive', xp: 20};
    
    group.innerHTML = `
      <input type="text" class="habit-input" placeholder="Nome do hábito ${i+1}" value="${savedHabit.name}" data-index="${i}">
      <select class="habit-type-select" data-index="${i}">
        <option value="positive" ${savedHabit.type === 'positive' ? 'selected' : ''}>Positivo</option>
        <option value="negative" ${savedHabit.type === 'negative' ? 'selected' : ''}>Negativo</option>
      </select>
      <input type="number" class="xp-input" min="1" max="100" value="${savedHabit.xp}" data-index="${i}">
    `;
    
    form.appendChild(group);
  }
}

function saveHabits(){
  gameHabits = [];
  const inputs = document.querySelectorAll('.habit-input');
  const selects = document.querySelectorAll('.habit-type-select');
  const xpInputs = document.querySelectorAll('.xp-input');
  
  inputs.forEach((input, index) => {
    if(input.value.trim()){
      gameHabits.push({
        id: Date.now() + index,
        name: input.value.trim(),
        type: selects[index].value,
        xp: parseInt(xpInputs[index].value) || 20,
        completed: false,
        streak: 0
      });
    }
  });
  
  localStorage.setItem('gameHabits', JSON.stringify(gameHabits));
  
  // Se criou hábitos, fechar tutorial permanentemente
  if (gameHabits.length > 0) {
    tutorialShown = true;
    closeTutorialPopup();
  }
  
  // Mensagem baseada no modo
  if (isGogginsMode) {
    if (gameHabits.length > 0) {
      // Apenas resetar timer, sem mensagem brutal para ação positiva
      resetGogginsInactivityTimer();
    } else {
      showGogginsBrutalMessage('VOCÊ NÃO CRIOU NENHUM HÁBITO! COMO VOCÊ ESPERA EVOLUIR SEM DISCIPLINA?');
    }
  } else {
    alert('Hábitos salvos com sucesso!');
  }
}

function goToProgress(){
  goTo('progress');
  updateProgressDisplay();
}

function updateProgressDisplay(){
  initializeHabitProgress();
  renderHabitsTable();
  renderProgressChart();
}

function initializeHabitProgress() {
  // Garantir que todos os hábitos tenham dados de progresso
  gameHabits.forEach(habit => {
    if (!habitProgress[habit.id]) {
      habitProgress[habit.id] = {};
    }
    if (!habitXP[habit.id]) {
      habitXP[habit.id] = 0;
    }
    if (!habitLevels[habit.id]) {
      habitLevels[habit.id] = 1;
    }
  });
  
  // Limpar dados de hábitos que não existem mais
  Object.keys(habitProgress).forEach(habitId => {
    if (!gameHabits.find(h => h.id == habitId)) {
      delete habitProgress[habitId];
      delete habitXP[habitId];
      delete habitLevels[habitId];
    }
  });
  
  localStorage.setItem('habitProgress', JSON.stringify(habitProgress));
  localStorage.setItem('habitXP', JSON.stringify(habitXP));
  localStorage.setItem('habitLevels', JSON.stringify(habitLevels));
}

function renderHabitsTable() {
  const tableBody = document.getElementById('habitsTableBody');
  const daysHeader = document.getElementById('daysHeader');
  
  if (!tableBody || !daysHeader) return;
  
  // Limpar conteúdo
  tableBody.innerHTML = '';
  daysHeader.innerHTML = '';
  
  // Gerar cabeçalho dos dias (dias do mês atual)
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth();
  const daysInMonth = new Date(year, month + 1, 0).getDate();
  const days = [];
  
  for (let day = 1; day <= daysInMonth; day++) {
    const date = new Date(year, month, day);
    days.push(date);
  }
  
  // Criar cabeçalho dos dias
  days.forEach(date => {
    const dayHeader = document.createElement('div');
    dayHeader.className = 'day-header';
    dayHeader.textContent = date.getDate();
    
    if (isToday(date)) {
      dayHeader.classList.add('today');
    }
    
    daysHeader.appendChild(dayHeader);
  });
  
  // Criar linhas dos hábitos
  gameHabits.forEach(habit => {
    const habitRow = document.createElement('div');
    habitRow.className = 'habit-row';
    
    // Container do nome do hábito com XP e nível
    const habitInfo = document.createElement('div');
    habitInfo.className = 'habit-info-container';
    
    // Nome do hábito
    const habitName = document.createElement('div');
    habitName.className = 'habit-name';
    habitName.textContent = habit.name;
    
    // Nível do hábito
    const habitLevel = document.createElement('div');
    habitLevel.className = 'habit-level';
    habitLevel.textContent = `Nv. ${habitLevels[habit.id] || 1}`;
    
    // Barra de XP do hábito
    const habitXPBar = document.createElement('div');
    habitXPBar.className = 'habit-xp-bar';
    
    const habitXPFill = document.createElement('div');
    habitXPFill.className = 'habit-xp-fill';
    
    // Calcular porcentagem de XP para o próximo nível
    const currentXP = habitXP[habit.id] || 0;
    const currentLevel = habitLevels[habit.id] || 1;
    const xpForNextLevel = currentLevel * 100; // 100 XP por nível
    const xpProgress = currentXP % 100; // XP atual no nível
    const xpPercentage = (xpProgress / 100) * 100;
    
    habitXPFill.style.width = `${xpPercentage}%`;
    habitXPBar.appendChild(habitXPFill);
    
    // XP texto
    const habitXPText = document.createElement('div');
    habitXPText.className = 'habit-xp-text';
    habitXPText.textContent = `${xpProgress}/100 XP`;
    
    // Montar container de info
    habitInfo.appendChild(habitName);
    habitInfo.appendChild(habitLevel);
    habitInfo.appendChild(habitXPBar);
    habitInfo.appendChild(habitXPText);
    
    // Dias do hábito
    const habitDays = document.createElement('div');
    habitDays.className = 'habit-days';
    
    days.forEach(date => {
      const dayButton = document.createElement('div');
      dayButton.className = 'habit-day';
      
      const dateStr = formatDate(date);
      const isCompleted = habitProgress[habit.id] && habitProgress[habit.id][dateStr];
      const isTodayDate = isToday(date);
      const isFuture = date > today;
      
      if (isCompleted) {
        dayButton.classList.add('completed');
      }
      
      if (isTodayDate) {
        dayButton.classList.add('today');
      }
      
      if (isFuture) {
        dayButton.classList.add('future');
      } else {
        dayButton.addEventListener('click', () => toggleHabitDay(habit.id, dateStr, dayButton, isTodayDate));
      }
      
      habitDays.appendChild(dayButton);
    });
    
    habitRow.appendChild(habitInfo);
    habitRow.appendChild(habitDays);
    tableBody.appendChild(habitRow);
  });
}

function toggleHabitDay(habitId, dateStr, dayButton, isTodayDate) {
  const today = formatDate(new Date());
  
  // Verificar se já foi marcado hoje (apenas uma vez por dia)
  if (isTodayDate && habitCompletionToday[habitId] && habitCompletionToday[habitId] === today) {
    return; // Já foi marcado hoje, não permitir mudança
  }
  
  if (!habitProgress[habitId]) {
    habitProgress[habitId] = {};
  }
  
  const isCompleted = habitProgress[habitId][dateStr];
  
  if (isCompleted) {
    // Desmarcar (apenas se não for hoje ou se ainda não foi marcado hoje)
    if (!isTodayDate || !habitCompletionToday[habitId]) {
      delete habitProgress[habitId][dateStr];
      dayButton.classList.remove('completed');
    }
  } else {
    // Marcar como completo
    habitProgress[habitId][dateStr] = true;
    dayButton.classList.add('completed');
    
    // Se for hoje, marcar como completado hoje e dar XP
    if (isTodayDate) {
      if (!habitCompletionToday[habitId]) {
        habitCompletionToday[habitId] = today;
        const habit = gameHabits.find(h => h.id == habitId);
        if (habit) {
          // Dar XP individual ao hábito
          giveHabitXP(habitId, habit.xp);
          
          // Dar XP global também
          gainXP(habit.xp, habit.name);
          habit.streak = (habit.streak || 0) + 1;
        }
      }
    }
  }
  
  localStorage.setItem('habitProgress', JSON.stringify(habitProgress));
  localStorage.setItem('habitCompletionToday', JSON.stringify(habitCompletionToday));
  localStorage.setItem('gameHabits', JSON.stringify(gameHabits));
  
  // Atualizar tabela para mostrar novo XP/nível
  renderHabitsTable();
  
  // Atualizar gráfico
  renderProgressChart();
  
  // No modo Goggins, resetar timer de inatividade
  if (isGogginsMode) {
    resetGogginsInactivityTimer();
  }
}

// Função para dar XP individual aos hábitos
function giveHabitXP(habitId, xpAmount) {
  if (!habitXP[habitId]) habitXP[habitId] = 0;
  if (!habitLevels[habitId]) habitLevels[habitId] = 1;
  
  const oldLevel = habitLevels[habitId];
  habitXP[habitId] += xpAmount;
  
  // Calcular novo nível (100 XP por nível)
  const newLevel = Math.floor(habitXP[habitId] / 100) + 1;
  
  if (newLevel > oldLevel) {
    habitLevels[habitId] = newLevel;
    
    // Mostrar animação de level up do hábito
    const habit = gameHabits.find(h => h.id == habitId);
    if (habit) {
      showHabitLevelUp(habit.name, newLevel);
    }
  }
  
  localStorage.setItem('habitXP', JSON.stringify(habitXP));
  localStorage.setItem('habitLevels', JSON.stringify(habitLevels));
}

// Função para mostrar animação de level up do hábito
function showHabitLevelUp(habitName, newLevel) {
  // Criar modal de level up
  const modal = document.createElement('div');
  modal.className = 'habit-levelup-modal';
  modal.innerHTML = `
    <div class="habit-levelup-content">
      <div class="habit-levelup-icon">⚡</div>
      <h3>HÁBITO EVOLUIU!</h3>
      <p><strong>${habitName}</strong></p>
      <div class="habit-levelup-level">NÍVEL ${newLevel}</div>
      <button onclick="this.parentElement.parentElement.remove()" class="futuristic-btn">CONTINUAR</button>
    </div>
  `;
  
  document.body.appendChild(modal);
  
  // Remover automaticamente após 5 segundos
  setTimeout(() => {
    if (modal.parentElement) {
      modal.remove();
    }
  }, 5000);
}

function renderProgressChart() {
  const canvas = document.getElementById('progressChart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;
  
  // Limpar canvas
  ctx.clearRect(0, 0, width, height);
  
  // Configurações do gráfico
  const padding = 40;
  const chartWidth = width - (padding * 2);
  const chartHeight = height - (padding * 2);
  
  // Calcular dados dos últimos 30 dias
  const today = new Date();
  const days = [];
  const completionData = [];
  
  for (let i = 29; i >= 0; i--) {
    const date = new Date(today);
    date.setDate(date.getDate() - i);
    days.push(date);
    
    const dateStr = formatDate(date);
    let completedCount = 0;
    
    gameHabits.forEach(habit => {
      if (habitProgress[habit.id] && habitProgress[habit.id][dateStr]) {
        completedCount++;
      }
    });
    
    const percentage = gameHabits.length > 0 ? (completedCount / gameHabits.length) * 100 : 0;
    completionData.push(percentage);
  }
  
  // Desenhar grade
  ctx.strokeStyle = 'rgba(255, 0, 64, 0.2)';
  ctx.lineWidth = 1;
  
  // Linhas horizontais
  for (let i = 0; i <= 4; i++) {
    const y = padding + (chartHeight / 4) * i;
    ctx.beginPath();
    ctx.moveTo(padding, y);
    ctx.lineTo(width - padding, y);
    ctx.stroke();
  }
  
  // Desenhar linha do gráfico
  ctx.strokeStyle = '#ff0040';
  ctx.lineWidth = 3;
  ctx.beginPath();
  
  completionData.forEach((percentage, index) => {
    const x = padding + (chartWidth / (completionData.length - 1)) * index;
    const y = padding + chartHeight - (chartHeight * percentage / 100);
    
    if (index === 0) {
      ctx.moveTo(x, y);
    } else {
      ctx.lineTo(x, y);
    }
  });
  
  ctx.stroke();
  
  // Desenhar pontos
  ctx.fillStyle = '#ff0040';
  completionData.forEach((percentage, index) => {
    const x = padding + (chartWidth / (completionData.length - 1)) * index;
    const y = padding + chartHeight - (chartHeight * percentage / 100);
    
    ctx.beginPath();
    ctx.arc(x, y, 4, 0, 2 * Math.PI);
    ctx.fill();
  });
  
  // Desenhar labels
  ctx.fillStyle = '#ff0040';
  ctx.font = '12px Orbitron';
  ctx.textAlign = 'center';
  
  // Labels dos eixos
  ctx.fillText('0%', 15, padding + chartHeight);
  ctx.fillText('50%', 15, padding + chartHeight / 2);
  ctx.fillText('100%', 15, padding);
}

function formatDate(date) {
  return date.getFullYear() + '-' + 
         String(date.getMonth() + 1).padStart(2, '0') + '-' + 
         String(date.getDate()).padStart(2, '0');
}

function isToday(date) {
  const today = new Date();
  return date.getDate() === today.getDate() && 
         date.getMonth() === today.getMonth() && 
         date.getFullYear() === today.getFullYear();
}

// Manter as funções antigas para compatibilidade com outras partes do código
function completeHabit(habitId){
  const today = formatDate(new Date());
  const dayButton = document.querySelector(`[data-habit="${habitId}"][data-date="${today}"]`);
  toggleHabitDay(habitId, today, dayButton, true);
}

function procrastinateHabit(habitId){
  const habit = gameHabits.find(h => h.id === habitId);
  if(habit){
    currentPunishmentHabit = habit;
    
    if (isGogginsMode) {
      // Mostrar mensagem brutal imediatamente
      const brutalMessages = [
        'PROCRASTINOU? VOCÊ ESTÁ ESCOLHENDO SER FRACO! FAÇA AS FLEXÕES AGORA!',
        'DESISTIU? ISSO É EXATAMENTE O QUE SEPARA OS VENCEDORES DOS PERDEDORES!',
        'PROCRASTINAÇÃO É O ASSASSINO DOS SONHOS! VOCÊ VAI ACEITAR ISSO?',
        'VOCÊ TEVE A CHANCE E DESPERDIÇOU! AGORA PAGUE O PREÇO!'
      ];
      const message = brutalMessages[Math.floor(Math.random() * brutalMessages.length)];
      showGogginsBrutalMessage(message);
      
      // Mostrar modal de punição após a mensagem brutal
      setTimeout(() => {
        document.getElementById('punishmentText').innerText = `Faça ${Math.floor(habit.xp)} flexões para anular a perda de XP!`;
        showModalWithFade('punishmentModal');
      }, 3000);
    } else {
      document.getElementById('punishmentText').innerText = `Faça ${Math.floor(habit.xp)} flexões para anular a perda de XP!`;
      showModalWithFade('punishmentModal');
    }
  }
}

function acceptPunishment(){
  hideModalWithFade('punishmentModal');
  setTimeout(() => {
    alert('Punição aceita! Nenhum XP foi perdido.');
    currentPunishmentHabit = null;
  }, 300);
}

function losePenaltyXP(){
  if(currentPunishmentHabit){
    loseXP(currentPunishmentHabit.xp, 'Procrastinação: ' + currentPunishmentHabit.name);
    hideModalWithFade('punishmentModal');
    currentPunishmentHabit = null;
  }
}

function updateXPStats(){
  document.getElementById('currentLevel').innerText = playerLevel;
  document.getElementById('currentXP').innerText = playerXP;
  document.getElementById('totalXPGained').innerText = totalXPGained;
  document.getElementById('totalXPLost').innerText = totalXPLost;
  
  // Atualizar display da classe atual no painel esquerdo
  updatePlayerClassDisplay();
  
  const historyDiv = document.getElementById('xpHistory');
  historyDiv.innerHTML = '<h3 class="xp-history-title">HISTÓRICO DE XP</h3>';
  
  xpHistory.slice(0, 10).forEach(entry => {
    const entryDiv = document.createElement('div');
    entryDiv.className = 'xp-history-item';
    entryDiv.innerHTML = `
      <span style="color: ${entry.type === 'gain' ? '#00ff00' : '#ff4444'}">
        ${entry.type === 'gain' ? '+' : '-'}${entry.amount} XP
      </span>
      <span style="color: rgba(255,0,64,0.7); margin-left: 10px;">${entry.source}</span>
      <span style="color: rgba(255,0,64,0.5); float: right;">${entry.date}</span>
    `;
    historyDiv.appendChild(entryDiv);
  });
}

function getNextClass(currentLevel) {
  // Encontrar a próxima classe baseada no nível atual
  const classLevels = Object.keys(levelClasses).map(level => parseInt(level)).sort((a, b) => a - b);
  
  for (let i = 0; i < classLevels.length; i++) {
    if (currentLevel < classLevels[i]) {
      return {
        level: classLevels[i],
        class: levelClasses[classLevels[i]]
      };
    }
  }
  
  return null; // Já está no nível máximo
}

// CONFIGURAÇÕES
function initializeSettings(){
  document.getElementById('languageSelect').value = currentLanguage;
  document.getElementById('themeSelect').value = currentTheme;
  document.getElementById('mobileSelect').value = mobileMode;
  
  document.getElementById('languageSelect').addEventListener('change', function(){
    currentLanguage = this.value;
    localStorage.setItem('language', currentLanguage);
    // Aqui você pode adicionar a lógica de tradução
  });
  
  document.getElementById('themeSelect').addEventListener('change', function(){
    currentTheme = this.value;
    localStorage.setItem('theme', currentTheme);
    applyTheme();
  });
  
  document.getElementById('mobileSelect').addEventListener('change', function(){
    mobileMode = this.value;
    localStorage.setItem('mobileMode', mobileMode);
    applyMobileMode();
  });
  
  // Configurar input de arquivo para importar save
  const saveFileInput = document.getElementById('saveFileInput');
  if(saveFileInput) {
    saveFileInput.addEventListener('change', function(e){
      const file = e.target.files[0];
      if(file) {
        importSave(file);
      }
    });
  }
  
  // Atualizar informações do save atual
  updateSaveInfo();
}

function updateSaveInfo() {
  const currentClass = getPlayerClass(playerLevel);
  
  document.getElementById('saveLevel').textContent = playerLevel;
  document.getElementById('saveTotalXP').textContent = totalXPGained;
  document.getElementById('saveHabitsCount').textContent = gameHabits.length;
  document.getElementById('saveClass').textContent = currentClass.name;
}

// SISTEMA DE SAVE/LOAD
function exportSave() {
  try {
    // Coletar todos os dados do jogo
    const saveData = {
      version: "1.0",
      timestamp: new Date().toISOString(),
      playerData: {
        name: playerName,
        level: playerLevel,
        xp: playerXP,
        totalXPGained: totalXPGained,
        totalXPLost: totalXPLost,
        avatar: localStorage.getItem("playerAvatar")
      },
      gameData: {
        habits: gameHabits,
        skillConstellations: skillConstellations,
        xpHistory: xpHistory,
        focusStats: focusStats,
        completedDays: completedDays,
        diaryEntries: diaryEntries,
        progressPhotos: progressPhotos,
        attributes: attributes,
        availableAttributePoints: availableAttributePoints
      },
      settings: {
        language: currentLanguage,
        theme: currentTheme,
        mobileMode: mobileMode
      }
    };
    
    // Converter para JSON
    const saveJson = JSON.stringify(saveData, null, 2);
    
    // Criar arquivo para download
    const blob = new Blob([saveJson], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    // Criar link de download
    const a = document.createElement('a');
    a.href = url;
    a.download = `disciplina_save_${new Date().toISOString().split('T')[0]}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    
    // Limpar URL
    URL.revokeObjectURL(url);
    
    // Mostrar confirmação
    showSaveMessage("✅ Save exportado com sucesso!", "success");
    
  } catch (error) {
    console.error('Erro ao exportar save:', error);
    showSaveMessage("❌ Erro ao exportar save!", "error");
  }
}

function importSave(file) {
  const reader = new FileReader();
  
  reader.onload = function(e) {
    try {
      const saveData = JSON.parse(e.target.result);
      
      // Validar estrutura do save
      if (!saveData.version || !saveData.playerData || !saveData.gameData) {
        throw new Error('Arquivo de save inválido');
      }
      
      // Confirmar importação
      if (!confirm('⚠️ ATENÇÃO: Importar este save irá substituir TODOS os seus dados atuais. Deseja continuar?')) {
        return;
      }
      
      // Restaurar dados do jogador
      playerName = saveData.playerData.name || "Player";
      playerLevel = saveData.playerData.level || 1;
      playerXP = saveData.playerData.xp || 0;
      totalXPGained = saveData.playerData.totalXPGained || 0;
      totalXPLost = saveData.playerData.totalXPLost || 0;
      
      // Restaurar dados do jogo
      gameHabits = saveData.gameData.habits || [];
      skillConstellations = saveData.gameData.skillConstellations || [];
      xpHistory = saveData.gameData.xpHistory || [];
      focusStats = saveData.gameData.focusStats || { completed: 0, procrastinated: 0, history: [] };
      completedDays = saveData.gameData.completedDays || [];
      diaryEntries = saveData.gameData.diaryEntries || [];
      progressPhotos = saveData.gameData.progressPhotos || [];
      attributes = saveData.gameData.attributes || {
        strength: { level: 1, xp: 0, maxXP: 2 },
        agility: { level: 1, xp: 0, maxXP: 2 },
        intelligence: { level: 1, xp: 0, maxXP: 2 },
        discipline: { level: 1, xp: 0, maxXP: 2 },
        stamina: { level: 1, xp: 0, maxXP: 2 },
        wealth: { level: 1, xp: 0, maxXP: 2 },
        speed: { level: 1, xp: 0, maxXP: 2 }
      };
      availableAttributePoints = saveData.gameData.availableAttributePoints || 0;
      
      // Restaurar configurações
      currentLanguage = saveData.settings.language || "pt";
      currentTheme = saveData.settings.theme || "dark";
      mobileMode = saveData.settings.mobileMode || "off";
      
      // Salvar tudo no localStorage
      localStorage.setItem("playerName", playerName);
      localStorage.setItem("playerLevel", playerLevel);
      localStorage.setItem("playerXP", playerXP);
      localStorage.setItem("totalXPGained", totalXPGained);
      localStorage.setItem("totalXPLost", totalXPLost);
      localStorage.setItem("gameHabits", JSON.stringify(gameHabits));
      localStorage.setItem("skillConstellations", JSON.stringify(skillConstellations));
      localStorage.setItem("xpHistory", JSON.stringify(xpHistory));
      localStorage.setItem("focusStats", JSON.stringify(focusStats));
      localStorage.setItem("completedDays", JSON.stringify(completedDays));
      localStorage.setItem("diaryEntries", JSON.stringify(diaryEntries));
      localStorage.setItem("progressPhotos", JSON.stringify(progressPhotos));
      localStorage.setItem("attributes", JSON.stringify(attributes));
      localStorage.setItem("availableAttributePoints", availableAttributePoints);
      localStorage.setItem("language", currentLanguage);
      localStorage.setItem("theme", currentTheme);
      localStorage.setItem("mobileMode", mobileMode);
      
      // Restaurar avatar se existir
      if (saveData.playerData.avatar) {
        localStorage.setItem("playerAvatar", saveData.playerData.avatar);
      }
      
      // Atualizar interface
      nameLabel.innerText = playerName;
      levelLabel.innerText = playerLevel;
      xpBar.style.width = playerXP + "%";
      updatePlayerClassDisplay();
      updateSaveInfo();
      applyTheme();
      
      // Atualizar avatar
      const avatarImg = document.getElementById("avatarImg");
      if (avatarImg && saveData.playerData.avatar) {
        avatarImg.src = saveData.playerData.avatar;
      }
      
      showSaveMessage("✅ Save importado com sucesso! Dados restaurados.", "success");
      
    } catch (error) {
      console.error('Erro ao importar save:', error);
      showSaveMessage("❌ Erro ao importar save! Verifique se o arquivo é válido.", "error");
    }
  };
  
  reader.readAsText(file);
}

function confirmReset() {
  const confirmation = prompt('⚠️ ATENÇÃO EXTREMA! Esta ação irá APAGAR PERMANENTEMENTE todos os seus dados!\n\nDigite "RESETAR TUDO" (sem aspas) para confirmar:');
  
  if (confirmation === "RESETAR TUDO") {
    resetAllData();
  } else {
    showSaveMessage("❌ Reset cancelado.", "info");
  }
}

function resetAllData() {
  try {
    // Limpar localStorage
    const keysToRemove = [
      "playerName", "playerLevel", "playerXP", "totalXPGained", "totalXPLost",
      "gameHabits", "skillConstellations", "xpHistory", "focusStats", 
      "completedDays", "diaryEntries", "progressPhotos", "attributes", "availableAttributePoints",
      "playerAvatar", "language", "theme"
    ];
    
    keysToRemove.forEach(key => {
      localStorage.removeItem(key);
    });
    
    // Resetar variáveis
    playerName = "Player";
    playerLevel = 1;
    playerXP = 0;
    totalXPGained = 0;
    totalXPLost = 0;
    gameHabits = [];
    skillConstellations = [];
    xpHistory = [];
    focusStats = { completed: 0, procrastinated: 0, history: [] };
    completedDays = [];
    diaryEntries = [];
    progressPhotos = [];
    attributes = {
      strength: { level: 1, xp: 0, maxXP: 2 },
      agility: { level: 1, xp: 0, maxXP: 2 },
      intelligence: { level: 1, xp: 0, maxXP: 2 },
      discipline: { level: 1, xp: 0, maxXP: 2 },
      stamina: { level: 1, xp: 0, maxXP: 2 },
      wealth: { level: 1, xp: 0, maxXP: 2 },
      speed: { level: 1, xp: 0, maxXP: 2 }
    };
    availableAttributePoints = 0;
    currentLanguage = "pt";
    currentTheme = "dark";
    mobileMode = "off";
    
    // Atualizar interface
    nameLabel.innerText = playerName;
    levelLabel.innerText = playerLevel;
    xpBar.style.width = "0%";
    updatePlayerClassDisplay();
    updateSaveInfo();
    
    // Resetar avatar
    const avatarImg = document.getElementById("avatarImg");
    if (avatarImg) {
      avatarImg.src = "https://via.placeholder.com/160";
    }
    
    showSaveMessage("✅ Todos os dados foram resetados! Você pode começar uma nova jornada.", "success");
    
  } catch (error) {
    console.error('Erro ao resetar dados:', error);
    showSaveMessage("❌ Erro ao resetar dados!", "error");
  }
}

function showSaveMessage(message, type) {
  // Se estiver no modo Goggins, usar mensagens brutais
  if (isGogginsMode) {
    showGogginsSaveMessage(message, type);
    return;
  }
  
  // Criar modal de mensagem se não existir
  let modal = document.getElementById('saveMessageModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'saveMessageModal';
    modal.className = 'motivation-modal';
    modal.innerHTML = `
      <div class="motivation-content">
        <h3 class="motivation-title" id="saveMessageTitle">SISTEMA DE SAVE</h3>
        <p class="motivation-text" id="saveMessageText"></p>
        <button class="motivation-btn" onclick="closeSaveMessage()">OK</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  const titleElement = document.getElementById('saveMessageTitle');
  const textElement = document.getElementById('saveMessageText');
  
  // Definir cores baseadas no tipo
  let titleColor = '#ff0040';
  if (type === 'success') titleColor = '#00ff00';
  if (type === 'error') titleColor = '#ff4444';
  if (type === 'info') titleColor = '#ffaa00';
  
  titleElement.style.color = titleColor;
  titleElement.textContent = type === 'success' ? '✅ SUCESSO' : 
                            type === 'error' ? '❌ ERRO' : 
                            type === 'info' ? 'ℹ️ INFORMAÇÃO' : 'SISTEMA DE SAVE';
  
  textElement.textContent = message;
  modal.style.display = 'flex';
}

function showGogginsSaveMessage(message, type) {
  // Mensagens brutais para diferentes tipos
  let brutalMessage = message;
  
  if (type === 'success') {
    const successMessages = [
      "FINALMENTE! VOCÊ FEZ ALGUMA COISA ÚTIL!",
      "PARABÉNS! VOCÊ ESTÁ COMEÇANDO A ACORDAR PARA A VIDA!",
      "ISSO AÍ! CONTINUE ASSIM E TALVEZ VOCÊ CHEGUE EM ALGUM LUGAR!",
      "MUITO BEM! MAS NÃO PARE AGORA, ISSO É SÓ O COMEÇO!"
    ];
    brutalMessage = successMessages[Math.floor(Math.random() * successMessages.length)];
  } else if (type === 'error') {
    const errorMessages = [
      "VOCÊ CONSEGUIU ESTRAGAR ATÉ ISSO! TENTA DE NOVO!",
      "ERRO! VOCÊ ESTÁ FAZENDO ALGUMA COISA ERRADA!",
      "NÃO FUNCIONOU? ENTÃO TRABALHA DIREITO!",
      "FALHOU! MAS NÃO DESISTE, TENTA OUTRA VEZ!"
    ];
    brutalMessage = errorMessages[Math.floor(Math.random() * errorMessages.length)];
  }
  
  showGogginsBrutalMessage(brutalMessage);
}

function showGogginsBrutalMessage(customMessage) {
  const message = customMessage || gogginsBrutalMessages[Math.floor(Math.random() * gogginsBrutalMessages.length)];
  
  // Criar modal de mensagem brutal se não existir
  let modal = document.getElementById('gogginsBrutalModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'gogginsBrutalModal';
    modal.className = 'goggins-brutal-modal';
    modal.innerHTML = `
      <div class="goggins-brutal-bg">
        <div class="brutal-static"></div>
        <div class="brutal-lightning"></div>
        <div class="brutal-veins"></div>
      </div>
      <div class="goggins-brutal-content">
        <div class="brutal-skull">💀</div>
        <div class="brutal-message" id="brutalMessageText"></div>
        <button class="brutal-dismiss-btn" onclick="dismissBrutalMessage()">ENTENDI! VOU TRABALHAR!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  document.getElementById('brutalMessageText').textContent = message;
  modal.style.display = 'flex';
  
  // Resetar timer de inatividade
  resetGogginsInactivityTimer();
  
  // Auto-fechar após 6 segundos se não interagir
  setTimeout(() => {
    if (modal.style.display === 'flex') {
      dismissBrutalMessage();
    }
  }, 6000);
}

function closeSaveMessage(){
  const modal = document.getElementById('saveMessageModal');
  if(modal) modal.style.display = 'none';
}

// SISTEMA DE DIÁRIO + GRÁFICO
function initializeDiary() {
  updateCurrentDate();
  setupWellbeingSlider();
  loadDiaryEntries();
  renderEvolutionChart();
  clearDiaryEditor();
  initializePhotos();
}

function updateCurrentDate() {
  const today = new Date();
  const dateStr = today.toLocaleDateString('pt-BR', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
  document.getElementById('currentDate').textContent = dateStr.toUpperCase();
}

function setupWellbeingSlider() {
  const slider = document.getElementById('wellbeingSlider');
  const display = document.getElementById('wellbeingValue');
  
  if (slider && display) {
    slider.addEventListener('input', function() {
      display.textContent = this.value;
      updateSliderColor(this.value);
    });
    
    // Inicializar cor
    updateSliderColor(slider.value);
  }
}

function updateSliderColor(value) {
  const slider = document.getElementById('wellbeingSlider');
  const percentage = value / 100;
  
  // Gradiente de cor baseado no valor
  let color;
  if (value < 30) {
    color = '#ff4444'; // Vermelho
  } else if (value < 70) {
    color = '#ffaa00'; // Laranja
  } else {
    color = '#00ff00'; // Verde
  }
  
  slider.style.background = `linear-gradient(to right, ${color} ${percentage * 100}%, rgba(255, 0, 64, 0.2) ${percentage * 100}%)`;
}

function loadDiaryEntries() {
  const container = document.getElementById('diaryEntriesList');
  container.innerHTML = '';
  
  if (diaryEntries.length === 0) {
    container.innerHTML = `
      <div style="text-align: center; color: rgba(255, 0, 64, 0.7); padding: 20px;">
        📝 Nenhuma entrada ainda. Comece escrevendo sobre seu dia!
      </div>
    `;
    return;
  }
  
  // Ordenar entradas por data (mais recente primeiro)
  const sortedEntries = [...diaryEntries].sort((a, b) => new Date(b.date) - new Date(a.date));
  
  sortedEntries.forEach(entry => {
    const button = document.createElement('button');
    button.className = 'diary-entry-button';
    button.onclick = () => loadDiaryEntry(entry);
    
    const date = new Date(entry.date);
    const dateStr = date.toLocaleDateString('pt-BR');
    const preview = entry.text.length > 100 ? entry.text.substring(0, 100) + '...' : entry.text;
    
    button.innerHTML = `
      <div class="diary-entry-date">${dateStr}</div>
      <div class="diary-entry-wellbeing">${entry.wellbeing}%</div>
      <div class="diary-entry-preview">${preview || 'Sem anotações'}</div>
    `;
    
    container.appendChild(button);
  });
}

function loadDiaryEntry(entry) {
  currentEditingEntry = entry;
  
  // Carregar dados no editor
  document.getElementById('wellbeingSlider').value = entry.wellbeing;
  document.getElementById('wellbeingValue').textContent = entry.wellbeing;
  document.getElementById('diaryText').value = entry.text;
  
  // Atualizar título
  const date = new Date(entry.date);
  const dateStr = date.toLocaleDateString('pt-BR', {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
  document.getElementById('diaryEditorTitle').innerHTML = `📝 EDITANDO - <span>${dateStr.toUpperCase()}</span>`;
  
  updateSliderColor(entry.wellbeing);
}

function clearDiaryEditor() {
  currentEditingEntry = null;
  document.getElementById('wellbeingSlider').value = 50;
  document.getElementById('wellbeingValue').textContent = '50';
  document.getElementById('diaryText').value = '';
  updateSliderColor(50);
  updateCurrentDate();
}

function saveDiaryEntry() {
  const wellbeing = parseInt(document.getElementById('wellbeingSlider').value);
  const text = document.getElementById('diaryText').value.trim();
  const today = new Date().toDateString();
  
  if (!text) {
    alert('⚠️ Escreva algo sobre seu dia antes de salvar!');
    return;
  }
  
  if (currentEditingEntry) {
    // Editando entrada existente
    currentEditingEntry.wellbeing = wellbeing;
    currentEditingEntry.text = text;
    currentEditingEntry.lastModified = new Date().toISOString();
  } else {
    // Verificar se já existe entrada para hoje
    const existingEntry = diaryEntries.find(entry => 
      new Date(entry.date).toDateString() === today
    );
    
    if (existingEntry) {
      if (!confirm('Já existe uma entrada para hoje. Deseja substituir?')) {
        return;
      }
      existingEntry.wellbeing = wellbeing;
      existingEntry.text = text;
      existingEntry.lastModified = new Date().toISOString();
    } else {
      // Nova entrada
      const newEntry = {
        id: Date.now(),
        date: new Date().toISOString(),
        wellbeing: wellbeing,
        text: text,
        created: new Date().toISOString()
      };
      diaryEntries.push(newEntry);
    }
  }
  
  // Salvar no localStorage
  localStorage.setItem('diaryEntries', JSON.stringify(diaryEntries));
  
  // Atualizar interface
  loadDiaryEntries();
  renderEvolutionChart();
  clearDiaryEditor();
  
  // Ganhar XP por escrever no diário
  gainXP(15, 'Entrada no Diário');
  
  showSaveMessage('✅ Entrada do diário salva com sucesso! +15 XP', 'success');
}

function renderEvolutionChart() {
  const canvas = document.getElementById('evolutionChart');
  const ctx = canvas.getContext('2d');
  
  // Ajustar tamanho do canvas baseado no container
  const container = canvas.parentElement;
  const containerWidth = container.clientWidth - 24; // padding
  canvas.width = Math.min(containerWidth, 600);
  canvas.height = 180;
  
  // Limpar canvas
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  if (diaryEntries.length === 0) {
    ctx.fillStyle = 'rgba(255, 0, 64, 0.7)';
    ctx.font = '14px Orbitron';
    ctx.textAlign = 'center';
    ctx.fillText('Nenhum dado para exibir ainda', canvas.width / 2, canvas.height / 2);
    return;
  }
  
  // Ordenar entradas por data
  const sortedEntries = [...diaryEntries].sort((a, b) => new Date(a.date) - new Date(b.date));
  
  // Configurações do gráfico
  const padding = 40;
  const chartWidth = canvas.width - (padding * 2);
  const chartHeight = canvas.height - (padding * 2);
  
  // Desenhar eixos
  ctx.strokeStyle = 'rgba(255, 0, 64, 0.5)';
  ctx.lineWidth = 2;
  
  // Eixo Y
  ctx.beginPath();
  ctx.moveTo(padding, padding);
  ctx.lineTo(padding, canvas.height - padding);
  ctx.stroke();
  
  // Eixo X
  ctx.beginPath();
  ctx.moveTo(padding, canvas.height - padding);
  ctx.lineTo(canvas.width - padding, canvas.height - padding);
  ctx.stroke();
  
  // Labels do eixo Y
  ctx.fillStyle = 'rgba(255, 0, 64, 0.8)';
  ctx.font = '10px Orbitron';
  ctx.textAlign = 'right';
  for (let i = 0; i <= 100; i += 25) {
    const y = canvas.height - padding - (i / 100) * chartHeight;
    ctx.fillText(i + '%', padding - 5, y + 3);
  }
  
  // Desenhar linha do gráfico
  if (sortedEntries.length > 1) {
    ctx.strokeStyle = '#ff0040';
    ctx.lineWidth = 2;
    ctx.beginPath();
    
    sortedEntries.forEach((entry, index) => {
      const x = padding + (index / (sortedEntries.length - 1)) * chartWidth;
      const y = canvas.height - padding - (entry.wellbeing / 100) * chartHeight;
      
      if (index === 0) {
        ctx.moveTo(x, y);
      } else {
        ctx.lineTo(x, y);
      }
    });
    
    ctx.stroke();
  }
  
  // Desenhar pontos
  sortedEntries.forEach((entry, index) => {
    const x = padding + (index / Math.max(sortedEntries.length - 1, 1)) * chartWidth;
    const y = canvas.height - padding - (entry.wellbeing / 100) * chartHeight;
    
    // Ponto
    ctx.fillStyle = '#ff0040';
    ctx.beginPath();
    ctx.arc(x, y, 4, 0, 2 * Math.PI);
    ctx.fill();
    
    // Brilho do ponto
    ctx.fillStyle = 'rgba(255, 0, 64, 0.3)';
    ctx.beginPath();
    ctx.arc(x, y, 8, 0, 2 * Math.PI);
    ctx.fill();
  });
  
  // Atualizar estatísticas
  updateChartStats(sortedEntries);
}

function updateChartStats(entries) {
  if (entries.length === 0) {
    document.getElementById('averageWellbeing').textContent = '--';
    document.getElementById('bestDay').textContent = '--';
    document.getElementById('trend').textContent = '--';
    document.getElementById('totalDays').textContent = '0';
    return;
  }
  
  // Média geral
  const average = entries.reduce((sum, entry) => sum + entry.wellbeing, 0) / entries.length;
  document.getElementById('averageWellbeing').textContent = Math.round(average);
  
  // Melhor dia
  const bestDay = Math.max(...entries.map(entry => entry.wellbeing));
  document.getElementById('bestDay').textContent = bestDay;
  
  // Tendência (comparar últimos 7 dias com 7 dias anteriores)
  let trend = '--';
  if (entries.length >= 7) {
    const recent = entries.slice(-7);
    const previous = entries.slice(-14, -7);
    
    if (previous.length > 0) {
      const recentAvg = recent.reduce((sum, entry) => sum + entry.wellbeing, 0) / recent.length;
      const previousAvg = previous.reduce((sum, entry) => sum + entry.wellbeing, 0) / previous.length;
      
      if (recentAvg > previousAvg + 5) {
        trend = '📈 Melhorando';
      } else if (recentAvg < previousAvg - 5) {
        trend = '📉 Declinando';
      } else {
        trend = '➡️ Estável';
      }
    }
  }
  document.getElementById('trend').textContent = trend;
  
  // Total de dias
  document.getElementById('totalDays').textContent = entries.length;
}

// SISTEMA DE FOTOS DE PROGRESSO
function initializePhotos() {
  loadPhotosGallery();
}

function handlePhotoUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  // Verificar se é uma imagem
  if (!file.type.startsWith('image/')) {
    alert('⚠️ Por favor, selecione apenas arquivos de imagem!');
    return;
  }
  
  // Verificar tamanho do arquivo (máximo 5MB)
  if (file.size > 5 * 1024 * 1024) {
    alert('⚠️ A imagem é muito grande! Máximo 5MB.');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    currentPhotoData = e.target.result;
    
    // Mostrar preview
    document.getElementById('previewImage').src = currentPhotoData;
    document.getElementById('photoPreview').style.display = 'block';
    document.getElementById('photoNote').value = '';
    document.getElementById('photoHeight').value = '';
    document.getElementById('photoWeight').value = '';
  };
  
  reader.readAsDataURL(file);
}

function savePhotoEntry() {
  if (!currentPhotoData) {
    alert('⚠️ Nenhuma foto selecionada!');
    return;
  }
  
  const note = document.getElementById('photoNote').value.trim();
  const height = parseFloat(document.getElementById('photoHeight').value);
  const weight = parseFloat(document.getElementById('photoWeight').value);
  const today = new Date().toDateString();
  
  // Validar altura e peso
  if (!height || height < 100 || height > 250) {
    alert('⚠️ Por favor, insira uma altura válida (100-250 cm)!');
    return;
  }
  
  if (!weight || weight < 30 || weight > 300) {
    alert('⚠️ Por favor, insira um peso válido (30-300 kg)!');
    return;
  }
  
  // Calcular IMC
  const heightInMeters = height / 100;
  const bmi = weight / (heightInMeters * heightInMeters);
  
  // Verificar se já existe foto para hoje
  const existingPhoto = progressPhotos.find(photo => 
    new Date(photo.date).toDateString() === today
  );
  
  if (existingPhoto) {
    if (!confirm('Já existe uma foto para hoje. Deseja substituir?')) {
      return;
    }
    existingPhoto.imageData = currentPhotoData;
    existingPhoto.note = note;
    existingPhoto.height = height;
    existingPhoto.weight = weight;
    existingPhoto.bmi = parseFloat(bmi.toFixed(1));
    existingPhoto.lastModified = new Date().toISOString();
  } else {
    // Nova foto
    const newPhoto = {
      id: Date.now(),
      date: new Date().toISOString(),
      imageData: currentPhotoData,
      note: note,
      height: height,
      weight: weight,
      bmi: parseFloat(bmi.toFixed(1)),
      created: new Date().toISOString()
    };
    progressPhotos.push(newPhoto);
  }
  
  // Salvar no localStorage
  localStorage.setItem('progressPhotos', JSON.stringify(progressPhotos));
  
  // Dar XP
  gainXP(10, 'Foto de Progresso');
  
  // Atualizar interface
  loadPhotosGallery();
  clearPhotoPreview();
  
  showSaveMessage('✅ Foto salva com sucesso! +10 XP', 'success');
}

function clearPhotoPreview() {
  currentPhotoData = null;
  document.getElementById('photoPreview').style.display = 'none';
  document.getElementById('photoUpload').value = '';
  document.getElementById('photoNote').value = '';
  document.getElementById('photoHeight').value = '';
  document.getElementById('photoWeight').value = '';
}

function loadPhotosGallery() {
  const gallery = document.getElementById('photosGallery');
  gallery.innerHTML = '';
  
  if (progressPhotos.length === 0) {
    gallery.innerHTML = `
      <div style="grid-column: 1 / -1; text-align: center; color: rgba(255, 0, 64, 0.7); padding: 40px;">
        📸 Nenhuma foto ainda. Comece documentando seu progresso físico!
      </div>
    `;
    document.getElementById('evolutionSummary').style.display = 'none';
    return;
  }
  
  // Mostrar resumo de evolução se houver fotos com medidas
  updateEvolutionSummary();
  
  // Ordenar fotos por data (mais recente primeiro)
  const sortedPhotos = [...progressPhotos].sort((a, b) => new Date(b.date) - new Date(a.date));
  
  sortedPhotos.forEach(photo => {
    const photoEntry = document.createElement('div');
    photoEntry.className = 'photo-entry';
    
    const date = new Date(photo.date);
    const dateStr = date.toLocaleDateString('pt-BR');
    
    // Função para classificar IMC
    function getBMICategory(bmi) {
      if (bmi < 18.5) return 'Abaixo do peso';
      if (bmi < 25) return 'Peso normal';
      if (bmi < 30) return 'Sobrepeso';
      return 'Obesidade';
    }
    
    // Criar display das medidas se existirem
    let measurementsHTML = '';
    if (photo.height && photo.weight) {
      const bmiCategory = getBMICategory(photo.bmi);
      measurementsHTML = `
        <div class="photo-measurements-display">
          <div class="measurement-item">
            <span class="measurement-label-display">📏 Altura:</span>
            <span class="measurement-value-display">${photo.height} cm</span>
          </div>
          <div class="measurement-item">
            <span class="measurement-label-display">⚖️ Peso:</span>
            <span class="measurement-value-display">${photo.weight} kg</span>
          </div>
          <div class="bmi-display">
            IMC: ${photo.bmi} (${bmiCategory})
          </div>
        </div>
      `;
    }
    
    photoEntry.innerHTML = `
      <img src="${photo.imageData}" alt="Foto de ${dateStr}" onclick="viewFullPhoto('${photo.imageData}', '${dateStr}', '${photo.note}', ${photo.height || 0}, ${photo.weight || 0}, ${photo.bmi || 0})">
      <div class="photo-entry-date">${dateStr}</div>
      ${measurementsHTML}
      <div class="photo-entry-note">${photo.note || 'Sem anotações'}</div>
      <button class="delete-photo-btn" onclick="deletePhoto(${photo.id})">🗑️</button>
    `;
    
    gallery.appendChild(photoEntry);
  });
}

function viewFullPhoto(imageData, date, note, height, weight, bmi) {
  // Criar modal para visualizar foto em tamanho completo
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    flex-direction: column;
    gap: 20px;
  `;
  
  // Função para classificar IMC
  function getBMICategory(bmi) {
    if (bmi < 18.5) return 'Abaixo do peso';
    if (bmi < 25) return 'Peso normal';
    if (bmi < 30) return 'Sobrepeso';
    return 'Obesidade';
  }
  
  // Criar HTML das medidas se existirem
  let measurementsHTML = '';
  if (height && weight && bmi) {
    const bmiCategory = getBMICategory(bmi);
    measurementsHTML = `
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 10px 0; padding: 15px; background: rgba(255, 0, 64, 0.1); border: 1px solid rgba(255, 0, 64, 0.3); border-radius: 10px;">
        <div style="text-align: center;">
          <div style="color: rgba(255, 0, 64, 0.8); font-size: 12px; margin-bottom: 5px;">📏 Altura</div>
          <div style="color: #ff0040; font-size: 16px; font-weight: bold;">${height} cm</div>
        </div>
        <div style="text-align: center;">
          <div style="color: rgba(255, 0, 64, 0.8); font-size: 12px; margin-bottom: 5px;">⚖️ Peso</div>
          <div style="color: #ff0040; font-size: 16px; font-weight: bold;">${weight} kg</div>
        </div>
        <div style="text-align: center;">
          <div style="color: rgba(255, 0, 64, 0.8); font-size: 12px; margin-bottom: 5px;">📊 IMC</div>
          <div style="color: #ffaa00; font-size: 16px; font-weight: bold;">${bmi}</div>
          <div style="color: rgba(255, 170, 0, 0.8); font-size: 10px;">${bmiCategory}</div>
        </div>
      </div>
    `;
  }
  
  modal.innerHTML = `
    <div style="text-align: center; color: #ff0040; font-family: Orbitron; margin-bottom: 10px;">
      <h3 style="margin: 0; font-size: 18px;">📸 ${date}</h3>
      ${measurementsHTML}
      <p style="margin: 10px 0; color: rgba(255, 0, 64, 0.8); font-size: 14px;">${note || 'Sem anotações'}</p>
    </div>
    <img src="${imageData}" style="max-width: 90vw; max-height: 60vh; border-radius: 10px; border: 2px solid #ff0040; box-shadow: 0 0 30px rgba(255, 0, 64, 0.5);">
    <button onclick="this.parentElement.remove()" style="background: #ff0040; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-family: Orbitron;">FECHAR</button>
  `;
  
  modal.onclick = (e) => {
    if (e.target === modal) modal.remove();
  };
  
  document.body.appendChild(modal);
}

function deletePhoto(photoId) {
  if (!confirm('Tem certeza que deseja excluir esta foto?')) {
    return;
  }
  
  progressPhotos = progressPhotos.filter(photo => photo.id !== photoId);
  localStorage.setItem('progressPhotos', JSON.stringify(progressPhotos));
  loadPhotosGallery();
  
  showSaveMessage('🗑️ Foto excluída!', 'info');
}

function updateEvolutionSummary() {
  const photosWithMeasurements = progressPhotos.filter(photo => photo.height && photo.weight);
  
  if (photosWithMeasurements.length < 1) {
    document.getElementById('evolutionSummary').style.display = 'none';
    return;
  }
  
  // Ordenar por data
  const sortedPhotos = photosWithMeasurements.sort((a, b) => new Date(a.date) - new Date(b.date));
  const firstPhoto = sortedPhotos[0];
  const lastPhoto = sortedPhotos[sortedPhotos.length - 1];
  
  // Calcular mudanças
  const weightChange = lastPhoto.weight - firstPhoto.weight;
  const bmiChange = lastPhoto.bmi - firstPhoto.bmi;
  const heightChange = lastPhoto.height - firstPhoto.height;
  
  // Função para formatar mudança
  function formatChange(value, unit, isHeight = false) {
    if (Math.abs(value) < 0.1) return `Sem mudança`;
    const sign = value > 0 ? '+' : '';
    const className = isHeight ? 'neutral' : (value > 0 ? 'positive' : 'negative');
    return `<span class="evolution-stat-change ${className}">${sign}${value.toFixed(1)}${unit}</span>`;
  }
  
  // Calcular dias de progresso
  const daysDiff = Math.ceil((new Date(lastPhoto.date) - new Date(firstPhoto.date)) / (1000 * 60 * 60 * 24));
  
  const evolutionStats = document.getElementById('evolutionStats');
  evolutionStats.innerHTML = `
    <div class="evolution-stat">
      <div class="evolution-stat-label">📏 Altura Atual</div>
      <div class="evolution-stat-value">${lastPhoto.height} cm</div>
      ${formatChange(heightChange, ' cm', true)}
    </div>
    <div class="evolution-stat">
      <div class="evolution-stat-label">⚖️ Peso Atual</div>
      <div class="evolution-stat-value">${lastPhoto.weight} kg</div>
      ${formatChange(weightChange, ' kg')}
    </div>
    <div class="evolution-stat">
      <div class="evolution-stat-label">📊 IMC Atual</div>
      <div class="evolution-stat-value">${lastPhoto.bmi}</div>
      ${formatChange(bmiChange, '')}
    </div>
    <div class="evolution-stat">
      <div class="evolution-stat-label">📅 Período</div>
      <div class="evolution-stat-value">${daysDiff} dias</div>
      <div class="evolution-stat-change neutral">${photosWithMeasurements.length} registros</div>
    </div>
  `;
  
  document.getElementById('evolutionSummary').style.display = 'block';
}

// SISTEMA DE ATRIBUTOS
function initializeAttributes() {
  updateAttributesDisplay();
  updateAvailablePoints();
}

function updateAvailablePoints() {
  document.getElementById('availablePoints').textContent = availableAttributePoints;
}

function updateAttributesDisplay() {
  Object.keys(attributes).forEach(attr => {
    const attrData = attributes[attr];
    const xpPercentage = (attrData.xp / attrData.maxXP) * 100;
    
    // Atualizar nível
    document.getElementById(attr + 'Level').textContent = attrData.level;
    
    // Atualizar barra de XP
    document.getElementById(attr + 'XP').style.width = xpPercentage + '%';
    
    // Atualizar pontos pendentes
    document.getElementById(attr + 'Pending').textContent = pendingAttributePoints[attr];
  });
}

function addAttributePoint(attribute) {
  if (availableAttributePoints > 0) {
    availableAttributePoints--;
    pendingAttributePoints[attribute]++;
    updateAvailablePoints();
    updateAttributesDisplay();
  }
}

function removeAttributePoint(attribute) {
  if (pendingAttributePoints[attribute] > 0) {
    availableAttributePoints++;
    pendingAttributePoints[attribute]--;
    updateAvailablePoints();
    updateAttributesDisplay();
  }
}

function confirmAttributeDistribution() {
  let totalPendingPoints = Object.values(pendingAttributePoints).reduce((sum, points) => sum + points, 0);
  
  if (totalPendingPoints === 0) {
    if (isGogginsMode) {
      showGogginsBrutalMessage('VOCÊ NÃO DISTRIBUIU NENHUM PONTO! ESTÁ DESPERDIÇANDO SEU POTENCIAL!');
    } else {
      showSaveMessage('⚠️ Nenhum ponto foi distribuído!', 'info');
    }
    return;
  }
  
  // Aplicar pontos aos atributos
  Object.keys(pendingAttributePoints).forEach(attr => {
    const pointsToAdd = pendingAttributePoints[attr];
    if (pointsToAdd > 0) {
      addXPToAttribute(attr, pointsToAdd);
    }
  });
  
  // Resetar pontos pendentes
  Object.keys(pendingAttributePoints).forEach(attr => {
    pendingAttributePoints[attr] = 0;
  });
  
  // Salvar dados
  saveAttributesData();
  updateAttributesDisplay();
  
  // Mensagem baseada no modo
  if (isGogginsMode) {
    // Apenas resetar timer para ação positiva, sem mensagem brutal
    resetGogginsInactivityTimer();
  } else {
    showSaveMessage(`✅ ${totalPendingPoints} pontos distribuídos com sucesso!`, 'success');
  }
}

function addXPToAttribute(attribute, points) {
  const attrData = attributes[attribute];
  attrData.xp += points;
  
  // Verificar level up
  while (attrData.xp >= attrData.maxXP) {
    attrData.xp -= attrData.maxXP;
    attrData.level++;
    attrData.maxXP = Math.ceil(attrData.maxXP * 1.2); // Aumenta requisito de XP
    
    // Animação de level up
    attributeLevelUpAnimation(attribute);
  }
}

function attributeLevelUpAnimation(attribute) {
  const card = document.querySelector(`[data-attribute="${attribute}"]`);
  if (card) {
    // Animação do card
    card.classList.add('attribute-levelup-animation');
    setTimeout(() => {
      card.classList.remove('attribute-levelup-animation');
    }, 1500);
    
    // Criar partículas de XP
    createAttributeXPParticles(card);
  }
}

function createAttributeXPParticles(card) {
  const rect = card.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;
  
  // Criar 15 partículas
  for (let i = 0; i < 15; i++) {
    const particle = document.createElement('div');
    particle.className = 'xp-particle';
    
    // Posição inicial (centro do card)
    particle.style.left = centerX + 'px';
    particle.style.top = centerY + 'px';
    particle.style.position = 'fixed';
    particle.style.zIndex = '10000';
    
    // Direção aleatória
    const angle = (Math.PI * 2 * i) / 15;
    const distance = 50 + Math.random() * 30;
    const endX = centerX + Math.cos(angle) * distance;
    const endY = centerY + Math.sin(angle) * distance - 100;
    
    document.body.appendChild(particle);
    
    // Animar partícula
    setTimeout(() => {
      particle.style.left = endX + 'px';
      particle.style.top = endY + 'px';
    }, 50);
    
    // Remover partícula após animação
    setTimeout(() => {
      if (document.body.contains(particle)) {
        document.body.removeChild(particle);
      }
    }, 2000);
  }
}

function saveAttributesData() {
  localStorage.setItem('attributes', JSON.stringify(attributes));
  localStorage.setItem('availableAttributePoints', availableAttributePoints);
}

// MODO GOGGINS
let isGogginsMode = false;
let gogginsInactivityTimer = null;
let lastActivityTime = Date.now();

// MENSAGENS BRUTAIS DO MODO GOGGINS
const gogginsBrutalMessages = [
  "PARE DE FAZER DESCULPAS! VOCÊ ESTÁ DESPERDIÇANDO SUA VIDA!",
  "ENQUANTO VOCÊ FICA AÍ PARADO, SEUS SONHOS ESTÃO MORRENDO!",
  "A MEDIOCRIDADE É UMA ESCOLHA! VOCÊ VAI ESCOLHER SER FRACO?",
  "CADA SEGUNDO QUE PASSA É UM SEGUNDO QUE VOCÊ NUNCA VAI RECUPERAR!",
  "VOCÊ QUER SER LEMBRADO COMO ALGUÉM QUE DESISTIU?",
  "A DOR DA DISCIPLINA PESA GRAMAS, A DOR DO ARREPENDIMENTO PESA TONELADAS!",
  "PARE DE SER MOLE! A VIDA NÃO VAI ESPERAR VOCÊ SE DECIDIR!",
  "VOCÊ ESTÁ CONFORTÁVEL DEMAIS! O CONFORTO É O INIMIGO DO PROGRESSO!",
  "LEVANTA E FAZ ALGUMA COISA! VOCÊ NÃO NASCEU PARA SER COMUM!",
  "CHEGA DE PROCRASTINAÇÃO! VOCÊ JÁ PERDEU TEMPO DEMAIS!",
  "A ÚNICA PESSOA QUE PODE MUDAR SUA VIDA É VOCÊ! ENTÃO MUDA!",
  "VOCÊ QUER FICAR PARA SEMPRE NESSE NÍVEL PATÉTICO?",
  "CADA DIA QUE VOCÊ NÃO EVOLUI, VOCÊ ESTÁ REGREDINDO!",
  "PARE DE ESPERAR O MOMENTO PERFEITO! ELE NUNCA VAI CHEGAR!",
  "VOCÊ ESTÁ TRAINDO SEU FUTURO EU! ELE MERECE MAIS!",
  "A VIDA É CURTA DEMAIS PARA VOCÊ FICAR PERDENDO TEMPO!",
  "VOCÊ QUER SER FORTE OU QUER CONTINUAR SENDO FRACO?",
  "CHEGA DE MIMIMI! É HORA DE TRABALHAR!",
  "VOCÊ ESTÁ ESCOLHENDO SER UM PERDEDOR TODOS OS DIAS!",
  "ACORDA! VOCÊ TEM POTENCIAL, MAS ESTÁ DESPERDIÇANDO!"
];

const gogginsHabitMessages = [
  "CRIE SEUS HÁBITOS AGORA! CADA DIA SEM DISCIPLINA É UM DIA PERDIDO!",
  "PARE DE ENROLAR! DEFINA SEUS HÁBITOS E COMECE A TRABALHAR!",
  "VOCÊ QUER RESULTADOS? ENTÃO CRIE HÁBITOS QUE TE LEVEM LÁ!",
  "SEM HÁBITOS NÃO HÁ PROGRESSO! PARE DE SER PREGUIÇOSO!"
];

const gogginsProgressMessages = [
  "CADÊ SEU PROGRESSO? VOCÊ ESTÁ FAZENDO ALGUMA COISA OU SÓ ENROLANDO?",
  "RESULTADOS NÃO MENTEM! O QUE VOCÊ FEZ HOJE PARA MELHORAR?",
  "VOCÊ ESTÁ EVOLUINDO OU ESTÁ PARADO NO TEMPO?",
  "CHEGA DE DESCULPAS! MOSTRE SEU PROGRESSO OU ADMITA QUE ESTÁ SENDO FRACO!"
];

const gogginsFocusMessages = [
  "FOCO É TUDO! PARE DE SE DISTRAIR E TRABALHE!",
  "VOCÊ QUER RESULTADOS? ENTÃO FOQUE NO QUE IMPORTA!",
  "CHEGA DE DISPERSÃO! É HORA DE FOCAR E EXECUTAR!",
  "SEM FOCO NÃO HÁ CONQUISTA! CONCENTRE-SE!"
];

const gogginsAttributeMessages = [
  "DISTRIBUA SEUS PONTOS! VOCÊ QUER FICAR FRACO PARA SEMPRE?",
  "CADA PONTO NÃO DISTRIBUÍDO É POTENCIAL DESPERDIÇADO!",
  "VOCÊ GANHOU ESSES PONTOS COM SUOR! AGORA USE ELES!",
  "PARE DE PROCRASTINAR! EVOLUA SEUS ATRIBUTOS AGORA!"
];

function startGogginsMode() {
  showModalWithFade('gogginsConfirmation');
  
  // Efeito sonoro de terror (se disponível)
  playHorrorSound();
}

function confirmGogginsMode() {
  // Fechar modal atual
  hideModalWithFade('gogginsConfirmation');
  hideModalWithFade('gogginsSecondConfirmation');
  
  // Entrar no modo Goggins
  isGogginsMode = true;
  
  // Esconder menu normal
  document.getElementById('menu').style.display = 'none';
  
  // Mostrar animação do Turbo primeiro
  setTimeout(() => {
    showGogginsWelcomeMessage();
  }, 300);
}

function showGogginsWelcomeMessage() {
  // Criar modal de boas-vindas do Turbo se não existir
  let modal = document.getElementById('gogginsWelcomeModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'gogginsWelcomeModal';
    modal.className = 'goggins-welcome-modal';
    modal.innerHTML = `
      <div class="goggins-welcome-bg">
        <div class="welcome-static"></div>
        <div class="welcome-lightning"></div>
        <div class="welcome-veins"></div>
      </div>
      <div class="goggins-welcome-content">
        <div class="goggins-avatar">🥊</div>
        <div class="goggins-name">TURBO</div>
        <div class="goggins-welcome-message">
          <div class="message-line">FAÇA ISSO SOZINHO,</div>
          <div class="message-line">NÃO DEPENDA DE PESSOAS</div>
          <div class="message-line">PARA TE AUXILIAR.</div>
          <div class="message-line highlight">FAÇA CANSADO,</div>
          <div class="message-line highlight">FAÇA EM DESCONFORTO,</div>
          <div class="message-line final">MAS FAÇA E SÓ PARE</div>
          <div class="message-line final">QUANDO TERMINAR.</div>
        </div>
        <button class="goggins-continue-btn" onclick="enterGogginsMenu()">ENTRAR NO MODO TURBO</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  showModalWithFade('gogginsWelcomeModal');
}

function enterGogginsMenu() {
  // Fechar modal de boas-vindas
  hideModalWithFade('gogginsWelcomeModal', () => {
    // Mostrar menu Goggins
    const gogginsMenu = document.getElementById('gogginsMenu');
    gogginsMenu.style.display = 'block';
    
    // Atualizar dados do jogador no modo Goggins
    updateGogginsPlayerData();
    
    // Iniciar sistema de inatividade
    startGogginsInactivityTimer();
    
    // Efeito de transição
    gogginsMenu.style.opacity = '0';
    setTimeout(() => {
      gogginsMenu.style.transition = 'opacity 2s ease-in';
      gogginsMenu.style.opacity = '1';
    }, 100);
  });
}

function startGogginsInactivityTimer() {
  if (!isGogginsMode) return;
  
  // Resetar timer existente
  if (gogginsInactivityTimer) {
    clearTimeout(gogginsInactivityTimer);
  }
  
  // Atualizar último tempo de atividade
  lastActivityTime = Date.now();
  
  // Configurar novo timer para 30 segundos
  gogginsInactivityTimer = setTimeout(() => {
    if (isGogginsMode) {
      showGogginsBrutalMessage();
      // Reiniciar timer para próxima mensagem (45 segundos após a primeira)
      gogginsInactivityTimer = setTimeout(() => {
        if (isGogginsMode) {
          showGogginsBrutalMessage();
          startGogginsInactivityTimer(); // Continuar ciclo
        }
      }, 45000);
    }
  }, 30000);
}

function resetGogginsInactivityTimer() {
  if (isGogginsMode) {
    startGogginsInactivityTimer();
  }
}

function showGogginsBrutalMessage() {
  const randomMessage = gogginsBrutalMessages[Math.floor(Math.random() * gogginsBrutalMessages.length)];
  
  // Criar modal de mensagem brutal se não existir
  let modal = document.getElementById('gogginsBrutalModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'gogginsBrutalModal';
    modal.className = 'goggins-brutal-modal';
    modal.innerHTML = `
      <div class="goggins-brutal-bg">
        <div class="brutal-static"></div>
        <div class="brutal-lightning"></div>
        <div class="brutal-veins"></div>
      </div>
      <div class="goggins-brutal-content">
        <div class="brutal-skull">💀</div>
        <div class="brutal-message" id="brutalMessageText"></div>
        <button class="brutal-dismiss-btn" onclick="dismissBrutalMessage()">ENTENDI! VOU TRABALHAR!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  document.getElementById('brutalMessageText').textContent = randomMessage;
  showModalWithFade('gogginsBrutalModal');
  
  // Auto-fechar após 8 segundos se não interagir
  setTimeout(() => {
    const modalElement = document.getElementById('gogginsBrutalModal');
    if (modalElement && modalElement.style.display === 'flex') {
      dismissBrutalMessage();
    }
  }, 8000);
}

function dismissBrutalMessage() {
  hideModalWithFade('gogginsBrutalModal');
  resetGogginsInactivityTimer();
}

// SISTEMA GOGGINS - DESAFIOS DIÁRIOS
let dailyChallenges = JSON.parse(localStorage.getItem("dailyChallenges")) || [];
let gogginsGoals = JSON.parse(localStorage.getItem("gogginsGoals")) || [];
let dailySchedule = JSON.parse(localStorage.getItem("dailySchedule")) || [];

// SISTEMA DE DESCONFORTO
let discomfortCategories = JSON.parse(localStorage.getItem("discomfortCategories")) || [];
let discomfortTreeScale = 1;
let discomfortTreeX = 0;
let discomfortTreeY = 0;
let isDraggingDiscomfort = false;
let discomfortDragStart = {x: 0, y: 0};

// Sugestões do Instrutor Goggins
const gogginsAdvice = [
  "Tome banho frio por 5 minutos todos os dias - isso vai te ensinar que você pode suportar qualquer coisa!",
  "Fale com 3 estranhos hoje - quebre essa barreira social que te limita!",
  "Faça 100 flexões sem parar - mesmo quando seus músculos gritarem para parar!",
  "Acorde às 4:30 da manhã por uma semana - domine sua mente antes que ela domine você!",
  "Jejue por 24 horas - aprenda que você é mais forte que seus desejos!",
  "Corra 10km mesmo cansado - a mente desiste antes do corpo!",
  "Fique em silêncio por 2 horas - enfrente seus próprios pensamentos!",
  "Faça algo que você tem medo há anos - pare de ser refém do medo!",
  "Durma no chão por uma semana - luxo torna você fraco!",
  "Carregue peso extra na mochila o dia todo - torne tudo mais difícil!",
  "Não use elevador por um mês - sempre escolha o caminho mais difícil!",
  "Medite por 1 hora sem se mover - discipline sua mente inquieta!",
  "Faça uma apresentação pública sobre algo que você ama - vença o medo de julgamento!",
  "Aprenda uma habilidade nova que você considera impossível - prove para si mesmo que não há limites!",
  "Passe um dia inteiro sem reclamar de nada - controle sua mentalidade!"
];

const defaultDiscomfortTasks = [
  {
    category: "FÍSICO",
    tasks: [
      { name: "Banho gelado 5min", difficulty: "easy", unlocked: false },
      { name: "100 flexões seguidas", difficulty: "medium", unlocked: false },
      { name: "Correr 10km", difficulty: "hard", unlocked: false },
      { name: "Jejum 24h", difficulty: "extreme", unlocked: false }
    ]
  },
  {
    category: "SOCIAL", 
    tasks: [
      { name: "Falar com estranho", difficulty: "easy", unlocked: false },
      { name: "Apresentação pública", difficulty: "medium", unlocked: false },
      { name: "Pedir desconto", difficulty: "medium", unlocked: false },
      { name: "Cantar em público", difficulty: "hard", unlocked: false }
    ]
  },
  {
    category: "MENTAL",
    tasks: [
      { name: "Meditar 30min", difficulty: "easy", unlocked: false },
      { name: "Ler livro difícil", difficulty: "medium", unlocked: false },
      { name: "Aprender idioma", difficulty: "hard", unlocked: false },
      { name: "Memorizar 100 dígitos", difficulty: "extreme", unlocked: false }
    ]
  }
];

const challengeTemplates = [
  "Fazer 100 flexões",
  "Fazer 100 abdominais", 
  "Correr 10 quilômetros",
  "Nadar por 2 horas",
  "Ler 30 páginas de um livro",
  "Aprender um hábito novo",
  "Estudar por 3 horas",
  "Meditar por 30 minutos",
  "Fazer 50 burpees",
  "Caminhar 15.000 passos",
  "Aprender 10 palavras em outro idioma",
  "Praticar uma habilidade por 2 horas",
  "Fazer jejum intermitente",
  "Acordar às 5:00 da manhã",
  "Tomar banho frio por 5 minutos"
];

function openDailyChallenges() {
  hideGogginsMenu();
  document.getElementById('dailyChallenges').style.display = 'block';
  generateDailyChallenges();
  resetGogginsInactivityTimer();
}

function openGoals() {
  // Mostrar animação primeiro
  showGoalsAnimation();
}

function showGoalsAnimation() {
  let modal = document.getElementById('goalsAnimationModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'goalsAnimationModal';
    modal.className = 'goggins-brutal-modal';
    modal.innerHTML = `
      <div class="goggins-brutal-bg">
        <div class="brutal-static"></div>
        <div class="brutal-lightning"></div>
        <div class="brutal-veins"></div>
      </div>
      <div class="goggins-brutal-content">
        <div class="brutal-message">NÃO DEIXE OS SEUS SONHOS MORREREM</div>
        <button class="brutal-dismiss-btn" onclick="enterGoalsScreen()">DEFINIR METAS AGORA!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  showModalWithFade('goalsAnimationModal');
  resetGogginsInactivityTimer();
}

function enterGoalsScreen() {
  hideModalWithFade('goalsAnimationModal', () => {
    hideGogginsMenu();
    document.getElementById('goalsScreen').style.display = 'block';
    generateGoals();
  });
}

function openUnstoppable() {
  hideGogginsMenu();
  document.getElementById('unstoppableScreen').style.display = 'block';
  generateDailySchedule();
  resetGogginsInactivityTimer();
}

function hideGogginsMenu() {
  document.getElementById('gogginsMenu').style.display = 'none';
}

function backToGogginsMenu() {
  // Esconder todas as telas do Goggins
  document.getElementById('dailyChallenges').style.display = 'none';
  document.getElementById('goalsScreen').style.display = 'none';
  document.getElementById('unstoppableScreen').style.display = 'none';
  document.getElementById('discomfortScreen').style.display = 'none';
  document.getElementById('gogginsArchitectScreen').style.display = 'none';
  
  // Mostrar menu do Goggins
  document.getElementById('gogginsMenu').style.display = 'block';
  resetGogginsInactivityTimer();
}

function generateDailyChallenges() {
  const today = new Date().toDateString();
  const savedDate = localStorage.getItem("challengesDate");
  
  // Gerar novos desafios se for um novo dia
  if (savedDate !== today) {
    dailyChallenges = [];
    
    // Selecionar 5 desafios aleatórios
    const shuffled = [...challengeTemplates].sort(() => 0.5 - Math.random());
    for (let i = 0; i < 5; i++) {
      dailyChallenges.push({
        id: Date.now() + i,
        text: shuffled[i],
        completed: false
      });
    }
    
    localStorage.setItem("dailyChallenges", JSON.stringify(dailyChallenges));
    localStorage.setItem("challengesDate", today);
  }
  
  // Atualizar data
  document.getElementById('challengeDate').textContent = new Date().toLocaleDateString('pt-BR');
  
  // Renderizar desafios
  const container = document.getElementById('challengesList');
  container.innerHTML = '';
  
  dailyChallenges.forEach(challenge => {
    const div = document.createElement('div');
    div.className = 'challenge-item';
    div.innerHTML = `
      <div class="challenge-text">${challenge.text}</div>
      <button class="challenge-check ${challenge.completed ? 'completed' : ''}" 
              onclick="toggleChallenge(${challenge.id})">
        ${challenge.completed ? '✅ FEITO' : '⏳ FAZER'}
      </button>
    `;
    container.appendChild(div);
  });
}

function toggleChallenge(challengeId) {
  const challenge = dailyChallenges.find(c => c.id === challengeId);
  if (challenge) {
    challenge.completed = !challenge.completed;
    localStorage.setItem("dailyChallenges", JSON.stringify(dailyChallenges));
    generateDailyChallenges();
    
    if (challenge.completed) {
      gainXP(30, `Desafio Goggins: ${challenge.text}`);
      resetGogginsInactivityTimer();
    }
  }
}

function completeAllChallenges() {
  const allCompleted = dailyChallenges.every(c => c.completed);
  
  if (allCompleted) {
    gainXP(100, "Todos os Desafios Diários Completados");
    showGogginsBrutalMessage("PARABÉNS! VOCÊ COMPLETOU TODOS OS DESAFIOS! ISSO É DISCIPLINA REAL!");
  } else {
    showGogginsBrutalMessage("VOCÊ NÃO COMPLETOU TODOS OS DESAFIOS! NÃO MINTA PARA SI MESMO!");
  }
}

function generateGoals() {
  // Analisar dados do usuário para gerar metas personalizadas
  const personalizedGoals = [];
  
  // Baseado nos hábitos
  if (gameHabits.length > 0) {
    personalizedGoals.push("Manter todos os hábitos por 30 dias consecutivos");
    personalizedGoals.push("Aumentar a frequência dos hábitos em 50%");
  }
  
  // Baseado no diário
  if (diaryEntries.length > 0) {
    const avgWellbeing = diaryEntries.reduce((sum, entry) => sum + entry.wellbeing, 0) / diaryEntries.length;
    if (avgWellbeing < 70) {
      personalizedGoals.push("Aumentar bem-estar médio para 80%");
    }
    personalizedGoals.push("Escrever no diário por 100 dias consecutivos");
  }
  
  // Baseado no nível
  if (playerLevel < 10) {
    personalizedGoals.push("Alcançar nível 10");
  } else if (playerLevel < 50) {
    personalizedGoals.push("Alcançar nível 50");
  }
  
  // Metas gerais
  personalizedGoals.push("Acordar às 5:00 da manhã por 30 dias");
  personalizedGoals.push("Exercitar-se 6 dias por semana");
  personalizedGoals.push("Ler 1 livro por mês");
  personalizedGoals.push("Aprender uma nova habilidade");
  
  // Renderizar metas
  const container = document.getElementById('goalsList');
  container.innerHTML = '';
  
  personalizedGoals.forEach((goalText, index) => {
    const existingGoal = gogginsGoals.find(g => g.text === goalText);
    const goal = existingGoal || { id: Date.now() + index, text: goalText, completed: false };
    
    if (!existingGoal) {
      gogginsGoals.push(goal);
    }
    
    const div = document.createElement('div');
    div.className = 'goal-item';
    div.innerHTML = `
      <div class="goal-text">${goal.text}</div>
      <button class="goal-check ${goal.completed ? 'completed' : ''}" 
              onclick="toggleGoal(${goal.id})">
        ${goal.completed ? '✅ FEITO' : '⏳ FAZER'}
      </button>
    `;
    container.appendChild(div);
  });
  
  localStorage.setItem("gogginsGoals", JSON.stringify(gogginsGoals));
}

function toggleGoal(goalId) {
  const goal = gogginsGoals.find(g => g.id === goalId);
  if (goal) {
    goal.completed = !goal.completed;
    localStorage.setItem("gogginsGoals", JSON.stringify(gogginsGoals));
    generateGoals();
    
    if (goal.completed) {
      gainXP(50, `Meta Goggins: ${goal.text}`);
      resetGogginsInactivityTimer();
    }
  }
}

function addCustomGoal() {
  const input = document.getElementById('customGoal');
  const text = input.value.trim();
  
  if (text) {
    const newGoal = {
      id: Date.now(),
      text: text,
      completed: false
    };
    
    gogginsGoals.push(newGoal);
    localStorage.setItem("gogginsGoals", JSON.stringify(gogginsGoals));
    input.value = '';
    generateGoals();
    resetGogginsInactivityTimer();
  }
}

function generateDailySchedule() {
  const today = new Date().toDateString();
  const savedDate = localStorage.getItem("scheduleDate");
  
  // Gerar novo cronograma se for um novo dia
  if (savedDate !== today) {
    dailySchedule = [];
    
    const activities = [
      "Exercício físico intenso",
      "Estudo/Trabalho focado", 
      "Leitura de desenvolvimento",
      "Prática de habilidades",
      "Planejamento e organização",
      "Meditação e reflexão",
      "Networking e relacionamentos",
      "Projetos pessoais",
      "Aprendizado de idiomas",
      "Arte marcial/Defesa pessoal",
      "Culinária saudável",
      "Limpeza e organização",
      "Caminhada/Corrida",
      "Escrita/Journaling",
      "Pesquisa e inovação"
    ];
    
    // Gerar cronograma das 6:00 às 22:00 (16 horas)
    for (let hour = 6; hour < 22; hour++) {
      const activity = activities[Math.floor(Math.random() * activities.length)];
      dailySchedule.push({
        id: Date.now() + hour,
        time: `${hour.toString().padStart(2, '0')}:00`,
        task: activity,
        completed: false
      });
    }
    
    localStorage.setItem("dailySchedule", JSON.stringify(dailySchedule));
    localStorage.setItem("scheduleDate", today);
  }
  
  // Renderizar cronograma
  const container = document.getElementById('hourlySchedule');
  container.innerHTML = '';
  
  dailySchedule.forEach(slot => {
    const div = document.createElement('div');
    div.className = 'hour-slot';
    div.innerHTML = `
      <div class="hour-time">${slot.time}</div>
      <div class="hour-task">${slot.task}</div>
      <button class="hour-check ${slot.completed ? 'completed' : ''}" 
              onclick="toggleHourSlot(${slot.id})">
        ${slot.completed ? '✅' : '⏳'}
      </button>
    `;
    container.appendChild(div);
  });
}

function toggleHourSlot(slotId) {
  const slot = dailySchedule.find(s => s.id === slotId);
  if (slot) {
    slot.completed = !slot.completed;
    localStorage.setItem("dailySchedule", JSON.stringify(dailySchedule));
    generateDailySchedule();
    
    if (slot.completed) {
      gainXP(20, `Cronograma Imparável: ${slot.task}`);
      resetGogginsInactivityTimer();
    }
  }
}

// SISTEMA DE DESCONFORTO
function openDiscomfort() {
  hideGogginsMenu();
  document.getElementById('discomfortScreen').style.display = 'block';
  initializeDiscomfortSystem();
  resetGogginsInactivityTimer();
}

function initializeDiscomfortSystem() {
  // Inicializar categorias padrão se não existirem
  if (discomfortCategories.length === 0) {
    discomfortCategories = JSON.parse(JSON.stringify(defaultDiscomfortTasks));
    saveDiscomfortData();
  }
  
  generateNewSuggestions();
  renderDiscomfortTree();
  setupDiscomfortTreeControls();
}

function generateNewSuggestions() {
  const suggestionsList = document.getElementById('suggestionsList');
  suggestionsList.innerHTML = '';
  
  // Selecionar 3 sugestões aleatórias
  const shuffled = [...gogginsAdvice].sort(() => 0.5 - Math.random());
  const selectedSuggestions = shuffled.slice(0, 3);
  
  selectedSuggestions.forEach(suggestion => {
    const suggestionDiv = document.createElement('div');
    suggestionDiv.className = 'suggestion-item';
    suggestionDiv.textContent = suggestion;
    suggestionsList.appendChild(suggestionDiv);
  });
}

function renderDiscomfortTree() {
  const canvas = document.getElementById('discomfortTreeCanvas');
  canvas.innerHTML = '';
  
  discomfortCategories.forEach((category, categoryIndex) => {
    const categoryDiv = createDiscomfortCategory(category, categoryIndex);
    canvas.appendChild(categoryDiv);
  });
}

function createDiscomfortCategory(category, categoryIndex) {
  const div = document.createElement('div');
  div.className = 'discomfort-category';
  div.style.left = (categoryIndex % 3) * 350 + 200 + 'px';
  div.style.top = Math.floor(categoryIndex / 3) * 250 + 100 + 'px';
  
  const title = document.createElement('div');
  title.className = 'category-title';
  title.textContent = category.category;
  div.appendChild(title);
  
  // Criar nós das tarefas
  category.tasks.forEach((task, taskIndex) => {
    const node = createDiscomfortNode(task, taskIndex, category, categoryIndex);
    div.appendChild(node);
    
    // Criar conexões
    if (taskIndex > 0) {
      const connection = createDiscomfortConnection(taskIndex);
      div.appendChild(connection);
    }
  });
  
  return div;
}

function createDiscomfortNode(task, index, category, categoryIndex) {
  const node = document.createElement('div');
  node.className = 'discomfort-node';
  if (task.unlocked) {
    node.classList.add('unlocked');
  } else {
    node.classList.add('locked');
  }
  
  // Posicionamento em círculo
  const angle = (index * 90) * (Math.PI / 180);
  const radius = 60 + (Math.floor(index / 4) * 30);
  const x = Math.cos(angle) * radius;
  const y = Math.sin(angle) * radius;
  
  node.style.left = x + 125 + 'px';
  node.style.top = y + 75 + 'px';
  
  // Ícone baseado na dificuldade
  const difficultyIcons = {
    easy: '🟢',
    medium: '🟡', 
    hard: '🟠',
    extreme: '🔴'
  };
  
  node.textContent = task.unlocked ? '✅' : (difficultyIcons[task.difficulty] || '🔒');
  
  // Label da tarefa
  const label = document.createElement('div');
  label.className = 'discomfort-node-label';
  label.textContent = task.name;
  node.appendChild(label);
  
  // Indicador de dificuldade
  const difficulty = document.createElement('div');
  difficulty.className = `difficulty-indicator difficulty-${task.difficulty}`;
  difficulty.textContent = task.difficulty.toUpperCase();
  node.appendChild(difficulty);
  
  // Click handler
  node.addEventListener('click', function() {
    if (!task.unlocked) {
      showDiscomfortTaskModal(task, category, categoryIndex, index);
    } else {
      showDiscomfortCompletedModal(task);
    }
  });
  
  return node;
}

function createDiscomfortConnection(index) {
  const connection = document.createElement('div');
  connection.className = 'discomfort-connection';
  
  const prevAngle = ((index - 1) * 90) * (Math.PI / 180);
  const currAngle = (index * 90) * (Math.PI / 180);
  const prevRadius = 60 + (Math.floor((index - 1) / 4) * 30);
  const currRadius = 60 + (Math.floor(index / 4) * 30);
  
  const x1 = Math.cos(prevAngle) * prevRadius + 125;
  const y1 = Math.sin(prevAngle) * prevRadius + 75;
  const x2 = Math.cos(currAngle) * currRadius + 125;
  const y2 = Math.sin(currAngle) * currRadius + 75;
  
  const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
  const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
  
  connection.style.left = x1 + 'px';
  connection.style.top = y1 + 'px';
  connection.style.width = length + 'px';
  connection.style.transform = `rotate(${angle}deg)`;
  
  return connection;
}

function showDiscomfortTaskModal(task, category, categoryIndex, taskIndex) {
  // Criar modal de tarefa de desconforto
  let modal = document.getElementById('discomfortTaskModal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'discomfortTaskModal';
    modal.className = 'goggins-brutal-modal';
    modal.innerHTML = `
      <div class="goggins-brutal-bg">
        <div class="brutal-static"></div>
        <div class="brutal-lightning"></div>
        <div class="brutal-veins"></div>
      </div>
      <div class="goggins-brutal-content">
        <div class="brutal-skull">🔥</div>
        <div class="brutal-message" id="discomfortTaskTitle"></div>
        <div class="brutal-message" id="discomfortTaskDescription" style="font-size: 16px; margin: 20px 0;"></div>
        <div style="display: flex; gap: 15px; justify-content: center;">
          <button class="brutal-dismiss-btn" onclick="unlockDiscomfortTask()" id="unlockTaskBtn">DESBLOQUEEI!</button>
          <button class="brutal-dismiss-btn" onclick="closeDiscomfortTaskModal()" style="background: rgba(100,0,0,0.8);">AINDA NÃO</button>
        </div>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  // Armazenar dados da tarefa atual
  modal.currentTask = { task, category, categoryIndex, taskIndex };
  
  document.getElementById('discomfortTaskTitle').textContent = task.name.toUpperCase();
  document.getElementById('discomfortTaskDescription').textContent = 
    `Esta é uma tarefa de nível ${task.difficulty.toUpperCase()}. Você realmente completou este desafio de desconforto?`;
  
  showModalWithFade('discomfortTaskModal');
}

function closeDiscomfortTaskModal() {
  hideModalWithFade('discomfortTaskModal');
}

function unlockDiscomfortTask() {
  const modal = document.getElementById('discomfortTaskModal');
  const { task, category, categoryIndex, taskIndex } = modal.currentTask;
  
  // Desbloquear tarefa
  task.unlocked = true;
  saveDiscomfortData();
  
  // Fechar modal atual
  hideModalWithFade('discomfortTaskModal', () => {
    // Mostrar animação de desbloqueio
    showDiscomfortUnlockAnimation(task, () => {
      // Atualizar árvore
      renderDiscomfortTree();
      
      // Dar XP baseado na dificuldade
      const xpRewards = { easy: 30, medium: 50, hard: 80, extreme: 120 };
      gainXP(xpRewards[task.difficulty], `Desconforto: ${task.name}`);
    });
  });
}

function showDiscomfortUnlockAnimation(task, callback) {
  // Criar modal de desbloqueio
  let modal = document.getElementById('discomfortUnlockModal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'discomfortUnlockModal';
    modal.className = 'motivation-modal';
    modal.innerHTML = `
      <div class="motivation-content" style="border-color: #FF0000; background: rgba(10,0,0,0.95);">
        <div style="font-size: 80px; margin-bottom: 20px; animation: avatar-pulse 1s infinite;">🔥</div>
        <h3 class="motivation-title" style="color: #FF0000;">DESCONFORTO CONQUISTADO!</h3>
        <div id="unlockedTaskName" style="color: #FF0000; font-size: 24px; margin: 20px 0; text-shadow: 0 0 20px #FF0000;"></div>
        <p class="motivation-text" style="color: rgba(255,0,0,0.8);" id="unlockMessage"></p>
        <button class="motivation-btn" onclick="closeDiscomfortUnlockModal()" style="background: linear-gradient(45deg, #8B0000, #FF0000);">CONTINUAR EVOLUINDO!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  modal.callback = callback;
  
  document.getElementById('unlockedTaskName').textContent = task.name.toUpperCase();
  
  const messages = {
    easy: "Você deu o primeiro passo! Continue quebrando suas barreiras!",
    medium: "Impressionante! Você está se tornando mais forte mentalmente!",
    hard: "INCRÍVEL! Poucos têm a coragem que você demonstrou!",
    extreme: "LENDÁRIO! Você transcendeu seus limites! Você é imparável!"
  };
  
  document.getElementById('unlockMessage').textContent = messages[task.difficulty];
  
  showModalWithFade('discomfortUnlockModal');
}

function closeDiscomfortUnlockModal() {
  const modal = document.getElementById('discomfortUnlockModal');
  hideModalWithFade('discomfortUnlockModal', () => {
    if (modal.callback) {
      modal.callback();
    }
  });
}

function showDiscomfortCompletedModal(task) {
  let modal = document.getElementById('discomfortCompletedModal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'discomfortCompletedModal';
    modal.className = 'motivation-modal';
    modal.innerHTML = `
      <div class="motivation-content" style="border-color: #00FF00; background: rgba(0,10,0,0.95);">
        <div style="font-size: 80px; margin-bottom: 20px;">✅</div>
        <h3 class="motivation-title" style="color: #00FF00;">TAREFA CONQUISTADA!</h3>
        <div id="completedTaskName" style="color: #00FF00; font-size: 20px; margin: 20px 0;"></div>
        <p class="motivation-text" style="color: rgba(0,255,0,0.8);">Você já conquistou este desafio! Continue buscando novos desconfortos para crescer ainda mais!</p>
        <button class="motivation-btn" onclick="closeDiscomfortCompletedModal()" style="background: linear-gradient(45deg, #006600, #00AA00);">ENTENDI!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  document.getElementById('completedTaskName').textContent = task.name;
  showModalWithFade('discomfortCompletedModal');
}

function closeDiscomfortCompletedModal() {
  hideModalWithFade('discomfortCompletedModal');
}

// Controles da árvore de desconforto
function setupDiscomfortTreeControls() {
  const container = document.getElementById('discomfortTreeContainer');
  
  container.addEventListener('mousedown', startDiscomfortDrag);
  container.addEventListener('mousemove', dragDiscomfort);
  container.addEventListener('mouseup', endDiscomfortDrag);
  container.addEventListener('wheel', zoomDiscomfort);
  
  // Touch events para mobile
  container.addEventListener('touchstart', startDiscomfortDrag);
  container.addEventListener('touchmove', dragDiscomfort);
  container.addEventListener('touchend', endDiscomfortDrag);
}

function startDiscomfortDrag(e) {
  isDraggingDiscomfort = true;
  const clientX = e.clientX || (e.touches && e.touches[0].clientX);
  const clientY = e.clientY || (e.touches && e.touches[0].clientY);
  discomfortDragStart = {x: clientX - discomfortTreeX, y: clientY - discomfortTreeY};
}

function dragDiscomfort(e) {
  if (!isDraggingDiscomfort) return;
  e.preventDefault();
  const clientX = e.clientX || (e.touches && e.touches[0].clientX);
  const clientY = e.clientY || (e.touches && e.touches[0].clientY);
  discomfortTreeX = clientX - discomfortDragStart.x;
  discomfortTreeY = clientY - discomfortDragStart.y;
  updateDiscomfortTreeTransform();
}

function endDiscomfortDrag() {
  isDraggingDiscomfort = false;
}

function zoomDiscomfort(e) {
  e.preventDefault();
  const delta = e.deltaY > 0 ? 0.9 : 1.1;
  discomfortTreeScale = Math.max(0.3, Math.min(2, discomfortTreeScale * delta));
  updateDiscomfortTreeTransform();
}

function updateDiscomfortTreeTransform() {
  const canvas = document.getElementById('discomfortTreeCanvas');
  canvas.style.transform = `translate(${discomfortTreeX}px, ${discomfortTreeY}px) scale(${discomfortTreeScale})`;
}

function resetDiscomfortTreeView() {
  discomfortTreeScale = 1;
  discomfortTreeX = 0;
  discomfortTreeY = 0;
  updateDiscomfortTreeTransform();
}

function toggleDiscomfortEditor() {
  const editor = document.getElementById('discomfortEditor');
  editor.style.display = editor.style.display === 'none' ? 'block' : 'none';
}

function addDiscomfortCategory() {
  const name = document.getElementById('newDiscomfortCategory').value.trim().toUpperCase();
  if (!name) return;
  
  // Verificar se categoria já existe
  if (discomfortCategories.find(cat => cat.category === name)) {
    alert('Esta categoria já existe!');
    return;
  }
  
  discomfortCategories.push({
    category: name,
    tasks: []
  });
  
  document.getElementById('newDiscomfortCategory').value = '';
  saveDiscomfortData();
  renderDiscomfortTree();
}

function addDiscomfortTask() {
  const taskName = document.getElementById('newDiscomfortTask').value.trim();
  const difficulty = document.getElementById('difficultySelect').value;
  
  if (!taskName || discomfortCategories.length === 0) return;
  
  const lastCategory = discomfortCategories[discomfortCategories.length - 1];
  lastCategory.tasks.push({
    name: taskName,
    difficulty: difficulty,
    unlocked: false
  });
  
  document.getElementById('newDiscomfortTask').value = '';
  saveDiscomfortData();
  renderDiscomfortTree();
}

function saveDiscomfortData() {
  localStorage.setItem('discomfortCategories', JSON.stringify(discomfortCategories));
}

// SISTEMA O ARQUITETO
let architectMessages = JSON.parse(localStorage.getItem('architectMessages')) || [];
let gogginsArchitectMessages = JSON.parse(localStorage.getItem('gogginsArchitectMessages')) || [];

// Respostas do Arquiteto Normal (Amigável)
const architectResponses = {
  greeting: [
    "Olá! Como posso te ajudar a construir uma rotina mais eficiente hoje?",
    "Oi! Pronto para estruturar alguns hábitos incríveis?",
    "Seja bem-vindo! Vamos trabalhar juntos para otimizar sua disciplina!"
  ],
  routine: [
    "Vou criar uma rotina personalizada para você! Baseando-me nos seus hábitos atuais e objetivos, sugiro:",
    "Aqui está uma rotina que vai te ajudar a ser mais produtivo:",
    "Criei uma estrutura diária que vai potencializar seus resultados:"
  ],
  habits: [
    "Analisando seus hábitos, vejo pontos de melhoria interessantes:",
    "Seus hábitos mostram um padrão positivo! Aqui estão algumas observações:",
    "Baseado no seu progresso, posso sugerir alguns ajustes:"
  ],
  motivation: [
    "Lembre-se: pequenos passos consistentes levam a grandes transformações!",
    "Você está no caminho certo! A disciplina é construída dia após dia.",
    "Cada hábito que você mantém é um investimento no seu futuro melhor!"
  ]
};

// Respostas do Arquiteto Goggins (Brutal)
const gogginsArchitectResponses = {
  greeting: [
    "E AÍ, GUERREIRO! PRONTO PARA PARAR DE FAZER CORPO MOLE?",
    "CHEGOU A HORA DE TRABALHAR! CHEGA DE DESCULPAS ESFARRAPADAS!",
    "ACORDA PARA A VIDA! VAMOS CONSTRUIR DISCIPLINA DE VERDADE!"
  ],
  routine: [
    "ESCUTA AQUI! Vou te dar uma rotina que vai te QUEBRAR e RECONSTRUIR mais forte:",
    "CHEGA DE MOLEZA! Esta rotina vai separar os fracos dos GUERREIROS:",
    "PREPARADO PARA SOFRER? Esta rotina vai te transformar em uma MÁQUINA:"
  ],
  habits: [
    "OLHA SÓ SEUS HÁBITOS! Tem muito LIXO aqui que precisa ser eliminado:",
    "SEUS HÁBITOS ESTÃO FRACOS! Vou te mostrar onde você está falhando:",
    "ANÁLISE BRUTAL: Seus hábitos revelam onde você está sendo FRACO:"
  ],
  motivation: [
    "PARA DE CHORAR! A dor é temporária, mas desistir dura para sempre!",
    "VOCÊ É MAIS FORTE QUE SUAS DESCULPAS! Prove isso para si mesmo!",
    "QUANDO SUA MENTE DISSER 'PARE', VOCÊ ESTÁ APENAS 40% DO SEU LIMITE!"
  ],
  brutal: [
    "ACORDA! Você está desperdiçando sua vida com essa mentalidade fraca!",
    "CHEGA DE MIMIMI! Todo mundo tem problemas, mas só os fortes superam!",
    "VOCÊ QUER RESULTADOS? ENTÃO PARE DE PROCURAR ATALHOS E TRABALHE!",
    "SUA ZONA DE CONFORTO É SEU PIOR INIMIGO! Saia dela AGORA!",
    "DISCIPLINA NÃO É NEGOCIÁVEL! Ou você tem ou você é mediocre!"
  ]
};

// Funções do Arquiteto Normal
function openArchitect() {
  // Adicionar fundo espacial como outras telas
  createRedConstellation();
  goTo('architectScreen');
  initializeArchitect();
}

function closeArchitect() {
  // Obter elementos diretamente para garantir que existem
  const transitionEl = document.getElementById('transition');
  const menuEl = document.getElementById('menu');
  const screensEl = document.querySelectorAll('.screen');
  
  if (!transitionEl || !menuEl) {
    return;
  }
  
  transitionEl.classList.add("active");
  
  setTimeout(function(){
    // Esconder todas as telas
    screensEl.forEach(function(s){
      s.style.display = "none";
    });
    
    // Mostrar menu principal
    menuEl.style.display = "flex";
    
    // Resetar estado do tutorial se necessário
    if (typeof tutorialShown !== 'undefined') {
      tutorialShown = false;
    }
    
    if (typeof closeTutorialPopup === 'function') {
      closeTutorialPopup();
    }
    
    // Verificar novamente se precisa mostrar tutorial
    setTimeout(function() {
      if (typeof checkForTutorial === 'function') {
        checkForTutorial();
      }
    }, 2000);
  }, 400);
  
  setTimeout(function(){
    transitionEl.classList.remove("active");
  }, 900);
}

function initializeArchitect() {
  loadArchitectMessages();
  
  // Event listener para Enter no input
  document.getElementById('architectInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      sendArchitectMessage();
    }
  });
  
  // Event listener adicional para o botão de voltar (garantia)
  const backBtn = document.querySelector('#architectScreen .back-to-menu-btn');
  if (backBtn) {
    backBtn.addEventListener('click', function(e) {
      e.preventDefault();
      closeArchitect();
    });
  }
}

function sendArchitectMessage() {
  const input = document.getElementById('architectInput');
  const message = input.value.trim();
  
  if (!message) return;
  
  // Adicionar mensagem do usuário
  addArchitectMessage('user', message);
  
  // Gerar resposta do Arquiteto
  setTimeout(() => {
    const response = generateArchitectResponse(message);
    addArchitectMessage('architect', response);
  }, 1000);
  
  input.value = '';
}

function addArchitectMessage(sender, message) {
  const messagesContainer = document.getElementById('architectMessages');
  
  const messageDiv = document.createElement('div');
  messageDiv.className = sender === 'user' ? 'user-message' : 'architect-message';
  
  if (sender === 'user') {
    messageDiv.innerHTML = `
      <div class="message-avatar">👤</div>
      <div class="message-content">
        <p>${message}</p>
      </div>
    `;
  } else {
    messageDiv.innerHTML = `
      <div class="message-avatar">🤖</div>
      <div class="message-content">
        <p>${message}</p>
      </div>
    `;
  }
  
  messagesContainer.appendChild(messageDiv);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
  
  // Salvar mensagem
  architectMessages.push({ sender, message, timestamp: Date.now() });
  localStorage.setItem('architectMessages', JSON.stringify(architectMessages));
}

function generateArchitectResponse(userMessage) {
  const message = userMessage.toLowerCase();
  
  if (message.includes('rotina') || message.includes('routine')) {
    return generateRoutineResponse();
  } else if (message.includes('hábito') || message.includes('habit')) {
    return generateHabitAnalysis();
  } else if (message.includes('motivação') || message.includes('motivation')) {
    return getRandomResponse(architectResponses.motivation);
  } else if (message.includes('olá') || message.includes('oi') || message.includes('hello')) {
    return getRandomResponse(architectResponses.greeting);
  } else {
    return generateGeneralResponse(userMessage);
  }
}

function generateRoutineResponse() {
  const routines = [
    "📅 **ROTINA MATINAL PRODUTIVA:**\n• 06:00 - Acordar e hidratação\n• 06:15 - Exercício físico (30min)\n• 07:00 - Banho e preparação\n• 07:30 - Café da manhã saudável\n• 08:00 - Revisão de metas do dia\n• 08:30 - Início das atividades principais",
    "🎯 **ROTINA DE FOCO:**\n• Blocos de 90min de trabalho focado\n• 15min de pausa entre blocos\n• Eliminar distrações (celular, redes sociais)\n• Ambiente organizado e silencioso\n• Hidratação constante\n• Revisão de progresso a cada 3 blocos",
    "🌙 **ROTINA NOTURNA RESTAURADORA:**\n• 21:00 - Desligar eletrônicos\n• 21:15 - Reflexão do dia (diário)\n• 21:30 - Leitura relaxante\n• 22:00 - Preparação para dormir\n• 22:30 - Meditação ou respiração\n• 23:00 - Sono reparador"
  ];
  
  return getRandomResponse(architectResponses.routine) + "\n\n" + routines[Math.floor(Math.random() * routines.length)];
}

function generateHabitAnalysis() {
  const analysis = [
    "📊 **ANÁLISE DOS SEUS HÁBITOS:**\n• Você tem " + gameHabits.length + " hábitos cadastrados\n• Nível atual: " + playerLevel + "\n• XP total ganho: " + totalXPGained + "\n\n💡 **Sugestão:** Foque em consistência antes de quantidade!",
    "🎯 **PONTOS DE MELHORIA:**\n• Adicione hábitos de diferentes categorias\n• Estabeleça horários fixos para cada hábito\n• Use o sistema de recompensas do jogo\n• Monitore seu progresso diariamente",
    "⚡ **OTIMIZAÇÃO DE HÁBITOS:**\n• Agrupe hábitos similares (stacking)\n• Comece com versões menores (micro-hábitos)\n• Use gatilhos ambientais\n• Celebre pequenas vitórias"
  ];
  
  return getRandomResponse(architectResponses.habits) + "\n\n" + analysis[Math.floor(Math.random() * analysis.length)];
}

function generateGeneralResponse(userMessage) {
  const responses = [
    "Interessante pergunta! Baseado na sua situação atual, sugiro focar em pequenos passos consistentes.",
    "Entendo sua questão. Vamos abordar isso de forma estruturada e prática.",
    "Ótima reflexão! Posso te ajudar a transformar isso em ações concretas.",
    "Vejo que você está pensando estrategicamente. Vamos criar um plano para isso!"
  ];
  
  return responses[Math.floor(Math.random() * responses.length)];
}

function loadArchitectMessages() {
  const messagesContainer = document.getElementById('architectMessages');
  
  // Carregar mensagens salvas (últimas 10)
  const recentMessages = architectMessages.slice(-10);
  
  recentMessages.forEach(msg => {
    const messageDiv = document.createElement('div');
    messageDiv.className = msg.sender === 'user' ? 'user-message' : 'architect-message';
    
    if (msg.sender === 'user') {
      messageDiv.innerHTML = `
        <div class="message-avatar">👤</div>
        <div class="message-content">
          <p>${msg.message}</p>
        </div>
      `;
    } else {
      messageDiv.innerHTML = `
        <div class="message-avatar">🤖</div>
        <div class="message-content">
          <p>${msg.message}</p>
        </div>
      `;
    }
    
    messagesContainer.appendChild(messageDiv);
  });
  
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Funções do Arquiteto Goggins
function openGogginsArchitect() {
  hideGogginsMenu();
  document.getElementById('gogginsArchitectScreen').style.display = 'block';
  initializeGogginsArchitect();
  resetGogginsInactivityTimer();
}

function initializeGogginsArchitect() {
  loadGogginsArchitectMessages();
  
  // Event listener para Enter no input
  document.getElementById('gogginsArchitectInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      sendGogginsArchitectMessage();
    }
  });
  
  // Event listener adicional para o botão de voltar (garantia)
  const backBtn = document.querySelector('#gogginsArchitectScreen .back-to-menu-btn');
  if (backBtn) {
    backBtn.addEventListener('click', function(e) {
      e.preventDefault();
      backToGogginsMenu();
    });
  }
}

function sendGogginsArchitectMessage() {
  const input = document.getElementById('gogginsArchitectInput');
  const message = input.value.trim();
  
  if (!message) return;
  
  // Adicionar mensagem do usuário
  addGogginsArchitectMessage('user', message);
  
  // Gerar resposta brutal do Arquiteto
  setTimeout(() => {
    const response = generateGogginsArchitectResponse(message);
    addGogginsArchitectMessage('architect', response);
  }, 1000);
  
  input.value = '';
  resetGogginsInactivityTimer();
}

function addGogginsArchitectMessage(sender, message) {
  const messagesContainer = document.getElementById('gogginsArchitectMessages');
  
  const messageDiv = document.createElement('div');
  messageDiv.className = sender === 'user' ? 'user-message' : 'goggins-architect-message';
  
  if (sender === 'user') {
    messageDiv.innerHTML = `
      <div class="goggins-message-avatar">👤</div>
      <div class="goggins-message-content">
        <p>${message}</p>
      </div>
    `;
  } else {
    messageDiv.innerHTML = `
      <div class="goggins-message-avatar">🤖</div>
      <div class="goggins-message-content">
        <p>${message}</p>
      </div>
    `;
  }
  
  messagesContainer.appendChild(messageDiv);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
  
  // Salvar mensagem
  gogginsArchitectMessages.push({ sender, message, timestamp: Date.now() });
  localStorage.setItem('gogginsArchitectMessages', JSON.stringify(gogginsArchitectMessages));
}

function generateGogginsArchitectResponse(userMessage) {
  const message = userMessage.toLowerCase();
  
  if (message.includes('rotina') || message.includes('routine')) {
    return generateBrutalRoutineResponse();
  } else if (message.includes('hábito') || message.includes('habit')) {
    return generateBrutalHabitAnalysis();
  } else if (message.includes('motivação') || message.includes('motivation') || message.includes('desculpa')) {
    return getRandomResponse(gogginsArchitectResponses.brutal);
  } else if (message.includes('olá') || message.includes('oi') || message.includes('hello')) {
    return getRandomResponse(gogginsArchitectResponses.greeting);
  } else {
    return generateBrutalGeneralResponse(userMessage);
  }
}

function generateBrutalRoutineResponse() {
  const brutalRoutines = [
    "💀 **ROTINA BRUTAL MATINAL:**\n• 04:30 - ACORDA! Sem soneca!\n• 04:35 - Banho GELADO (5min)\n• 04:45 - 100 flexões SEM PARAR\n• 05:00 - Corrida 5km (chuva ou sol)\n• 06:00 - Café SIMPLES (sem luxo)\n• 06:30 - TRABALHO FOCADO até cansar!",
    "🔥 **ROTINA DE GUERRA:**\n• Blocos de 2h SEM PAUSA\n• ZERO distrações (celular longe)\n• Trabalhe até sua mente GRITAR\n• Quando quiser parar, faça MAIS 30min\n• Água e disciplina são seus únicos amigos\n• RESULTADOS ou DESCULPAS - escolha!",
    "⚡ **ROTINA NOTURNA SPARTANA:**\n• 21:00 - Reflexão BRUTAL do dia\n• 21:30 - Planejamento do MASSACRE de amanhã\n• 22:00 - Leitura de desenvolvimento\n• 22:30 - DURMA no chão (luxo torna fraco)\n• 23:00 - Sono de GUERREIRO"
  ];
  
  return getRandomResponse(gogginsArchitectResponses.routine) + "\n\n" + brutalRoutines[Math.floor(Math.random() * brutalRoutines.length)];
}

function generateBrutalHabitAnalysis() {
  const brutalAnalysis = [
    "💀 **ANÁLISE BRUTAL:**\n• " + gameHabits.length + " hábitos? PATÉTICO! Precisa de MAIS!\n• Nível " + playerLevel + "? Deveria estar MUITO mais alto!\n• XP " + totalXPGained + "? Isso é MIGALHA!\n\n🔥 **REALIDADE:** Você está sendo FRACO com seus hábitos!",
    "⚡ **VERDADES DOLOROSAS:**\n• Seus hábitos são INCONSISTENTES\n• Você foge do DESCONFORTO\n• Precisa de DISCIPLINA REAL\n• Pare de procurar ATALHOS\n• TRABALHE ou continue sendo MEDÍOCRE!",
    "🎯 **DIAGNÓSTICO BRUTAL:**\n• Falta CONSISTÊNCIA\n• Sobra PREGUIÇA\n• Você escolhe CONFORTO ao invés de CRESCIMENTO\n• Seus hábitos refletem sua mentalidade FRACA\n• MUDE AGORA ou aceite ser COMUM!"
  ];
  
  return getRandomResponse(gogginsArchitectResponses.habits) + "\n\n" + brutalAnalysis[Math.floor(Math.random() * brutalAnalysis.length)];
}

function generateBrutalGeneralResponse(userMessage) {
  const responses = [
    "PARA DE ENROLAR! Você sabe o que precisa fazer, só falta CORAGEM!",
    "CHEGA DE CONVERSA FIADA! Ação é o que separa os VENCEDORES dos perdedores!",
    "SUA PERGUNTA JÁ TEM RESPOSTA: TRABALHE MAIS E RECLAME MENOS!",
    "VOCÊ QUER MUDANÇA? ENTÃO MUDE! Simples assim, sem mimimi!"
  ];
  
  return responses[Math.floor(Math.random() * responses.length)];
}

function loadGogginsArchitectMessages() {
  const messagesContainer = document.getElementById('gogginsArchitectMessages');
  
  // Carregar mensagens salvas (últimas 10)
  const recentMessages = gogginsArchitectMessages.slice(-10);
  
  recentMessages.forEach(msg => {
    const messageDiv = document.createElement('div');
    messageDiv.className = msg.sender === 'user' ? 'user-message' : 'goggins-architect-message';
    
    if (msg.sender === 'user') {
      messageDiv.innerHTML = `
        <div class="goggins-message-avatar">👤</div>
        <div class="goggins-message-content">
          <p>${msg.message}</p>
        </div>
      `;
    } else {
      messageDiv.innerHTML = `
        <div class="goggins-message-avatar">🤖</div>
        <div class="goggins-message-content">
          <p>${msg.message}</p>
        </div>
      `;
    }
    
    messagesContainer.appendChild(messageDiv);
  });
  
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Ferramentas rápidas do Arquiteto Normal
function generateRoutine() {
  const message = "Gere uma rotina personalizada para mim baseada nos meus hábitos atuais";
  document.getElementById('architectInput').value = message;
  sendArchitectMessage();
}

function analyzeHabits() {
  const message = "Analise meus hábitos atuais e me dê feedback";
  document.getElementById('architectInput').value = message;
  sendArchitectMessage();
}

function suggestImprovements() {
  const message = "Me dê sugestões para melhorar minha disciplina";
  document.getElementById('architectInput').value = message;
  sendArchitectMessage();
}

function createHabitPlan() {
  const message = "Crie um plano estruturado de novos hábitos para mim";
  document.getElementById('architectInput').value = message;
  sendArchitectMessage();
}

// Ferramentas brutais do Arquiteto Goggins
function generateBrutalRoutine() {
  const message = "Crie uma rotina brutal que vai me transformar";
  document.getElementById('gogginsArchitectInput').value = message;
  sendGogginsArchitectMessage();
}

function brutalHabitAnalysis() {
  const message = "Analise meus hábitos sem piedade, me mostre a verdade";
  document.getElementById('gogginsArchitectInput').value = message;
  sendGogginsArchitectMessage();
}

function hardcoreMotivation() {
  const message = "Preciso de motivação hardcore, me dê um tapa na cara";
  document.getElementById('gogginsArchitectInput').value = message;
  sendGogginsArchitectMessage();
}

function extremeChallenge() {
  const message = "Me dê um desafio extremo para sair da zona de conforto";
  document.getElementById('gogginsArchitectInput').value = message;
  sendGogginsArchitectMessage();
}

// Função auxiliar
function getRandomResponse(responseArray) {
  return responseArray[Math.floor(Math.random() * responseArray.length)];
}

function denyGogginsMode() {
  // Fechar primeiro modal
  hideModalWithFade('gogginsConfirmation', () => {
    // Mostrar segundo modal com animação mais intensa
    showModalWithFade('gogginsSecondConfirmation');
    
    // Efeito sonoro mais intenso
    playIntenseHorrorSound();
  });
}

function exitGogginsMode() {
  isGogginsMode = false;
  
  // Parar timer de inatividade
  if (gogginsInactivityTimer) {
    clearTimeout(gogginsInactivityTimer);
    gogginsInactivityTimer = null;
  }
  
  // Fechar modal brutal se estiver aberto
  const brutalModal = document.getElementById('gogginsBrutalModal');
  if (brutalModal) {
    brutalModal.style.display = 'none';
  }
  
  // Esconder todas as telas do Goggins incluindo o Arquiteto
  document.getElementById('dailyChallenges').style.display = 'none';
  document.getElementById('goalsScreen').style.display = 'none';
  document.getElementById('unstoppableScreen').style.display = 'none';
  document.getElementById('discomfortScreen').style.display = 'none';
  document.getElementById('gogginsArchitectScreen').style.display = 'none';
  
  // Fade out do menu Goggins
  const gogginsMenu = document.getElementById('gogginsMenu');
  gogginsMenu.style.transition = 'opacity 1s ease-out';
  gogginsMenu.style.opacity = '0';
  
  setTimeout(() => {
    gogginsMenu.style.display = 'none';
    
    // Mostrar menu normal
    const normalMenu = document.getElementById('menu');
    normalMenu.style.display = 'flex';
    normalMenu.style.opacity = '0';
    
    setTimeout(() => {
      normalMenu.style.transition = 'opacity 1.5s ease-in';
      normalMenu.style.opacity = '1';
    }, 100);
  }, 1000);
}

function updateGogginsPlayerData() {
  // Atualizar nome
  document.getElementById('gogginsPlayerName').textContent = playerName;
  
  // Atualizar nível
  document.getElementById('gogginsPlayerLevel').textContent = playerLevel;
  
  // Atualizar XP bar
  document.getElementById('gogginsXpFill').style.width = playerXP + '%';
  
  // Atualizar avatar
  const savedAvatar = localStorage.getItem("playerAvatar");
  const gogginsAvatar = document.getElementById('gogginsAvatarImg');
  if (savedAvatar) {
    gogginsAvatar.src = savedAvatar;
  }
  
  // Atualizar classe
  const playerClass = getPlayerClass(playerLevel);
  document.getElementById('gogginsPlayerClassName').textContent = playerClass.name;
  
  // Truncar descrição para o modo Goggins
  const shortDesc = playerClass.description.length > 60 
    ? playerClass.description.substring(0, 60) + '...' 
    : playerClass.description;
  document.getElementById('gogginsPlayerClassDescription').textContent = shortDesc;
}

function playHorrorSound() {
  // Placeholder para efeito sonoro
  // Você pode adicionar um arquivo de áudio aqui
  console.log('🔊 Horror sound effect');
}

function playIntenseHorrorSound() {
  // Placeholder para efeito sonoro mais intenso
  console.log('🔊 Intense horror sound effect');
}

// Adicionar event listeners para os botões do modo Goggins
document.addEventListener("DOMContentLoaded", function(){
  // Event listeners existentes...
  
  // Event listeners para detectar atividade no modo Goggins
  const activityEvents = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
  
  activityEvents.forEach(event => {
    document.addEventListener(event, function() {
      if (isGogginsMode) {
        resetGogginsInactivityTimer();
      }
    }, true);
  });
  
  // Event listeners para o modo Goggins
  const gogginsBtns = document.querySelectorAll('.goggins-menu-btn');
  gogginsBtns.forEach(function(btn){
    btn.addEventListener("click", function(){
      const target = this.getAttribute("data-go");
      if(target) {
        // Resetar timer ao clicar
        resetGogginsInactivityTimer();
        
        // Usar as mesmas funções do menu normal, mas manter o modo Goggins ativo
        if(target === 'habits') {
          createRedConstellation();
          initializeHabitForm();
        } else if(target === 'skilltree') {
          createRedConstellation();
          skillTreeTutorialShown = false;
          closeSkillTreeTutorial();
          initializeSkillTree();
        } else if(target === 'xp') {
          createRedConstellation();
          updateXPStats();
        } else if(target === 'progress') {
          createRedConstellation();
          updateProgressDisplay();
        } else if(target === 'settings') {
          createRedConstellation();
          initializeSettings();
        } else if(target === 'focus') {
          createRedConstellation();
          initializeFocusMode();
        } else if(target === 'diary') {
          createRedConstellation();
          initializeDiary();
        } else if(target === 'attributes') {
          createRedConstellation();
          initializeAttributes();
        }
        goToFromGoggins(target);
      }
    });
  });
});

function goToFromGoggins(id) {
  // Transição especial do modo Goggins
  const gogginsMenu = document.getElementById('gogginsMenu');
  gogginsMenu.style.transition = 'opacity 0.8s ease-out';
  gogginsMenu.style.opacity = '0';
  
  setTimeout(function(){
    gogginsMenu.style.display = 'none';
    screens.forEach(function(s){s.style.display="none";});
    document.getElementById(id).style.display="block";
    
    // Adicionar classe especial para indicar que veio do modo Goggins
    document.getElementById(id).classList.add('from-goggins');
  }, 800);
}

// Modificar a função goToMenu para detectar se veio do modo Goggins
function goToMenu(){
  const currentScreen = document.querySelector('.screen[style*="block"]');
  const fromGoggins = currentScreen && currentScreen.classList.contains('from-goggins');
  
  if (fromGoggins) {
    // Voltar para o modo Goggins
    currentScreen.classList.remove('from-goggins');
    
    transition.classList.add("active");
    setTimeout(function(){
      screens.forEach(function(s){s.style.display="none";});
      
      const gogginsMenu = document.getElementById('gogginsMenu');
      gogginsMenu.style.display = 'block';
      gogginsMenu.style.opacity = '0';
      
      setTimeout(() => {
        gogginsMenu.style.transition = 'opacity 1s ease-in';
        gogginsMenu.style.opacity = '1';
      }, 100);
      
      // Atualizar dados do jogador
      updateGogginsPlayerData();
    }, 400);
    setTimeout(function(){transition.classList.remove("active");}, 900);
  } else {
    // Voltar para o menu normal
    transition.classList.add("active");
    setTimeout(function(){
      screens.forEach(function(s){s.style.display="none";});
      menu.style.display="flex";
      
      // Resetar estado do tutorial
      tutorialShown = false;
      closeTutorialPopup();
      
      // Verificar novamente se precisa mostrar tutorial
      setTimeout(checkForTutorial, 2000);
    },400);
    setTimeout(function(){transition.classList.remove("active");},900);
  }
}

function applyTheme(){
  if(currentTheme === 'light'){
    document.body.classList.add('theme-light');
  } else {
    document.body.classList.remove('theme-light');
  }
}

function applyMobileMode(){
  if(mobileMode === 'on'){
    document.body.classList.add('mobile-layout');
    
    // Configurar viewport para dispositivos móveis
    let viewport = document.querySelector('meta[name="viewport"]');
    if(!viewport) {
      viewport = document.createElement('meta');
      viewport.name = 'viewport';
      document.head.appendChild(viewport);
    }
    viewport.content = 'width=device-width, initial-scale=1.0, user-scalable=yes';
    
  } else {
    document.body.classList.remove('mobile-layout');
    
    // Restaurar viewport padrão
    let viewport = document.querySelector('meta[name="viewport"]');
    if(viewport) {
      viewport.content = 'width=device-width, initial-scale=1.0';
    }
  }
}

// PWA Installation Functions
function showInstallPrompt() {
  // Create install button
  const installBtn = document.createElement('button');
  installBtn.id = 'installBtn';
  installBtn.innerHTML = '📱 INSTALAR APP';
  installBtn.style.cssText = `
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 10000;
    background: linear-gradient(45deg, #00eaff, #0099cc);
    color: #000;
    border: none;
    padding: 10px 15px;
    border-radius: 8px;
    font-family: 'Orbitron', sans-serif;
    font-weight: bold;
    font-size: 12px;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(0, 234, 255, 0.5);
    animation: install-pulse 2s infinite;
  `;
  
  installBtn.onclick = installApp;
  document.body.appendChild(installBtn);
  
  // Add CSS animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes install-pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(0, 234, 255, 0.5); }
      50% { box-shadow: 0 0 40px rgba(0, 234, 255, 1); }
    }
  `;
  document.head.appendChild(style);
}

function hideInstallPrompt() {
  const installBtn = document.getElementById('installBtn');
  if (installBtn) {
    installBtn.remove();
  }
}

function installApp() {
  const installBtn = document.getElementById('installBtn');
  
  if (deferredPrompt) {
    // Show the install prompt
    deferredPrompt.prompt();
    
    // Wait for the user to respond to the prompt
    deferredPrompt.userChoice.then((choiceResult) => {
      if (choiceResult.outcome === 'accepted') {
        console.log('Usuário aceitou instalar o PWA');
      } else {
        console.log('Usuário recusou instalar o PWA');
      }
      deferredPrompt = null;
    });
  }
  
  // Hide the install button
  if (installBtn) {
    installBtn.style.display = 'none';
  }
}

// Detect if running as PWA
function isPWA() {
  return window.matchMedia('(display-mode: standalone)').matches || 
         window.navigator.standalone === true;
}

// Fullscreen API for better mobile experience
function requestFullscreen() {
  const elem = document.documentElement;
  
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.webkitRequestFullscreen) {
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) {
    elem.msRequestFullscreen();
  }
}

// Lock orientation to landscape on mobile
function lockOrientation() {
  if (screen.orientation && screen.orientation.lock) {
    screen.orientation.lock('landscape').catch(() => {
      console.log('Não foi possível travar a orientação');
    });
  }
}

// ÁRVORE DE HABILIDADES SKYRIM STYLE
let skillTreeTutorialTimer = null;
let skillTreeTutorialShown = false;

function initializeSkillTree(){
  const container = document.getElementById('skillTreeContainer');
  const canvas = document.getElementById('skillTreeCanvas');
  
  // Controles de mouse/touch para navegação
  container.addEventListener('mousedown', startDrag);
  container.addEventListener('mousemove', drag);
  container.addEventListener('mouseup', endDrag);
  container.addEventListener('wheel', zoom);
  
  // Touch events para mobile
  container.addEventListener('touchstart', startDrag);
  container.addEventListener('touchmove', drag);
  container.addEventListener('touchend', endDrag);
  
  renderSkillTree();
  
  // Verificar se precisa mostrar tutorial após um tempo
  setTimeout(checkForSkillTreeTutorial, 3000);
}

function checkForSkillTreeTutorial() {
  // Verificar se o jogador tem constelações criadas
  if (skillConstellations.length === 0 && !skillTreeTutorialShown) {
    showSkillTreeTutorial();
  }
}

function showSkillTreeTutorial() {
  const popup = document.getElementById('skillTreeTutorial');
  const editBtn = document.getElementById('editBtn');
  
  if (popup && editBtn) {
    // Mostrar popup
    popup.classList.add('show');
    
    // Destacar botão editar
    editBtn.classList.add('highlighted');
    
    skillTreeTutorialShown = true;
    
    // Auto-fechar após 20 segundos se não interagir
    skillTreeTutorialTimer = setTimeout(() => {
      closeSkillTreeTutorial();
    }, 20000);
  }
}

function closeSkillTreeTutorial() {
  const popup = document.getElementById('skillTreeTutorial');
  const editBtn = document.getElementById('editBtn');
  
  if (popup) {
    popup.classList.remove('show');
  }
  
  if (editBtn) {
    editBtn.classList.remove('highlighted');
  }
  
  if (skillTreeTutorialTimer) {
    clearTimeout(skillTreeTutorialTimer);
    skillTreeTutorialTimer = null;
  }
}

function startSkillTreeTutorial() {
  closeSkillTreeTutorial();
  
  // Pequeno delay para a animação do popup fechar
  setTimeout(() => {
    // Abrir o editor automaticamente
    toggleEditor();
    
    // Destacar o campo de nome da constelação
    setTimeout(() => {
      const constellationInput = document.getElementById('newConstellationName');
      if (constellationInput) {
        constellationInput.focus();
        constellationInput.style.boxShadow = '0 0 20px #00eaff';
        constellationInput.placeholder = 'Digite aqui (ex: Fitness, Estudos)';
      }
    }, 500);
  }, 300);
}

function startDrag(e){
  isDragging = true;
  const clientX = e.clientX || (e.touches && e.touches[0].clientX);
  const clientY = e.clientY || (e.touches && e.touches[0].clientY);
  dragStart = {x: clientX - treeX, y: clientY - treeY};
}

function drag(e){
  if(!isDragging) return;
  e.preventDefault();
  const clientX = e.clientX || (e.touches && e.touches[0].clientX);
  const clientY = e.clientY || (e.touches && e.touches[0].clientY);
  treeX = clientX - dragStart.x;
  treeY = clientY - dragStart.y;
  updateTreeTransform();
}

function endDrag(){
  isDragging = false;
}

function zoom(e){
  e.preventDefault();
  const delta = e.deltaY > 0 ? 0.9 : 1.1;
  treeScale = Math.max(0.3, Math.min(2, treeScale * delta));
  updateTreeTransform();
}

function updateTreeTransform(){
  const canvas = document.getElementById('skillTreeCanvas');
  canvas.style.transform = `translate(${treeX}px, ${treeY}px) scale(${treeScale})`;
}

function resetTreeView(){
  treeScale = 1;
  treeX = 0;
  treeY = 0;
  updateTreeTransform();
}

function renderSkillTree(){
  const canvas = document.getElementById('skillTreeCanvas');
  canvas.innerHTML = '';
  
  skillConstellations.forEach((constellation, index) => {
    const constellationDiv = createConstellation(constellation, index);
    canvas.appendChild(constellationDiv);
  });
}

function createConstellation(constellation, index){
  const div = document.createElement('div');
  div.className = 'skill-constellation';
  div.style.left = (index % 3) * 400 + 200 + 'px';
  div.style.top = Math.floor(index / 3) * 300 + 100 + 'px';
  
  const title = document.createElement('div');
  title.className = 'constellation-title';
  title.textContent = constellation.name;
  div.appendChild(title);
  
  // Criar nós das habilidades
  constellation.skills.forEach((skill, skillIndex) => {
    const node = createSkillNode(skill, skillIndex, constellation);
    div.appendChild(node);
    
    // Criar conexões
    if(skillIndex > 0){
      const connection = createSkillConnection(skillIndex);
      div.appendChild(connection);
    }
  });
  
  return div;
}

function createSkillNode(skill, index, constellation){
  const node = document.createElement('div');
  node.className = 'skill-node';
  if(skill.unlocked) node.classList.add('unlocked');
  if(skill.available) node.classList.add('available');
  
  // Posicionamento em árvore
  const angle = (index * 60) * (Math.PI / 180);
  const radius = 80 + (Math.floor(index / 6) * 40);
  const x = Math.cos(angle) * radius;
  const y = Math.sin(angle) * radius;
  
  node.style.left = x + 150 + 'px';
  node.style.top = y + 100 + 'px';
  
  // Label da habilidade
  const label = document.createElement('div');
  label.className = 'skill-label';
  label.textContent = skill.name;
  node.appendChild(label);
  
  // Barra de XP
  const xpBar = document.createElement('div');
  xpBar.className = 'skill-xp-bar';
  const xpFill = document.createElement('div');
  xpFill.className = 'skill-xp-fill';
  xpFill.style.width = (skill.currentXP / skill.maxXP) * 100 + '%';
  xpBar.appendChild(xpFill);
  node.appendChild(xpBar);
  
  // Nível
  const level = document.createElement('div');
  level.className = 'skill-level';
  level.textContent = 'Nv.' + skill.level;
  node.appendChild(level);
  
  // Click handler
  node.addEventListener('click', function(){
    showSkillDetail(skill, constellation);
  });
  
  return node;
}

function createSkillConnection(index){
  const connection = document.createElement('div');
  connection.className = 'skill-connection';
  
  const prevAngle = ((index - 1) * 60) * (Math.PI / 180);
  const currAngle = (index * 60) * (Math.PI / 180);
  const prevRadius = 80 + (Math.floor((index - 1) / 6) * 40);
  const currRadius = 80 + (Math.floor(index / 6) * 40);
  
  const x1 = Math.cos(prevAngle) * prevRadius + 150;
  const y1 = Math.sin(prevAngle) * prevRadius + 100;
  const x2 = Math.cos(currAngle) * currRadius + 150;
  const y2 = Math.sin(currAngle) * currRadius + 100;
  
  const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
  const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
  
  connection.style.left = x1 + 'px';
  connection.style.top = y1 + 'px';
  connection.style.width = length + 'px';
  connection.style.transform = `rotate(${angle}deg)`;
  
  return connection;
}

function showSkillDetail(skill, constellation){
  currentSkillDetail = {skill, constellation};
  document.getElementById('skillDetailTitle').textContent = skill.name;
  document.getElementById('skillDetailDescription').textContent = skill.description || 'Habilidade personalizada';
  document.getElementById('skillDetailLevel').textContent = skill.level;
  document.getElementById('skillDetailXP').textContent = `${skill.currentXP}/${skill.maxXP}`;
  
  showModalWithFade('skillDetailModal');
}

function closeSkillDetail(){
  hideModalWithFade('skillDetailModal', () => {
    currentSkillDetail = null;
  });
}

function practiceSkill(){
  if(!currentSkillDetail) return;
  
  const skill = currentSkillDetail.skill;
  const xpGain = Math.floor(Math.random() * 20) + 10;
  
  skill.currentXP += xpGain;
  if(skill.currentXP >= skill.maxXP){
    skill.currentXP = 0;
    skill.level++;
    skill.maxXP = Math.floor(skill.maxXP * 1.2);
    gainXP(skill.level * 10, `${skill.name} - Nível ${skill.level}`);
  }
  
  saveSkillConstellations();
  renderSkillTree();
  showSkillDetail(skill, currentSkillDetail.constellation);
}

function editSkill(){
  if(!currentSkillDetail) return;
  
  const newName = prompt('Nome da habilidade:', currentSkillDetail.skill.name);
  const newDesc = prompt('Descrição:', currentSkillDetail.skill.description || '');
  
  if(newName){
    currentSkillDetail.skill.name = newName;
    currentSkillDetail.skill.description = newDesc;
    saveSkillConstellations();
    renderSkillTree();
    showSkillDetail(currentSkillDetail.skill, currentSkillDetail.constellation);
  }
}

function toggleEditor(){
  const editor = document.getElementById('constellationEditor');
  editor.style.display = editor.style.display === 'none' ? 'block' : 'none';
}

function addConstellation(){
  const name = document.getElementById('newConstellationName').value.trim();
  if(!name) return;
  
  skillConstellations.push({
    name: name,
    skills: []
  });
  
  document.getElementById('newConstellationName').value = '';
  
  // Se criou constelação, fechar tutorial permanentemente
  if (skillConstellations.length > 0) {
    skillTreeTutorialShown = true;
    closeSkillTreeTutorial();
  }
  
  saveSkillConstellations();
  renderSkillTree();
  
  // Destacar o campo de habilidade para continuar o tutorial
  setTimeout(() => {
    const skillInput = document.getElementById('newSkillName');
    if (skillInput) {
      skillInput.focus();
      skillInput.style.boxShadow = '0 0 20px #00eaff';
      skillInput.placeholder = 'Digite uma habilidade (ex: Flexões, Leitura)';
    }
  }, 500);
}

function addSkillToConstellation(){
  const skillName = document.getElementById('newSkillName').value.trim();
  const skillXP = parseInt(document.getElementById('newSkillXP').value) || 20;
  
  if(!skillName || skillConstellations.length === 0) return;
  
  const lastConstellation = skillConstellations[skillConstellations.length - 1];
  lastConstellation.skills.push({
    name: skillName,
    level: 1,
    currentXP: 0,
    maxXP: skillXP,
    unlocked: lastConstellation.skills.length === 0,
    available: lastConstellation.skills.length <= 1,
    description: ''
  });
  
  document.getElementById('newSkillName').value = '';
  saveSkillConstellations();
  renderSkillTree();
}

function saveSkillConstellations(){
  localStorage.setItem('skillConstellations', JSON.stringify(skillConstellations));
}

// MODO FOCO - FUNCIONALIDADES COMPLETAS
let focusStats = JSON.parse(localStorage.getItem('focusStats')) || {
  completed: 0,
  procrastinated: 0,
  history: []
};

let motivationalMessages = [
  "Você é mais forte que suas desculpas!",
  "A disciplina é a ponte entre objetivos e conquistas.",
  "Cada pequeno passo conta para a vitória final.",
  "Não pare até se orgulhar de si mesmo.",
  "O sucesso é a soma de pequenos esforços repetidos.",
  "Você não chegou até aqui para chegar só até aqui.",
  "A dor da disciplina pesa gramas, a dor do arrependimento pesa toneladas.",
  "Seja mais forte que suas desculpas mais fracas.",
  "O que não te desafia, não te transforma.",
  "Foque no que não fez, não no que já conquistou."
];

function initializeFocusMode(){
  loadFocusHabits();
  updateFocusStats();
  renderFocusChart();
  
  // Configurar upload de música
  const musicUpload = document.getElementById('musicUpload');
  if(musicUpload) {
    musicUpload.addEventListener('change', function(e){
      const file = e.target.files[0];
      if(file && file.type.startsWith('audio/')){
        const audio = document.getElementById('focusAudio');
        const url = URL.createObjectURL(file);
        audio.src = url;
        audio.load();
      }
    });
  }
}

function loadFocusHabits(){
  const container = document.getElementById('focusHabits');
  container.innerHTML = '';
  
  if(gameHabits.length === 0){
    container.innerHTML = '<div class="focus-empty-state">Nenhum hábito criado ainda.<br>Vá para "CRIAR HÁBITOS" primeiro.</div>';
    return;
  }
  
  gameHabits.forEach(habit => {
    const habitDiv = document.createElement('div');
    habitDiv.className = 'habit-check-item';
    
    habitDiv.innerHTML = `
      <div class="habit-check-info">
        <div class="habit-check-name">${habit.name}</div>
        <div class="habit-check-type">Tipo: ${habit.type === 'positive' ? 'Positivo' : 'Negativo'} | XP: ${habit.xp}</div>
      </div>
      <div class="habit-check-actions">
        <button class="btn-done" onclick="markHabitDone(${habit.id})">FIZ</button>
        <button class="btn-not-done" onclick="markHabitNotDone(${habit.id})">NÃO FIZ</button>
      </div>
    `;
    
    container.appendChild(habitDiv);
  });
}

function markHabitDone(habitId){
  const habit = gameHabits.find(h => h.id === habitId);
  if(habit){
    focusStats.completed++;
    focusStats.history.push({
      habitId: habitId,
      habitName: habit.name,
      status: 'completed',
      date: new Date().toISOString(),
      xp: habit.xp
    });
    
    gainXP(habit.xp, `Modo Foco: ${habit.name}`);
    saveFocusStats();
    updateFocusStats();
    renderFocusChart();
    
    // Mostrar mensagem motivacional para focar no que não fez
    showMotivationalMessage("Ótimo! Agora foque no que ainda não fez hoje.");
  }
}

function markHabitNotDone(habitId){
  const habit = gameHabits.find(h => h.id === habitId);
  if(habit){
    focusStats.procrastinated++;
    focusStats.history.push({
      habitId: habitId,
      habitName: habit.name,
      status: 'procrastinated',
      date: new Date().toISOString(),
      xp: 0
    });
    
    saveFocusStats();
    updateFocusStats();
    renderFocusChart();
    
    // Mostrar mensagem motivacional
    const randomMessage = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];
    showMotivationalMessage(randomMessage);
  }
}

function showMotivationalMessage(message){
  // Criar modal de motivação se não existir
  let modal = document.getElementById('motivationModal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'motivationModal';
    modal.className = 'motivation-modal';
    modal.innerHTML = `
      <div class="motivation-content">
        <h3 class="motivation-title">💪 MOTIVAÇÃO</h3>
        <p class="motivation-text" id="motivationText"></p>
        <button class="motivation-btn" onclick="closeMotivationModal()">ENTENDI!</button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  document.getElementById('motivationText').textContent = message;
  showModalWithFade('motivationModal');
}

function closeMotivationModal(){
  hideModalWithFade('motivationModal');
}

function updateFocusStats(){
  document.getElementById('completedCount').textContent = focusStats.completed;
  document.getElementById('procrastinatedCount').textContent = focusStats.procrastinated;
}

function renderFocusChart(){
  const chart = document.getElementById('focusChart');
  chart.innerHTML = '';
  
  // Pegar últimos 7 dias de dados
  const last7Days = [];
  const today = new Date();
  
  for(let i = 6; i >= 0; i--){
    const date = new Date(today);
    date.setDate(date.getDate() - i);
    const dateStr = date.toDateString();
    
    const dayData = focusStats.history.filter(entry => {
      const entryDate = new Date(entry.date);
      return entryDate.toDateString() === dateStr;
    });
    
    const completed = dayData.filter(entry => entry.status === 'completed').length;
    const procrastinated = dayData.filter(entry => entry.status === 'procrastinated').length;
    
    last7Days.push({date: dateStr, completed, procrastinated});
  }
  
  // Renderizar barras
  last7Days.forEach((day, index) => {
    const maxHeight = 120;
    const total = day.completed + day.procrastinated;
    const completedHeight = total > 0 ? (day.completed / total) * maxHeight : 0;
    const procrastinatedHeight = total > 0 ? (day.procrastinated / total) * maxHeight : 0;
    
    // Barra de sucesso
    if(completedHeight > 0){
      const successBar = document.createElement('div');
      successBar.className = 'chart-bar success';
      successBar.style.left = (index * 45 + 10) + 'px';
      successBar.style.height = completedHeight + 'px';
      successBar.style.width = '35px';
      chart.appendChild(successBar);
    }
    
    // Barra de procrastinação
    if(procrastinatedHeight > 0){
      const failureBar = document.createElement('div');
      failureBar.className = 'chart-bar failure';
      failureBar.style.left = (index * 45 + 10) + 'px';
      failureBar.style.bottom = completedHeight + 'px';
      failureBar.style.height = procrastinatedHeight + 'px';
      failureBar.style.width = '35px';
      chart.appendChild(failureBar);
    }
  });
}

function saveFocusStats(){
  localStorage.setItem('focusStats', JSON.stringify(focusStats));
}

function toggleMusic(){
  const audio = document.getElementById('focusAudio');
  if(audio.paused){
    audio.play();
  } else {
    audio.pause();
  }
}

// CALENDÁRIO DE DISCIPLINA
let completedDays = JSON.parse(localStorage.getItem('completedDays')) || [];

function initializeCalendar(){
  const calendar = document.getElementById('disciplineCalendar');
  const today = new Date();
  const currentMonth = today.getMonth();
  const currentYear = today.getFullYear();
  
  // Limpar calendário
  calendar.innerHTML = '';
  
  // Cabeçalho dos dias da semana
  const daysOfWeek = ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'];
  daysOfWeek.forEach(day => {
    const dayHeader = document.createElement('div');
    dayHeader.className = 'calendar-day';
    dayHeader.textContent = day;
    dayHeader.style.fontWeight = 'bold';
    dayHeader.style.color = '#ff0040';
    dayHeader.style.cursor = 'default';
    calendar.appendChild(dayHeader);
  });
  
  // Primeiro dia do mês
  const firstDay = new Date(currentYear, currentMonth, 1);
  const lastDay = new Date(currentYear, currentMonth + 1, 0);
  const startingDayOfWeek = firstDay.getDay();
  
  // Dias vazios no início
  for(let i = 0; i < startingDayOfWeek; i++){
    const emptyDay = document.createElement('div');
    emptyDay.className = 'calendar-day';
    calendar.appendChild(emptyDay);
  }
  
  // Dias do mês
  for(let day = 1; day <= lastDay.getDate(); day++){
    const dayElement = document.createElement('div');
    dayElement.className = 'calendar-day';
    dayElement.textContent = day;
    
    const dayDate = new Date(currentYear, currentMonth, day);
    const dayString = dayDate.toDateString();
    
    // Verificar se é hoje
    if(dayDate.toDateString() === today.toDateString()){
      dayElement.classList.add('today');
    }
    
    // Verificar se o dia foi completado
    if(completedDays.includes(dayString)){
      dayElement.classList.add('completed');
    }
    
    calendar.appendChild(dayElement);
  }
}

function markDayComplete(){
  const today = new Date();
  const todayString = today.toDateString();
  
  if(!completedDays.includes(todayString)){
    completedDays.push(todayString);
    gainXP(50, 'Dia Concluído - Calendário de Disciplina');
    localStorage.setItem('completedDays', JSON.stringify(completedDays));
    initializeCalendar();
    alert('Parabéns! Dia marcado como concluído. +50 XP!');
  } else {
    alert('Este dia já foi marcado como concluído!');
  }
}

// Inicializar calendário quando a página carregar
document.addEventListener('DOMContentLoaded', function(){
  initializeCalendar();
  
  // Adicionar event listener para o botão de Modo Foco
  const focusBtn = document.querySelector('[data-go="focus"]');
  if(focusBtn){
    focusBtn.addEventListener('click', function(){
      setTimeout(initializeFocusMode, 1000); // Aguardar transição
    });
  }
});
</script>

<!-- MODO GOGGINS - CONFIRMAÇÃO -->
<div id="gogginsConfirmation" class="goggins-modal">
  <div class="goggins-horror-bg">
    <div class="blood-drips"></div>
    <div class="horror-static"></div>
    <div class="pulsing-veins"></div>
  </div>
  
  <div class="goggins-confirmation-content">
    <div class="goggins-skull">💀</div>
    <div class="goggins-question">
      <div class="question-text">ESTÁ PREPARADO PARA</div>
      <div class="question-text">COMEÇAR A SE AFIAR</div>
      <div class="question-text highlight-red">COMO O FERRO?</div>
    </div>
    
    <div class="goggins-buttons">
      <button class="goggins-btn-yes" onclick="confirmGogginsMode()">SIM</button>
      <button class="goggins-btn-no" onclick="denyGogginsMode()">NÃO</button>
    </div>
  </div>
</div>

<!-- MODO GOGGINS - SEGUNDA CONFIRMAÇÃO -->
<div id="gogginsSecondConfirmation" class="goggins-modal">
  <div class="goggins-horror-bg intense">
    <div class="blood-drips fast"></div>
    <div class="horror-static intense"></div>
    <div class="pulsing-veins fast"></div>
    <div class="horror-glitch"></div>
  </div>
  
  <div class="goggins-confirmation-content">
    <div class="goggins-skull pulsing">💀</div>
    <div class="goggins-question">
      <div class="question-text shaking">TEM</div>
      <div class="question-text shaking">CERTEZA?</div>
    </div>
    
    <div class="goggins-buttons">
      <button class="goggins-btn-yes" onclick="confirmGogginsMode()">SIM</button>
      <button class="goggins-btn-no" onclick="goToMenu()">NÃO</button>
    </div>
  </div>
</div>

<!-- MODO GOGGINS - MENU PRINCIPAL -->
<div id="gogginsMenu" class="goggins-main-menu">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
    <div class="nightmare-static"></div>
    <div class="pulsing-red-veins"></div>
  </div>

  <div class="goggins-hud">
    <div class="goggins-player-panel">
      <div class="goggins-player-header">
        <span id="gogginsPlayerName">GUERREIRO</span>
        <button type="button" onclick="editName()">✏️</button>
      </div>
      <div class="goggins-avatar-container">
        <img id="gogginsAvatarImg" src="https://via.placeholder.com/160" alt="Avatar do Player">
        <div class="red-glow-effect"></div>
      </div>
      <div class="goggins-player-level">
        NÍVEL <span id="gogginsPlayerLevel">1</span>
      </div>
      <div class="goggins-xp-bar">
        <div id="gogginsXpFill"></div>
      </div>
      
      <!-- Sistema de Classes Goggins -->
      <div class="goggins-class-section" onclick="showClassModal()">
        <div class="goggins-class-title">CLASSE</div>
        <div class="goggins-class-name" id="gogginsPlayerClassName">BETA</div>
        <div class="goggins-class-description" id="gogginsPlayerClassDescription">Você está apenas começando...</div>
        <div class="class-click-hint" style="color: rgba(255, 0, 0, 0.7); font-size: 10px; margin-top: 8px;">🔍 Clique para ver detalhes</div>
      </div>
    </div>

    <div class="goggins-panel">
      <h3>ARSENAL TURBO</h3>
      <div class="goggins-menu-btn" onclick="openDailyChallenges()">  DESAFIOS DIÁRIOS</div>
      <div class="goggins-menu-btn" onclick="openGoals()">🎯 METAS</div>
      <div class="goggins-menu-btn" onclick="openUnstoppable()">⚡ TORNE-SE IMPARÁVEL</div>
      <div class="goggins-menu-btn" onclick="openDiscomfort()">🔥 DESCONFORTO</div>
    </div>

    <div class="goggins-panel">
      <h3>CONTROLE</h3>
      <div class="goggins-menu-btn" onclick="openGogginsArchitect()">🤖 O ARQUITETO</div>
      <div class="goggins-menu-btn exit-goggins" onclick="exitGogginsMode()">  SAIR DO MODO TURBO</div>
    </div>
  </div>
</div>

<!-- GOGGINS - MODAL DE BOAS-VINDAS -->
<div id="gogginsWelcomeModal" class="goggins-welcome-modal">
  <div class="goggins-welcome-bg">
    <div class="welcome-static"></div>
    <div class="welcome-lightning"></div>
    <div class="welcome-veins"></div>
  </div>
  <div class="goggins-welcome-content">
    <div class="goggins-avatar">🥊</div>
    <div class="goggins-name">TURBO</div>
    <div class="goggins-welcome-message">
      <div class="message-line">FAÇA ISSO SOZINHO,</div>
      <div class="message-line">NÃO DEPENDA DE PESSOAS</div>
      <div class="message-line">PARA TE AUXILIAR.</div>
      <div class="message-line highlight">FAÇA CANSADO,</div>
      <div class="message-line highlight">FAÇA EM DESCONFORTO,</div>
      <div class="message-line final">MAS FAÇA E SÓ PARE</div>
      <div class="message-line final">QUANDO TERMINAR.</div>
    </div>
    <button class="goggins-continue-btn" onclick="enterGogginsMenu()">ENTRAR NO MODO TURBO</button>
  </div>
</div>

<!-- GOGGINS - DESAFIOS DIÁRIOS -->
<div id="dailyChallenges" class="goggins-screen">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1000px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="backToGogginsMenu()">← VOLTAR</button>
    <h2>💪 DESAFIOS DIÁRIOS</h2>
    
    <div class="daily-challenges-container">
      <div class="challenge-header">
        <h3>DESAFIOS DE HOJE</h3>
        <div class="challenge-date" id="challengeDate"></div>
      </div>
      
      <div class="challenges-list" id="challengesList">
        <!-- Desafios serão gerados dinamicamente -->
      </div>
      
      <div class="challenge-completion">
        <button class="goggins-complete-btn" onclick="completeAllChallenges()">
          ✅ COMPLETEI TODOS OS DESAFIOS
        </button>
      </div>
    </div>
  </div>
</div>

<!-- GOGGINS - METAS -->
<div id="goalsScreen" class="goggins-screen">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1000px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="backToGogginsMenu()">← VOLTAR</button>
    <h2>🎯 METAS</h2>
    
    <div class="goals-container">
      <div class="goals-header">
        <h3>SUAS METAS BASEADAS NO SEU PROGRESSO</h3>
      </div>
      
      <div class="goals-list" id="goalsList">
        <!-- Metas serão geradas dinamicamente -->
      </div>
      
      <div class="add-goal-section">
        <input type="text" id="customGoal" class="goal-input" placeholder="Adicionar meta personalizada...">
        <button class="goggins-add-btn" onclick="addCustomGoal()">ADICIONAR META</button>
      </div>
    </div>
  </div>
</div>

<!-- GOGGINS - TORNE-SE IMPARÁVEL -->
<div id="unstoppableScreen" class="goggins-screen">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
  </div>
  <div class="futuristic-menu" style="max-width: 1200px;">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="backToGogginsMenu()">← VOLTAR</button>
    <h2>⚡ TORNE-SE IMPARÁVEL</h2>
    
    <div class="unstoppable-container">
      <div class="unstoppable-header">
        <h3>CRONOGRAMA COMPLETO - 16 HORAS DE PRODUTIVIDADE</h3>
        <div class="sleep-info">8 horas de sono reservadas (22:00 - 06:00)</div>
      </div>
      
      <div class="hourly-schedule" id="hourlySchedule">
        <!-- Cronograma será gerado dinamicamente -->
      </div>
      
      <div class="schedule-controls">
        <button class="goggins-generate-btn" onclick="generateDailySchedule()">
          🔄 GERAR NOVO CRONOGRAMA
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL DE CLASSES DETALHADO -->
<div id="classModal" class="class-modal">
  <div class="class-modal-content">
    <div class="class-modal-header">
      <div class="class-modal-title" id="classModalTitle">SISTEMA DE CLASSES</div>
      <div class="class-modal-subtitle">EVOLUÇÃO POR DISCIPLINA</div>
    </div>
    
    <div class="current-class-section">
      <div class="current-class-name" id="currentClassModalName">BETA</div>
      <div class="current-class-level" id="currentClassModalLevel">NÍVEL 1</div>
      <div class="current-class-description" id="currentClassModalDescription">
        Você está apenas começando sua jornada. Todo grande guerreiro já foi um iniciante. O importante é dar o primeiro passo.
      </div>
      
      <div class="class-progress-section">
        <div class="progress-info">
          <span class="progress-text">Progresso para próxima classe:</span>
          <span class="progress-text" id="progressPercentage">33%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="classProgressFill"></div>
        </div>
        <div class="next-class-preview" id="nextClassPreview">
          Próxima: INICIANTE (Nível 3)
        </div>
      </div>
    </div>
    
    <div class="all-classes-section">
      <div class="all-classes-title">🏆 TODAS AS CLASSES</div>
      <div class="classes-grid" id="allClassesGrid">
        <!-- Classes serão geradas dinamicamente -->
      </div>
    </div>
    
    <button class="class-modal-close" onclick="closeClassModal()">FECHAR</button>
  </div>
</div>

<!-- GOGGINS - DESCONFORTO -->
<div id="discomfortScreen" class="goggins-screen">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
  </div>
  
  <div class="discomfort-container">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="backToGogginsMenu()">← VOLTAR</button>
    
    <div class="discomfort-header">
      <h2>🔥 ZONA DE DESCONFORTO</h2>
      <div class="discomfort-subtitle">SUPERE SEUS MEDOS E LIMITAÇÕES</div>
    </div>
    
    <div class="discomfort-main-content">
      <!-- Instrutor Goggins -->
      <div class="goggins-instructor">
        <div class="instructor-header">
          <div class="instructor-avatar">🥊</div>
          <div class="instructor-info">
            <h3>INSTRUTOR TURBO</h3>
            <div class="instructor-subtitle">SEU MENTOR DE DISCIPLINA</div>
          </div>
        </div>
        
        <div class="instructor-message" id="instructorMessage">
          <p>ESCUTE BEM! O DESCONFORTO É ONDE A MÁGICA ACONTECE!</p>
          <p>Cada tarefa aqui vai te tirar da sua zona de conforto e te transformar em uma máquina imparável.</p>
          <p>NÃO FUJA DO QUE TE ASSUSTA - ABRACE E CONQUISTE!</p>
        </div>
        
        <div class="instructor-suggestions">
          <h4>💡 SUGESTÕES DO TURBO:</h4>
          <div class="suggestions-list" id="suggestionsList">
            <!-- Sugestões serão geradas dinamicamente -->
          </div>
          <button class="instructor-btn" onclick="generateNewSuggestions()">🔄 NOVAS SUGESTÕES</button>
        </div>
      </div>
      
      <!-- Árvore de Desconforto -->
      <div class="discomfort-tree-section">
        <div class="tree-header">
          <h3>🌳 ÁRVORE DE DESCONFORTO</h3>
          <div class="tree-controls">
            <button type="button" class="tree-control-btn" onclick="resetDiscomfortTreeView()">🎯 CENTRALIZAR</button>
            <button type="button" class="tree-control-btn" onclick="toggleDiscomfortEditor()" id="discomfortEditBtn">✏️ EDITAR</button>
          </div>
        </div>
        
        <div class="discomfort-tree-container" id="discomfortTreeContainer">
          <div class="discomfort-tree-canvas" id="discomfortTreeCanvas">
            <!-- Nós de desconforto serão gerados dinamicamente -->
          </div>
        </div>
        
        <!-- Editor de Desconforto -->
        <div class="discomfort-editor" id="discomfortEditor">
          <h4>EDITOR DE DESCONFORTO</h4>
          <div class="editor-form">
            <div class="editor-input-group">
              <input type="text" class="discomfort-input" id="newDiscomfortCategory" placeholder="Categoria (ex: Social, Físico, Mental)">
              <button type="button" class="discomfort-btn" onclick="addDiscomfortCategory()">CRIAR CATEGORIA</button>
            </div>
            <div class="editor-input-group">
              <input type="text" class="discomfort-input" id="newDiscomfortTask" placeholder="Tarefa de Desconforto">
              <select class="discomfort-select" id="difficultySelect">
                <option value="easy">Fácil</option>
                <option value="medium">Médio</option>
                <option value="hard">Difícil</option>
                <option value="extreme">Extremo</option>
              </select>
              <button type="button" class="discomfort-btn" onclick="addDiscomfortTask()">ADICIONAR</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- O ARQUITETO - MENU NORMAL -->
<div id="architectScreen" class="screen">
  <div class="space-bg">
    <div class="nebula nebula-1"></div>
    <div class="nebula nebula-2"></div>
    <div class="stars small"></div>
    <div class="stars medium"></div>
    <div class="stars big"></div>
  </div>
  
  <div class="architect-container">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="closeArchitect()">← MENU</button>
    
    <div class="architect-header">
      <div class="architect-avatar">🤖</div>
      <div class="architect-info">
        <h2>O ARQUITETO</h2>
        <div class="architect-subtitle">SEU ASSISTENTE PESSOAL DE PRODUTIVIDADE</div>
      </div>
    </div>
    
    <div class="architect-main">
      <div class="architect-chat-section">
        <div class="chat-header">
          <h3>💬 CONVERSA COM O ARQUITETO</h3>
          <div class="architect-status">🟢 Online</div>
        </div>
        
        <div class="chat-messages" id="architectMessages">
          <div class="architect-message">
            <div class="message-avatar">🤖</div>
            <div class="message-content">
              <p>Olá! Eu sou O Arquiteto, seu assistente pessoal para construir uma vida mais disciplinada e produtiva.</p>
              <p>Posso te ajudar a:</p>
              <ul>
                <li>📋 Criar rotinas personalizadas</li>
                <li>🎯 Estruturar hábitos eficazes</li>
                <li>⚡ Integrar tudo ao seu jogo</li>
                <li>📈 Analisar seu progresso</li>
              </ul>
              <p>Como posso te ajudar hoje?</p>
            </div>
          </div>
        </div>
        
        <div class="chat-input-section">
          <input type="text" id="architectInput" class="chat-input" placeholder="Digite sua pergunta ou pedido...">
          <button class="chat-send-btn" onclick="sendArchitectMessage()">📤</button>
        </div>
      </div>
      
      <div class="architect-tools-section">
        <h3>🛠️ FERRAMENTAS RÁPIDAS</h3>
        
        <div class="architect-tools">
          <div class="tool-card" onclick="generateRoutine()">
            <div class="tool-icon">📋</div>
            <div class="tool-title">Criar Rotina</div>
            <div class="tool-description">Gere uma rotina personalizada baseada nos seus objetivos</div>
          </div>
          
          <div class="tool-card" onclick="analyzeHabits()">
            <div class="tool-icon">📊</div>
            <div class="tool-title">Analisar Hábitos</div>
            <div class="tool-description">Receba insights sobre seus hábitos atuais</div>
          </div>
          
          <div class="tool-card" onclick="suggestImprovements()">
            <div class="tool-icon">💡</div>
            <div class="tool-title">Sugestões</div>
            <div class="tool-description">Obtenha dicas para melhorar sua disciplina</div>
          </div>
          
          <div class="tool-card" onclick="createHabitPlan()">
            <div class="tool-icon">🎯</div>
            <div class="tool-title">Plano de Hábitos</div>
            <div class="tool-description">Crie um plano estruturado de novos hábitos</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- O ARQUITETO - MODO GOGGINS -->
<div id="gogginsArchitectScreen" class="goggins-screen">
  <div class="goggins-nightmare-bg">
    <div class="red-lightning"></div>
    <div class="horror-particles"></div>
    <div class="blood-rain"></div>
  </div>
  
  <div class="goggins-architect-container">
    <button type="button" class="futuristic-btn back-to-menu-btn" onclick="backToGogginsMenu()">← VOLTAR</button>
    
    <div class="goggins-architect-header">
      <div class="goggins-architect-avatar">🤖</div>
      <div class="goggins-architect-info">
        <h2>O ARQUITETO</h2>
        <div class="goggins-architect-subtitle">MODO TURBO ATIVADO - SEM PIEDADE</div>
      </div>
    </div>
    
    <div class="goggins-architect-main">
      <div class="goggins-chat-section">
        <div class="goggins-chat-header">
          <h3>💀 CONVERSA BRUTAL COM O ARQUITETO</h3>
          <div class="goggins-architect-status">🔴 Modo Turbo</div>
        </div>
        
        <div class="goggins-chat-messages" id="gogginsArchitectMessages">
          <div class="goggins-architect-message">
            <div class="goggins-message-avatar">🤖</div>
            <div class="goggins-message-content">
              <p><strong>ESCUTE BEM!</strong> Agora eu falo a linguagem do Turbo!</p>
              <p>Chega de mimimi e desculpas esfarrapadas! Eu vou te ajudar a:</p>
              <ul>
                <li>💀 Criar rotinas BRUTAIS que te transformem</li>
                <li>🔥 Estruturar hábitos que te façam SOFRER para crescer</li>
                <li>⚡ Te dar TAPAS NA CARA quando precisar</li>
                <li>📈 Mostrar a VERDADE sobre seu progresso</li>
              </ul>
              <p><strong>QUAL É SUA DESCULPA HOJE? FALE LOGO!</strong></p>
            </div>
          </div>
        </div>
        
        <div class="goggins-chat-input-section">
          <input type="text" id="gogginsArchitectInput" class="goggins-chat-input" placeholder="Fale sua situação ou peça ajuda (sem mimimi)...">
          <button class="goggins-chat-send-btn" onclick="sendGogginsArchitectMessage()">💀</button>
        </div>
      </div>
      
      <div class="goggins-architect-tools-section">
        <h3>🔥 FERRAMENTAS BRUTAIS</h3>
        
        <div class="goggins-architect-tools">
          <div class="goggins-tool-card" onclick="generateBrutalRoutine()">
            <div class="goggins-tool-icon">💀</div>
            <div class="goggins-tool-title">Rotina Brutal</div>
            <div class="goggins-tool-description">Crie uma rotina que vai te quebrar e reconstruir</div>
          </div>
          
          <div class="goggins-tool-card" onclick="brutalHabitAnalysis()">
            <div class="goggins-tool-icon">🔥</div>
            <div class="goggins-tool-title">Análise Brutal</div>
            <div class="goggins-tool-description">Verdades dolorosas sobre seus hábitos</div>
          </div>
          
          <div class="goggins-tool-card" onclick="hardcoreMotivation()">
            <div class="goggins-tool-icon">⚡</div>
            <div class="goggins-tool-title">Motivação Hardcore</div>
            <div class.="goggins-tool-description">Tapas na cara quando você precisar</div>
          </div>
          
          <div class="goggins-tool-card" onclick="extremeChallenge()">
            <div class="goggins-tool-icon">🎯</div>
            <div class="goggins-tool-title">Desafio Extremo</div>
            <div class="goggins-tool-description">Desafios que vão te tirar da zona de conforto</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
